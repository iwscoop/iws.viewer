!function(t){var e,i,n=t.iws||(t.iws={});n.viewer={version:"1.3.44"},console.log("iws viewer version = "+n.viewer.version),n.debug=!1,n.useAnimationFrame=!0,n.mask=!0,n.log=function(){for(var t="",e=0;e<arguments.length;e++)t+=arguments[e]+" >>>> ";console.log(">>>>   iws : "+t)},n.warn=function(){for(var t="",e=0;e<arguments.length;e++)t+=arguments[e]+" >>>> ";console.log(">>>>   iws warn!!!: "+t)},n.logger=function(e,i){function n(n,o){e&&t.console&&((o=Array.prototype.slice.call(o)).unshift(i),console[n].apply(console,o))}return{_log:function(){n("log",arguments)},_warn:function(){n("warn",arguments)}}},n.msie=(i=navigator.userAgent.toLowerCase(),"Microsoft Internet Explorer"==navigator.appName?e="msie ":i.search("trident")>-1?e="trident/.*rv:":i.search("edge/")>-1&&(e="edge/"),null!=new RegExp(e+"([0-9]{1,})(\\.{0,}[0-9]{0,1})").exec(i)&&(RegExp.$1,RegExp.$2),"msie"==e),n.toolbar={},n.Observable={observe:function(t,e,i){if(this.topics||(this.topics={}),"function"!=typeof e)return!1;this.topics.hasOwnProperty(t)||(this.topics[t]={});var n=Math.random().toString(35);return this.topics[t][n]=[e,!!i],n},stopObserving:function(t){if(this.topics){for(var e in this.topics)if(this.topics[e][t])return delete this.topics[e][t],!0;return!1}},fire:function(t){if(this.topics&&this.topics.hasOwnProperty(t)){var e=Array.prototype.slice.call(arguments,1),i=[];for(var n in this.topics[t]){var o=this.topics[t][n];try{o[0].apply(this,e)}catch(t){console.error("viewer fire Error",t.message,t)}o[1]&&i.push(n)}i.length&&i.forEach(this.unsubscribe)}}},n.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderAll(),this},insertAt:function(t,e,i){var n=this.getObjects();return i?n[e]=t:n.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderAll(),this},remove:function(){for(var t,e=this.getObjects(),i=!1,n=0,o=arguments.length;n<o;n++)-1!==(t=e.indexOf(arguments[n]))&&(i=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[n]));return i&&this.renderAll(),this},forEachObject:function(t,e){for(var i=this.getObjects(),n=0,o=i.length;n<o;n++)t.call(e,i[n],n,i);return this},getObjects:function(t){return void 0===t?this._objects:this._objects.filter(function(e){return e.type===t})},item:function(t){return this.getObjects()[t]},isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},contains:function(t){return this.getObjects().indexOf(t)>-1},complexity:function(){return this.getObjects().reduce(function(t,e){return t+=e.complexity?e.complexity():0},0)}},function(t){"use strict";var e=t.iws||(t.iws={});function i(t,e){this.x=t,this.y=e}e.Point?e.warn("iws.Point is already defined"):(e.Point=i,i.prototype={type:"point",constructor:i,add:function(t){return new i(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new i(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new i(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new i(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new i(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new i(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,e){return void 0===e&&(e=.5),e=Math.max(Math.min(1,e),0),new i(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},distanceFrom:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},midPointFrom:function(t){return this.lerp(t)},min:function(t){return new i(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new i(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setFromPoint:function(t){return this.x=t.x,this.y=t.y,this},swap:function(t){var e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i},clone:function(){return new i(this.x,this.y)}})}(t),function(t){"use strict";var e=t.iws||(t.iws={});function i(t){this.status=t,this.points=[]}e.Intersection?e.warn("iws.Intersection is already defined"):(e.Intersection=i,e.Intersection.prototype={constructor:i,appendPoint:function(t){return this.points.push(t),this},appendPoints:function(t){return this.points=this.points.concat(t),this}},e.Intersection.intersectLineLine=function(t,n,o,s){var r,a=(s.x-o.x)*(t.y-o.y)-(s.y-o.y)*(t.x-o.x),l=(n.x-t.x)*(t.y-o.y)-(n.y-t.y)*(t.x-o.x),h=(s.y-o.y)*(n.x-t.x)-(s.x-o.x)*(n.y-t.y);if(0!==h){var c=a/h,u=l/h;0<=c&&c<=1&&0<=u&&u<=1?(r=new i("Intersection")).appendPoint(new e.Point(t.x+c*(n.x-t.x),t.y+c*(n.y-t.y))):r=new i}else r=new i(0===a||0===l?"Coincident":"Parallel");return r},e.Intersection.intersectLinePolygon=function(t,e,n){for(var o,s,r,a=new i,l=n.length,h=0;h<l;h++)o=n[h],s=n[(h+1)%l],r=i.intersectLineLine(t,e,o,s),a.appendPoints(r.points);return a.points.length>0&&(a.status="Intersection"),a},e.Intersection.intersectPolygonPolygon=function(t,e){for(var n=new i,o=t.length,s=0;s<o;s++){var r=t[s],a=t[(s+1)%o],l=i.intersectLinePolygon(r,a,e);n.appendPoints(l.points)}return n.points.length>0&&(n.status="Intersection"),n},e.Intersection.intersectPolygonRectangle=function(t,n,o){var s=n.min(o),r=n.max(o),a=new e.Point(r.x,s.y),l=new e.Point(s.x,r.y),h=i.intersectLinePolygon(s,a,t),c=i.intersectLinePolygon(a,r,t),u=i.intersectLinePolygon(r,l,t),p=i.intersectLinePolygon(l,s,t),d=new i;return d.appendPoints(h.points),d.appendPoints(c.points),d.appendPoints(u.points),d.appendPoints(p.points),d.points.length>0&&(d.status="Intersection"),d})}(t),function(t){"use strict";var e=t.iws||(t.iws={});function i(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function n(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}e.Color?e.warn("iws.Color is already defined."):(e.Color=i,e.Color.prototype={_tryParsingColor:function(t){var e;t in i.colorNameMap&&(t=i.colorNameMap[t]),"transparent"===t&&(e=[255,255,255,0]),e||(e=i.sourceFromHex(t)),e||(e=i.sourceFromRgb(t)),e||(e=i.sourceFromHsl(t)),e||(e=[0,0,0,1]),e&&this.setSource(e)},_rgbToHsl:function(t,i,n){t/=255,i/=255,n/=255;var o,s,r,a=e.util.array.max([t,i,n]),l=e.util.array.min([t,i,n]);if(r=(a+l)/2,a===l)o=s=0;else{var h=a-l;switch(s=r>.5?h/(2-a-l):h/(a+l),a){case t:o=(i-n)/h+(i<n?6:0);break;case i:o=(n-t)/h+2;break;case n:o=(t-i)/h+4}o/=6}return[Math.round(360*o),Math.round(100*s),Math.round(100*r)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,i,n=this.getSource();return t=1===(t=n[0].toString(16)).length?"0"+t:t,e=1===(e=n[1].toString(16)).length?"0"+e:e,i=1===(i=n[2].toString(16)).length?"0"+i:i,t.toUpperCase()+e.toUpperCase()+i.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),i=t[3];return this.setSource([e,e,e,i]),this},toBlackWhite:function(t){var e=this.getSource(),i=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),n=e[3];return t=t||127,i=Number(i)<Number(t)?0:255,this.setSource([i,i,i,n]),this},overlayWith:function(t){t instanceof i||(t=new i(t));for(var e=[],n=this.getAlpha(),o=this.getSource(),s=t.getSource(),r=0;r<3;r++)e.push(Math.round(.5*o[r]+.5*s[r]));return e[3]=n,this.setSource(e),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",grey:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},e.Color.fromRgb=function(t){return i.fromSource(i.sourceFromRgb(t))},e.Color.sourceFromRgb=function(t){var e=t.match(i.reRGBa);if(e){var n=parseInt(e[1],10)/(/%$/.test(e[1])?100:1)*(/%$/.test(e[1])?255:1),o=parseInt(e[2],10)/(/%$/.test(e[2])?100:1)*(/%$/.test(e[2])?255:1),s=parseInt(e[3],10)/(/%$/.test(e[3])?100:1)*(/%$/.test(e[3])?255:1);return[parseInt(n,10),parseInt(o,10),parseInt(s,10),e[4]?parseFloat(e[4]):1]}},e.Color.fromRgba=i.fromRgb,e.Color.fromHsl=function(t){return i.fromSource(i.sourceFromHsl(t))},e.Color.sourceFromHsl=function(t){var e=t.match(i.reHSLa);if(e){var o,s,r,a=(parseFloat(e[1])%360+360)%360/360,l=parseFloat(e[2])/(/%$/.test(e[2])?100:1),h=parseFloat(e[3])/(/%$/.test(e[3])?100:1);if(0===l)o=s=r=h;else{var c=h<=.5?h*(l+1):h+l-h*l,u=2*h-c;o=n(u,c,a+1/3),s=n(u,c,a),r=n(u,c,a-1/3)}return[Math.round(255*o),Math.round(255*s),Math.round(255*r),e[4]?parseFloat(e[4]):1]}},e.Color.fromHsla=i.fromHsl,e.Color.fromHex=function(t){return i.fromSource(i.sourceFromHex(t))},e.Color.sourceFromHex=function(t){if(t.match(i.reHex)){var e=t.slice(t.indexOf("#")+1),n=3===e.length||4===e.length,o=8===e.length||4===e.length,s=n?e.charAt(0)+e.charAt(0):e.substring(0,2),r=n?e.charAt(1)+e.charAt(1):e.substring(2,4),a=n?e.charAt(2)+e.charAt(2):e.substring(4,6),l=o?n?e.charAt(3)+e.charAt(3):e.substring(6,8):"FF";return[parseInt(s,16),parseInt(r,16),parseInt(a,16),parseFloat((parseInt(l,16)/255).toFixed(2))]}},e.Color.fromSource=function(t){var e=new i;return e.setSource(t),e})}(t),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this).Promise=e()}}(function(){return function t(e,i,n){function o(r,a){if(!i[r]){if(!e[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(s)return s(r,!0);var h=new Error("Cannot find module '"+r+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[r]={exports:{}};e[r][0].call(c.exports,function(t){var i=e[r][1][t];return o(i||t)},c,c.exports,t,e,i,n)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}({1:[function(e,i,n){(function(t){"use strict";var e,n,o=t.MutationObserver||t.WebKitMutationObserver;if(o){var s=0,r=new o(c),a=t.document.createTextNode("");r.observe(a,{characterData:!0}),e=function(){a.data=s=++s%2}}else if(t.setImmediate||void 0===t.MessageChannel)e="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){c(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(c,0)};else{var l=new t.MessageChannel;l.port1.onmessage=c,e=function(){l.port2.postMessage(0)}}var h=[];function c(){var t,e;n=!0;for(var i=h.length;i;){for(e=h,h=[],t=-1;++t<i;)e[t]();i=h.length}n=!1}i.exports=function(t){1!==h.push(t)||n||e()}}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,i){"use strict";var n=t(1);function o(){}var s={},r=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function h(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,t!==o&&d(this,t)}function c(t,e,i){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function u(t,e,i){n(function(){var n;try{n=e(i)}catch(e){return s.reject(t,e)}n===t?s.reject(t,new TypeError("Cannot resolve promise with itself")):s.resolve(t,n)})}function p(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function d(t,e){var i=!1;function n(e){i||(i=!0,s.reject(t,e))}function o(e){i||(i=!0,s.resolve(t,e))}var r=f(function(){e(o,n)});"error"===r.status&&n(r.value)}function f(t,e){var i={};try{i.value=t(e),i.status="success"}catch(t){i.status="error",i.value=t}return i}e.exports=h,h.prototype.catch=function(t){return this.then(null,t)},h.prototype.then=function(t,e){if("function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===r)return this;var i=new this.constructor(o);this.state!==l?u(i,this.state===a?t:e,this.outcome):this.queue.push(new c(i,t,e));return i},c.prototype.callFulfilled=function(t){s.resolve(this.promise,t)},c.prototype.otherCallFulfilled=function(t){u(this.promise,this.onFulfilled,t)},c.prototype.callRejected=function(t){s.reject(this.promise,t)},c.prototype.otherCallRejected=function(t){u(this.promise,this.onRejected,t)},s.resolve=function(t,e){var i=f(p,e);if("error"===i.status)return s.reject(t,i.value);var n=i.value;if(n)d(t,n);else{t.state=a,t.outcome=e;for(var o=-1,r=t.queue.length;++o<r;)t.queue[o].callFulfilled(e)}return t},s.reject=function(t,e){t.state=r,t.outcome=e;for(var i=-1,n=t.queue.length;++i<n;)t.queue[i].callRejected(e);return t},h.resolve=function(t){if(t instanceof this)return t;return s.resolve(new this(o),t)},h.reject=function(t){var e=new this(o);return s.reject(e,t)},h.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,n=!1;if(!i)return this.resolve([]);var r=new Array(i),a=0,l=-1,h=new this(o);for(;++l<i;)c(t[l],l);return h;function c(t,o){e.resolve(t).then(function(t){r[o]=t,++a!==i||n||(n=!0,s.resolve(h,r))},function(t){n||(n=!0,s.reject(h,t))})}},h.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,n=!1;if(!i)return this.resolve([]);var r=-1,a=new this(o);for(;++r<i;)l=t[r],e.resolve(l).then(function(t){n||(n=!0,s.resolve(a,t))},function(t){n||(n=!0,s.reject(a,t))});var l;return a}},{1:1}]},{},[2])(2)}),n.createPromiseCapability=function(){var t={};return t.promise=new Promise(function(e,i){t.resolve=e,t.reject=i}),t}}("undefined"!=typeof exports?exports:this),function(){var t,e;!function(t){"use strict";var e=void 0,i=1e5;function n(t){switch(typeof t){case"undefined":return"undefined";case"boolean":return"boolean";case"number":return"number";case"string":return"string";default:return null===t?"null":"object"}}function o(t){return Object.prototype.toString.call(t).replace(/^\[object *|\]$/g,"")}function s(t){return"function"==typeof t}function r(t){if(null===t||t===e)throw TypeError();return Object(t)}function a(t){return t>>0}function l(t){return t>>>0}var h,c,u=Math.LN2,p=Math.abs,d=Math.floor,f=Math.log,g=Math.max,m=Math.min,v=Math.pow,b=Math.round;function w(t,e){var i=32-e;return t<<i>>i}function y(t,e){var i=32-e;return t<<i>>>i}function x(t){return[255&t]}function k(t){return w(t[0],8)}function _(t){return[255&t]}function C(t){return y(t[0],8)}function S(t){return[(t=b(Number(t)))<0?0:t>255?255:255&t]}function A(t){return[255&t,t>>8&255]}function T(t){return w(t[1]<<8|t[0],16)}function M(t){return[255&t,t>>8&255]}function E(t){return y(t[1]<<8|t[0],16)}function O(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function P(t){return w(t[3]<<24|t[2]<<16|t[1]<<8|t[0],32)}function j(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function I(t){return y(t[3]<<24|t[2]<<16|t[1]<<8|t[0],32)}function D(t,e,i){var n,o,s,r=(1<<e-1)-1;function a(t){var e=d(t),i=t-e;return i<.5?e:i>.5?e+1:e%2?e+1:e}if(t!=t)o=(1<<e)-1,s=v(2,i-1),n=0;else if(t===1/0||t===-1/0)o=(1<<e)-1,s=0,n=t<0?1:0;else if(0===t)o=0,s=0,n=1/t==-1/0?1:0;else if(n=t<0,(t=p(t))>=v(2,1-r)){o=m(d(f(t)/u),1023);var l=t/v(2,o);l<1&&(o-=1,l*=2),l>=2&&(o+=1,l/=2);var h=v(2,i);o+=r,(s=a(l*h)-h)/h>=1&&(o+=1,s=0),o>2*r&&(o=(1<<e)-1,s=0)}else o=0,s=a(t/v(2,1-r-i));var c,g=[];for(c=i;c;c-=1)g.push(s%2?1:0),s=d(s/2);for(c=e;c;c-=1)g.push(o%2?1:0),o=d(o/2);g.push(n?1:0),g.reverse();for(var b=g.join(""),w=[];b.length;)w.unshift(parseInt(b.substring(0,8),2)),b=b.substring(8);return w}function F(t,e,i){var n,o,s,r,a,l,h,c,u=[];for(n=0;n<t.length;++n)for(s=t[n],o=8;o;o-=1)u.push(s%2?1:0),s>>=1;return u.reverse(),r=u.join(""),a=(1<<e-1)-1,l=parseInt(r.substring(0,1),2)?-1:1,h=parseInt(r.substring(1,1+e),2),c=parseInt(r.substring(1+e),2),h===(1<<e)-1?0!==c?NaN:l*(1/0):h>0?l*v(2,h-a)*(1+c/v(2,i)):0!==c?l*v(2,-(a-1))*(c/v(2,i)):l<0?-0:0}function R(t){return F(t,11,52)}function B(t){return D(t,11,52)}function L(t){return F(t,8,23)}function z(t){return D(t,8,23)}h=Object.defineProperty,c=!function(){try{return Object.defineProperty({},"x",{})}catch(t){return!1}}(),h&&!c||(Object.defineProperty=function(t,e,i){if(h)try{return h(t,e,i)}catch(t){}if(t!==Object(t))throw TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in i&&Object.prototype.__defineGetter__.call(t,e,i.get),Object.prototype.__defineSetter__&&"set"in i&&Object.prototype.__defineSetter__.call(t,e,i.set),"value"in i&&(t[e]=i.value),t}),function(){function h(t){if((t=a(t))<0)throw RangeError("ArrayBuffer size is not a small enough positive integer.");Object.defineProperty(this,"byteLength",{value:t}),Object.defineProperty(this,"_bytes",{value:Array(t)});for(var e=0;e<t;e+=1)this._bytes[e]=0}function c(){if(!arguments.length||"object"!=typeof arguments[0])return function(t){if((t=a(t))<0)throw RangeError("length is not a small enough positive integer.");Object.defineProperty(this,"length",{value:t}),Object.defineProperty(this,"byteLength",{value:t*this.BYTES_PER_ELEMENT}),Object.defineProperty(this,"buffer",{value:new h(this.byteLength)}),Object.defineProperty(this,"byteOffset",{value:0})}.apply(this,arguments);if(arguments.length>=1&&"object"===n(arguments[0])&&arguments[0]instanceof c)return function(t){if(this.constructor!==t.constructor)throw TypeError();var e=t.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new h(e)}),Object.defineProperty(this,"byteLength",{value:e}),Object.defineProperty(this,"byteOffset",{value:0}),Object.defineProperty(this,"length",{value:t.length});for(var i=0;i<this.length;i+=1)this._setter(i,t._getter(i))}.apply(this,arguments);if(arguments.length>=1&&"object"===n(arguments[0])&&!(arguments[0]instanceof c)&&!(arguments[0]instanceof h||"ArrayBuffer"===o(arguments[0])))return function(t){var e=t.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new h(e)}),Object.defineProperty(this,"byteLength",{value:e}),Object.defineProperty(this,"byteOffset",{value:0}),Object.defineProperty(this,"length",{value:t.length});for(var i=0;i<this.length;i+=1){var n=t[i];this._setter(i,Number(n))}}.apply(this,arguments);if(arguments.length>=1&&"object"===n(arguments[0])&&(arguments[0]instanceof h||"ArrayBuffer"===o(arguments[0])))return function(t,i,n){if((i=l(i))>t.byteLength)throw RangeError("byteOffset out of range");if(i%this.BYTES_PER_ELEMENT)throw RangeError("buffer length minus the byteOffset is not a multiple of the element size.");if(n===e){var o=t.byteLength-i;if(o%this.BYTES_PER_ELEMENT)throw RangeError("length of buffer minus byteOffset not a multiple of the element size");n=o/this.BYTES_PER_ELEMENT}else o=(n=l(n))*this.BYTES_PER_ELEMENT;if(i+o>t.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:t}),Object.defineProperty(this,"byteLength",{value:o}),Object.defineProperty(this,"byteOffset",{value:i}),Object.defineProperty(this,"length",{value:n})}.apply(this,arguments);throw TypeError()}t.ArrayBuffer=t.ArrayBuffer||h,Object.defineProperty(c,"from",{value:function(t){return new this(t)}}),Object.defineProperty(c,"of",{value:function(){return new this(arguments)}});var u={};function f(e,n,o){var s=function(){Object.defineProperty(this,"constructor",{value:s}),c.apply(this,arguments),function(e){if(!("TYPED_ARRAY_POLYFILL_NO_ARRAY_ACCESSORS"in t)){if(e.length>i)throw RangeError("Array too large for polyfill");var n;for(n=0;n<e.length;n+=1)o(n)}function o(t){Object.defineProperty(e,t,{get:function(){return e._getter(t)},set:function(i){e._setter(t,i)},enumerable:!0,configurable:!1})}}(this)};"__proto__"in s?s.__proto__=c:(s.from=c.from,s.of=c.of),s.BYTES_PER_ELEMENT=e;var r=function(){};return r.prototype=u,s.prototype=new r,Object.defineProperty(s.prototype,"BYTES_PER_ELEMENT",{value:e}),Object.defineProperty(s.prototype,"_pack",{value:n}),Object.defineProperty(s.prototype,"_unpack",{value:o}),s}c.prototype=u,Object.defineProperty(c.prototype,"_getter",{value:function(t){if(arguments.length<1)throw SyntaxError("Not enough arguments");if((t=l(t))>=this.length)return e;var i,n,o=[];for(i=0,n=this.byteOffset+t*this.BYTES_PER_ELEMENT;i<this.BYTES_PER_ELEMENT;i+=1,n+=1)o.push(this.buffer._bytes[n]);return this._unpack(o)}}),Object.defineProperty(c.prototype,"get",{value:c.prototype._getter}),Object.defineProperty(c.prototype,"_setter",{value:function(t,e){if(arguments.length<2)throw SyntaxError("Not enough arguments");if(!((t=l(t))>=this.length)){var i,n,o=this._pack(e);for(i=0,n=this.byteOffset+t*this.BYTES_PER_ELEMENT;i<this.BYTES_PER_ELEMENT;i+=1,n+=1)this.buffer._bytes[n]=o[i]}}}),Object.defineProperty(c.prototype,"constructor",{value:c}),Object.defineProperty(c.prototype,"copyWithin",{value:function(t,i){var n=arguments[2],o=r(this),s=l(o.length);s=g(s,0);var h,c=a(t);h=c<0?g(s+c,0):m(c,s);var u,p,d,f=a(i);u=f<0?g(s+f,0):m(f,s),d=(p=n===e?s:a(n))<0?g(s+p,0):m(p,s);var v,b=m(d-u,s-h);for(u<h&&h<u+b?(v=-1,u=u+b-1,h=h+b-1):v=1;b>0;)o._setter(h,o._getter(u)),u+=v,h+=v,b-=1;return o}}),Object.defineProperty(c.prototype,"every",{value:function(t){if(this===e||null===this)throw TypeError();var i=Object(this),n=l(i.length);if(!s(t))throw TypeError();for(var o=arguments[1],r=0;r<n;r++)if(!t.call(o,i._getter(r),r,i))return!1;return!0}}),Object.defineProperty(c.prototype,"fill",{value:function(t){var i=arguments[1],n=arguments[2],o=r(this),s=l(o.length);s=g(s,0);var h,c,u,p=a(i);for(h=p<0?g(s+p,0):m(p,s),u=(c=n===e?s:a(n))<0?g(s+c,0):m(c,s);h<u;)o._setter(h,t),h+=1;return o}}),Object.defineProperty(c.prototype,"filter",{value:function(t){if(this===e||null===this)throw TypeError();var i=Object(this),n=l(i.length);if(!s(t))throw TypeError();for(var o=[],r=arguments[1],a=0;a<n;a++){var h=i._getter(a);t.call(r,h,a,i)&&o.push(h)}return new this.constructor(o)}}),Object.defineProperty(c.prototype,"find",{value:function(t){var i=r(this),n=l(i.length);if(!s(t))throw TypeError();for(var o=arguments.length>1?arguments[1]:e,a=0;a<n;){var h=i._getter(a),c=t.call(o,h,a,i);if(Boolean(c))return h;++a}return e}}),Object.defineProperty(c.prototype,"findIndex",{value:function(t){var i=r(this),n=l(i.length);if(!s(t))throw TypeError();for(var o=arguments.length>1?arguments[1]:e,a=0;a<n;){var h=i._getter(a),c=t.call(o,h,a,i);if(Boolean(c))return a;++a}return-1}}),Object.defineProperty(c.prototype,"forEach",{value:function(t){if(this===e||null===this)throw TypeError();var i=Object(this),n=l(i.length);if(!s(t))throw TypeError();for(var o=arguments[1],r=0;r<n;r++)t.call(o,i._getter(r),r,i)}}),Object.defineProperty(c.prototype,"indexOf",{value:function(t){if(this===e||null===this)throw TypeError();var i=Object(this),n=l(i.length);if(0===n)return-1;var o=0;if(arguments.length>0&&((o=Number(arguments[1]))!=o?o=0:0!==o&&o!==1/0&&o!==-1/0&&(o=(o>0||-1)*d(p(o)))),o>=n)return-1;for(var s=o>=0?o:g(n-p(o),0);s<n;s++)if(i._getter(s)===t)return s;return-1}}),Object.defineProperty(c.prototype,"join",{value:function(t){if(this===e||null===this)throw TypeError();for(var i=Object(this),n=l(i.length),o=Array(n),s=0;s<n;++s)o[s]=i._getter(s);return o.join(t===e?",":t)}}),Object.defineProperty(c.prototype,"lastIndexOf",{value:function(t){if(this===e||null===this)throw TypeError();var i=Object(this),n=l(i.length);if(0===n)return-1;var o=n;arguments.length>1&&((o=Number(arguments[1]))!=o?o=0:0!==o&&o!==1/0&&o!==-1/0&&(o=(o>0||-1)*d(p(o))));for(var s=o>=0?m(o,n-1):n-p(o);s>=0;s--)if(i._getter(s)===t)return s;return-1}}),Object.defineProperty(c.prototype,"map",{value:function(t){if(this===e||null===this)throw TypeError();var i=Object(this),n=l(i.length);if(!s(t))throw TypeError();var o=[];o.length=n;for(var r=arguments[1],a=0;a<n;a++)o[a]=t.call(r,i._getter(a),a,i);return new this.constructor(o)}}),Object.defineProperty(c.prototype,"reduce",{value:function(t){if(this===e||null===this)throw TypeError();var i=Object(this),n=l(i.length);if(!s(t))throw TypeError();if(0===n&&1===arguments.length)throw TypeError();var o,r=0;for(o=arguments.length>=2?arguments[1]:i._getter(r++);r<n;)o=t.call(e,o,i._getter(r),r,i),r++;return o}}),Object.defineProperty(c.prototype,"reduceRight",{value:function(t){if(this===e||null===this)throw TypeError();var i=Object(this),n=l(i.length);if(!s(t))throw TypeError();if(0===n&&1===arguments.length)throw TypeError();var o,r=n-1;for(o=arguments.length>=2?arguments[1]:i._getter(r--);r>=0;)o=t.call(e,o,i._getter(r),r,i),r--;return o}}),Object.defineProperty(c.prototype,"reverse",{value:function(){if(this===e||null===this)throw TypeError();for(var t=Object(this),i=l(t.length),n=d(i/2),o=0,s=i-1;o<n;++o,--s){var r=t._getter(o);t._setter(o,t._getter(s)),t._setter(s,r)}return t}}),Object.defineProperty(c.prototype,"set",{value:function(t,e){if(arguments.length<1)throw SyntaxError("Not enough arguments");var i,n,o,s,r,a,h,c,u,p;if("object"==typeof arguments[0]&&arguments[0].constructor===this.constructor){if(i=arguments[0],(o=l(arguments[1]))+i.length>this.length)throw RangeError("Offset plus length of array is out of range");if(c=this.byteOffset+o*this.BYTES_PER_ELEMENT,u=i.length*this.BYTES_PER_ELEMENT,i.buffer===this.buffer){for(p=[],r=0,a=i.byteOffset;r<u;r+=1,a+=1)p[r]=i.buffer._bytes[a];for(r=0,h=c;r<u;r+=1,h+=1)this.buffer._bytes[h]=p[r]}else for(r=0,a=i.byteOffset,h=c;r<u;r+=1,a+=1,h+=1)this.buffer._bytes[h]=i.buffer._bytes[a]}else{if("object"!=typeof arguments[0]||void 0===arguments[0].length)throw TypeError("Unexpected argument type(s)");if(s=l((n=arguments[0]).length),(o=l(arguments[1]))+s>this.length)throw RangeError("Offset plus length of array is out of range");for(r=0;r<s;r+=1)a=n[r],this._setter(o+r,Number(a))}}}),Object.defineProperty(c.prototype,"slice",{value:function(t,i){for(var n=r(this),o=l(n.length),s=a(t),h=s<0?g(o+s,0):m(s,o),c=i===e?o:a(i),u=c<0?g(o+c,0):m(c,o),p=u-h,d=new(0,n.constructor)(p),f=0;h<u;){var v=n._getter(h);d._setter(f,v),++h,++f}return d}}),Object.defineProperty(c.prototype,"some",{value:function(t){if(this===e||null===this)throw TypeError();var i=Object(this),n=l(i.length);if(!s(t))throw TypeError();for(var o=arguments[1],r=0;r<n;r++)if(t.call(o,i._getter(r),r,i))return!0;return!1}}),Object.defineProperty(c.prototype,"sort",{value:function(t){if(this===e||null===this)throw TypeError();for(var i=Object(this),n=l(i.length),o=Array(n),s=0;s<n;++s)o[s]=i._getter(s);for(t?o.sort(t):o.sort(),s=0;s<n;++s)i._setter(s,o[s]);return i}}),Object.defineProperty(c.prototype,"subarray",{value:function(t,e){function i(t,e,i){return t<e?e:t>i?i:t}t=a(t),e=a(e),arguments.length<1&&(t=0),arguments.length<2&&(e=this.length),t<0&&(t=this.length+t),e<0&&(e=this.length+e),t=i(t,0,this.length);var n=(e=i(e,0,this.length))-t;return n<0&&(n=0),new this.constructor(this.buffer,this.byteOffset+t*this.BYTES_PER_ELEMENT,n)}});var v=f(1,x,k),b=f(1,_,C),w=f(1,S,C),y=f(2,A,T),D=f(2,M,E),F=f(4,O,P),Y=f(4,j,I),W=f(4,z,L),q=f(8,B,R);t.Int8Array=t.Int8Array||v,t.Uint8Array=t.Uint8Array||b,t.Uint8ClampedArray=t.Uint8ClampedArray||w,t.Int16Array=t.Int16Array||y,t.Uint16Array=t.Uint16Array||D,t.Int32Array=t.Int32Array||F,t.Uint32Array=t.Uint32Array||Y,t.Float32Array=t.Float32Array||W,t.Float64Array=t.Float64Array||q}(),function(){function i(t,e){return s(t.get)?t.get(e):t[e]}var n,r=(n=new Uint16Array([4660]),18===i(new Uint8Array(n.buffer),0));function a(t,i,n){if(!(t instanceof ArrayBuffer||"ArrayBuffer"===o(t)))throw TypeError();if((i=l(i))>t.byteLength)throw RangeError("byteOffset out of range");if(i+(n=n===e?t.byteLength-i:l(n))>t.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:t}),Object.defineProperty(this,"byteLength",{value:n}),Object.defineProperty(this,"byteOffset",{value:i})}function h(t){return function(e,n){if((e=l(e))+t.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");e+=this.byteOffset;for(var o=new Uint8Array(this.buffer,e,t.BYTES_PER_ELEMENT),s=[],a=0;a<t.BYTES_PER_ELEMENT;a+=1)s.push(i(o,a));return Boolean(n)===Boolean(r)&&s.reverse(),i(new t(new Uint8Array(s).buffer),0)}}function c(t){return function(e,n,o){if((e=l(e))+t.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");var s,a=new t([n]),h=new Uint8Array(a.buffer),c=[];for(s=0;s<t.BYTES_PER_ELEMENT;s+=1)c.push(i(h,s));Boolean(o)===Boolean(r)&&c.reverse(),new Uint8Array(this.buffer,e,t.BYTES_PER_ELEMENT).set(c)}}Object.defineProperty(a.prototype,"getUint8",{value:h(Uint8Array)}),Object.defineProperty(a.prototype,"getInt8",{value:h(Int8Array)}),Object.defineProperty(a.prototype,"getUint16",{value:h(Uint16Array)}),Object.defineProperty(a.prototype,"getInt16",{value:h(Int16Array)}),Object.defineProperty(a.prototype,"getUint32",{value:h(Uint32Array)}),Object.defineProperty(a.prototype,"getInt32",{value:h(Int32Array)}),Object.defineProperty(a.prototype,"getFloat32",{value:h(Float32Array)}),Object.defineProperty(a.prototype,"getFloat64",{value:h(Float64Array)}),Object.defineProperty(a.prototype,"setUint8",{value:c(Uint8Array)}),Object.defineProperty(a.prototype,"setInt8",{value:c(Int8Array)}),Object.defineProperty(a.prototype,"setUint16",{value:c(Uint16Array)}),Object.defineProperty(a.prototype,"setInt16",{value:c(Int16Array)}),Object.defineProperty(a.prototype,"setUint32",{value:c(Uint32Array)}),Object.defineProperty(a.prototype,"setInt32",{value:c(Int32Array)}),Object.defineProperty(a.prototype,"setFloat32",{value:c(Float32Array)}),Object.defineProperty(a.prototype,"setFloat64",{value:c(Float64Array)}),t.DataView=t.DataView||a}()}(self),String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")},String.prototype.trimRight=function(){return this.replace(/\s+$/,"")},Node.prototype.hasClass=function(t){return this.classList?this.classList.contains(t):-1<this.className.indexOf(t)},Node.prototype.addClass=function(t){if(this.classList)this.classList.add(t);else if(!this.hasClass(t)){var e=this.className.split(" ");e.push(t),this.className=e.join(" ")}return this},Node.prototype.removeClass=function(t){if(this.classList)this.classList.remove(t);else{var e=this.className.split(" ");e.splice(e.indexOf(t),1),this.className=e.join(" ")}return this},NodeList.prototype.forEach||(NodeList.prototype.forEach=Array.prototype.forEach),CanvasRenderingContext2D.prototype.getFontStyle=function(){var t=document.createElement("div");t.style.cssText="font: "+this.font+" !important;",this.canvas.appendChild(t);var e=window.getComputedStyle(t),i={fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontVariant:e.fontVariant,fontWeight:e.fontWeight,lineHeight:e.lineHeight};return this.canvas.removeChild(t),i},CanvasRenderingContext2D.prototype.textArea=function(t,e,i,n,o,s,r){var a,l,h,c,u,p=t instanceof Array?t:t.split(/\b(?=\S)|(?=\s)/g),d=this.getFontStyle(),f=this.textBaseline,g=r||0,m=0,v=parseInt(d.fontSize);for(s=(s||1)*v,this.textBaseline="top",l=0;l<p.length;++l)if("\n"!==p[l]){if(!g&&/^\t+/.test(p[l])&&(p[l]=p[l].replace(/^\t+/,"")),(h=n-(a=this.measureText(p[l]).width))<=0){if((h=Math.abs(h))-n<=0){for(c=p[l].length;c;--c)if(n>this.measureText(p[l].substr(0,c)+"-").width+v){u=c;break}}else for(c=0;c<p[l].length;++c)if(n<this.measureText(p[l].substr(0,c+1)+"-").width+v){u=c;break}if(u){var b=p[l].substr(0,c+1)+"-",w=p[l].substr(c+1);p[l]=b,p.splice(l+1,0,w),a=this.measureText(b).width}}if(g>0&&g+a>=n){if(m+2*s>=o)return{x:g+e,y:m+i,remainder:p.slice(l)};if(g=0,m+=s," "===p[l])continue}this.fillText(p[l],g+e,m+i),g+=a}else g=0,m+=s;return this.textBaseline=f,{x:g+e,y:m+i,remainder:[]}},function(){var t=/\s+/,e=/^\s+(.*)\s+$/,i=Object.prototype,n=i.toString;i.hasOwnProperty,Array.prototype.slice;function o(t){return n.call(t).slice(8,-1).toLowerCase()}function s(t){return void 0===t}function r(t){return"object"===(void 0===t?"undefined":_typeof(t))&&null!==t}function a(t){return"function"===o(t)}function l(t){return"string"==typeof t&&(t=t.trim?t.trim():t.replace(e,"1")),t}function h(t,e){if(t&&a(e)){var i=void 0;if(l=t,(Array.isArray?Array.isArray(l):"array"===o(l))||"number"==typeof(s=t.length)&&!isNaN(s)){var n=t.length;for(i=0;i<n&&!1!==e.call(t,t[i],i,t);i++);}else r(t)&&Object.keys(t).forEach(function(i){e.call(t,t[i],i,t)})}var s,l;return t}function c(e,i,n){var o=l(i).split(t);o.length>1?h(o,function(t){c(e,t,n)}):e.removeEventListener?e.removeEventListener(i,n,!1):e.detachEvent&&e.detachEvent("on"+i,n)}iws.event={addListener:function e(i,n,o,s){var r=l(n).split(t),a=o;r.length>1?h(r,function(t){e(i,t,o)}):(s&&(o=function(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s];return c(i,n,o),a.apply(i,e)}),i.addEventListener?i.addEventListener(n,o,!1):i.attachEvent&&i.attachEvent("on"+n,o))},removeListener:c,dispatchEvent:function(t,e,i){if(t.dispatchEvent){var n=void 0;return a(Event)&&a(CustomEvent)?n=s(i)?new Event(e,{bubbles:!0,cancelable:!0}):new CustomEvent(e,{detail:i,bubbles:!0,cancelable:!0}):s(i)?(n=document.createEvent("Event")).initEvent(e,!0,!0):(n=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,i),t.dispatchEvent(n)}return!t.fireEvent||t.fireEvent("on"+e)}}}(),function(){"use strict";var t=Math.PI/180;function e(t){return"function"==typeof t}iws.util={compareObjects:function(t,e){if(typeof t==typeof e)if("object"==typeof t)for(var i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i);else console.log('arguments are not typeof === "object"');else console.log("two objects not the same type")},degreesToRadians:function(e){return e*t},radiansToDegrees:function(e){return e/t},rotatePoint:function(t,e,i){t.subtractEquals(e);var n=iws.util.rotateVector(t,i);return new iws.Point(n.x,n.y).addEquals(e)},rotateVector:function(t,e){var i=Math.sin(e),n=Math.cos(e);return{x:t.x*n-t.y*i,y:t.x*i+t.y*n}},falseFunction:function(){return!1},getFunctionBody:function(t){return(String(t).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},loadImage:function(t,e,i,n){if(t){var o=document.createElement("img");o.onload=function(){e&&e.call(i,o),o=o.onload=o.onerror=null},o.onerror=function(){iws.log("Error loading "+o.src),e&&e.call(i,null,!0),o=o.onload=o.onerror=null},0!==t.indexOf("data")&&n&&(o.crossOrigin=n),o.src=t}else e&&e.call(i,t)},makeElement:function(t,e){var i=document.createElement(t);for(var n in e)"class"===n?i.className=e[n]:"for"===n?i.htmlFor=e[n]:i.setAttribute(n,e[n]);return i},wrapElement:function(t,e,i){return"string"==typeof e&&(e=this.makeElement(e,i)),t.parentNode&&t.parentNode.replaceChild(e,t),e.appendChild(t),e},addClass:function(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)},drawDashedLine:function(t,e,i,n,o,s){var r=n-e,a=o-i,l=sqrt(r*r+a*a),h=atan2(a,r),c=s.length,u=0,p=!0;for(t.save(),t.translate(e,i),t.moveTo(0,0),t.rotate(h),e=0;l>e;)(e+=s[u++%c])>l&&(e=l),t[p?"lineTo":"moveTo"](e,0),p=!p;t.restore()},clipContext:function(t,e){e.save(),e.beginPath(),t.clipTo(e),e.clip()},transformPoint:function(t,e,i){return i?new iws.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new iws.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},invertTransform:function(t){var e=1/(t[0]*t[3]-t[1]*t[2]),i=[e*t[3],-e*t[1],-e*t[2],e*t[0]],n=iws.util.transformPoint({x:t[4],y:t[5]},i,!0);return i[4]=-n.x,i[5]=-n.y,i},makeBoundingBoxFromPoints:function(t){var e=[t[0].x,t[1].x,t[2].x,t[3].x],i=iws.util.array.min(e),n=iws.util.array.max(e),o=Math.abs(i-n),s=[t[0].y,t[1].y,t[2].y,t[3].y],r=iws.util.array.min(s),a=iws.util.array.max(s);return{left:i,top:r,width:o,height:Math.abs(r-a)}},multiplyTransformMatrices:function(t,e,i){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],i?0:t[0]*e[4]+t[2]*e[5]+t[4],i?0:t[1]*e[4]+t[3]*e[5]+t[5]]},qrDecompose:function(e){var i=Math.atan2(e[1],e[0]),n=Math.pow(e[0],2)+Math.pow(e[1],2),o=Math.sqrt(n),s=(e[0]*e[3]-e[2]*e[1])/o,r=Math.atan2(e[0]*e[2]+e[1]*e[3],n);return{angle:i/t,scaleX:o,scaleY:s,skewX:r/t,skewY:0,translateX:e[4],translateY:e[5]}},populateWithProperties:function(t,e,i){if(i&&"[object Array]"===Object.prototype.toString.call(i))for(var n=0,o=i.length;n<o;n++)i[n]in t&&(e[i[n]]=t[i[n]])},getKlass:function(t,e,i){return t=iws.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),iws.util.resolveNamespace(e)[i+t]},resolveNamespace:function(t){if(!t)return iws;var e,i=t.split("."),n=i.length,o=global||iws.window;for(e=0;e<n;++e)o=o[i[e]];return o}},iws.util.equals=function t(i,n){if(i===n)return!0;if(null===i||null===n)return!1;if(i!=i&&n!=n)return!0;var o,s,r,a=typeof i;if(a==typeof n&&"object"==a){if(!Array.isArray(i)){r={},o=0;for(s in i)if("$"!==s.charAt(0)){if(!e(i[s])&&!t(i[s],n[s]))return!1;o++,r[s]=!0}for(s in n)if("$"!==s.charAt(0)){if(!r[s]&&!e(n[s]))return!1;o--}return 0===o}if((o=i.length)==n.length){for(s=0;s<o;s++)if(!t(i[s],n[s]))return!1;return!0}}return!1}}(),function(){iws.util.string={camelize:function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},capitalize:function(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())},escapeXml:function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},combinePath:function(t,e){return void 0===t||""===t?e:"/"===t.charAt(t.length-1)?"/"===e.charAt(0)?t+e.slice(1):t+e:"/"===e.charAt(0)?t+e:t+"/"+e}}}(),function(){"use strict";iws.util.find={getAngleFromPointToPoint:function(t,e,i,n){var o=i-t,s=n-e,r=Math.atan2(s,o);return{radian:r,angle:180*r/Math.PI}},distanceOfTwoPoints:function(t,e){var i=Math.pow(t.x-e.x,2),n=Math.pow(t.y-e.y,2);return Math.sqrt(i+n)},getContainFromCoords:function(t,e){var i=this._getImageLines(t),n=this._findCrossPoints(e,i);return 0!==n&&n%2==1},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var i,n,o,s,r=0;for(var a in e)if(!((s=e[a]).o.y<t.y&&s.d.y<t.y||s.o.y>=t.y&&s.d.y>=t.y||(s.o.x===s.d.x&&s.o.x>=t.x?o=s.o.x:(i=0,n=(s.d.y-s.o.y)/(s.d.x-s.o.x),o=-(t.y-i*t.x-(s.o.y-n*s.o.x))/(i-n)),o>=t.x&&(r+=1),2!==r)))break;return r}}}(),function(){"use strict";function t(){}function e(t){var e=this.constructor.superclass.prototype[t];return arguments.length>1?e.apply(this,Array.prototype.slice.call(arguments,1)):e.call(this)}iws.util.createInheritClass=function(){var i=null,n=Array.prototype.slice.call(arguments,0),o=n.shift();o.subclasses=[],"function"==typeof n[0]&&(i=n.shift(),t.prototype=i.prototype,o.prototype=new t,i.subclasses.push(o)),o.superclass=i;for(var s=0,r=n.length;s<r;s++)for(var a in n[s]){var l=n[s];o.prototype[a]=l[a]}return o.prototype.constructor=o,o.prototype.callSuper=e,o}}(),function(){var t,e=document.documentElement.style,i="userSelect"in e?"userSelect":"MozUserSelect"in e?"MozUserSelect":"WebkitUserSelect"in e?"WebkitUserSelect":"KhtmlUserSelect"in e?"KhtmlUserSelect":"";function n(t){for(var e=0,i=0,n=document.documentElement,o=document.body||{scrollLeft:0,scrollTop:0};t&&(t.parentNode||t.host)&&((t=t.parentNode||t.host)===document?(e=o.scrollLeft||n.scrollLeft||0,i=o.scrollTop||n.scrollTop||0):(e+=t.scrollLeft||0,i+=t.scrollTop||0),1!==t.nodeType||"fixed"!==iws.util.getElementStyle(t,"position")););return{left:e,top:i}}t=document.defaultView&&document.defaultView.getComputedStyle?function(t,e){var i=document.defaultView.getComputedStyle(t,null);return i?i[e]:void 0}:function(t,e){var i=t.style[e];return!i&&t.currentStyle&&(i=t.currentStyle[e]),i},iws.util.makeElementUnselectable=function(t){return $(t).attr("unselectable","on").css({"-moz-user-select":"-moz-none","-moz-user-select":"none","-o-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none"}).bind("selectstart",function(){return!1}),t},iws.util.makeElementSelectable=function(t){return void 0!==t.onselectstart&&(t.onselectstart=null),i?t.style[i]="":"string"==typeof t.unselectable&&(t.unselectable=""),t},iws.util.getScrollLeftTop=n,iws.util.getElementOffset=function(e){var i,o,s=e&&e.ownerDocument,r={left:0,top:0},a={left:0,top:0},l={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!s)return a;for(var h in l)a[l[h]]+=parseInt(t(e,h),10)||0;return i=s.documentElement,void 0!==e.getBoundingClientRect&&(r=e.getBoundingClientRect()),o=n(e),{left:r.left+o.left-(i.clientLeft||0)+a.left,top:r.top+o.top-(i.clientTop||0)+a.top}},iws.util.getElementStyle=t,iws.util.getPointer=function(t){t||(t=window.event);var e=t.target||(typeof t.srcElement!==unknown?t.srcElement:null),i=iws.util.getScrollLeftTop(e);return{x:(t.clientX||t.touches[0].clientX)+i.left,y:(t.clientY||t.touches[0].clientY)+i.top}};var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function s(t){return toString.call(t).slice(8,-1).toLowerCase()}function r(t){return"number"==typeof t&&!isNaN(t)}function a(t,e){if(t&&"function"===s(e)){var i=void 0;if(l=t,(Array.isArray?Array.isArray(l):"array"===s(l))||r(t.length)){var n=t.length;for(i=0;i<n&&!1!==e.call(t,t[i],i,t);i++);}else a=t,"object"===(void 0===a?"undefined":o(a))&&null!==a&&Object.keys(t).forEach(function(i){e.call(t,t[i],i,t)})}var a,l;return t}function l(t){var e=t||window.event;if(e.target||(e.target=e.srcElement||document),!r(e.pageX)&&r(e.clientX)){var i=t.target.ownerDocument||document,n=i.documentElement,o=i.body;e.pageX=e.clientX+((n&&n.scrollLeft||o&&o.scrollLeft||0)-(n&&n.clientLeft||o&&o.clientLeft||0)),e.pageY=e.clientY+((n&&n.scrollTop||o&&o.scrollTop||0)-(n&&n.clientTop||o&&o.clientTop||0))}return e}iws.util.getPointers=function(t){var e=l(t),i=[];return e.changedTouches?a(e.changedTouches,function(t){i.push({x:t.pageX,y:t.pageY})}):i.push({x:e.pageX,y:e.pageY}),i},iws.util.getEvent=l,iws.util.getOffset=function(t){var e=document.documentElement,i=t.getBoundingClientRect();return{left:i.left+((window.scrollX||e&&e.scrollLeft||0)-(e&&e.clientLeft||0)),top:i.top+((window.scrollY||e&&e.scrollTop||0)-(e&&e.clientTop||0))}}}(),function(){var t=Array.prototype.slice;function e(t,e,i){if(t&&0!==t.length){var n=t.length-1,o=e?t[n][e]:t[n];if(e)for(;n--;)i(t[n][e],o)&&(o=t[n][e]);else for(;n--;)i(t[n],o)&&(o=t[n]);return o}}iws.util.array={fill:function(t,e){for(var i=t.length;i--;)t[i]=e;return t},invoke:function(e,i){for(var n=t.call(arguments,2),o=[],s=0,r=e.length;s<r;s++)o[s]=n.length?e[s][i].apply(e[s],n):e[s][i].call(e[s]);return o},min:function(t,i){return e(t,i,function(t,e){return t<e})},max:function(t,i){return e(t,i,function(t,e){return t>=e})}}}(),function(){var t={},e={},i={},n=Array.prototype.join;function o(e,i,o,a,l,h,c){var u=n.call(arguments);if(t[u])return t[u];var p=Math.PI,d=c*p/180,f=Math.sin(d),g=Math.cos(d),m=0,v=0,b=-g*e*.5-f*i*.5,w=-g*i*.5+f*e*.5,y=(o=Math.abs(o))*o,x=(a=Math.abs(a))*a,k=w*w,_=b*b,C=y*x-y*k-x*_,S=0;if(C<0){var A=Math.sqrt(1-C/(y*x));o*=A,a*=A}else S=(l===h?-1:1)*Math.sqrt(C/(y*k+x*_));var T=S*o*w/a,M=-S*a*b/o,E=g*T-f*M+.5*e,O=f*T+g*M+.5*i,P=r(1,0,(b-T)/o,(w-M)/a),j=r((b-T)/o,(w-M)/a,(-b-T)/o,(-w-M)/a);0===h&&j>0?j-=2*p:1===h&&j<0&&(j+=2*p);for(var I=Math.ceil(Math.abs(j/p*2)),D=[],F=j/I,R=8/3*Math.sin(F/4)*Math.sin(F/4)/Math.sin(F/2),B=P+F,L=0;L<I;L++)D[L]=s(P,B,g,f,o,a,E,O,R,m,v),m=D[L][4],v=D[L][5],P=B,B+=F;return t[u]=D,D}function s(t,i,o,s,r,a,l,h,c,u,p){var d=n.call(arguments);if(e[d])return e[d];var f=Math.cos(t),g=Math.sin(t),m=Math.cos(i),v=Math.sin(i),b=o*r*m-s*a*v+l,w=s*r*m+o*a*v+h,y=u+c*(-o*r*g-s*a*f),x=p+c*(-s*r*g+o*a*f),k=b+c*(o*r*v+s*a*m),_=w+c*(s*r*v-o*a*m);return e[d]=[y,x,k,_,b,w],e[d]}function r(t,e,i,n){var o=Math.atan2(e,t),s=Math.atan2(n,i);return s>=o?s-o:2*Math.PI-(o-s)}function a(t,e,o,s,r,a,l,h){var c=n.call(arguments);if(i[c])return i[c];var u,p,d,f,g,m,v,b,w=Math.sqrt,y=Math.min,x=Math.max,k=Math.abs,_=[],C=[[],[]];p=6*t-12*o+6*r,u=-3*t+9*o-9*r+3*l,d=3*o-3*t;for(var S=0;S<2;++S)if(S>0&&(p=6*e-12*s+6*a,u=-3*e+9*s-9*a+3*h,d=3*s-3*e),k(u)<1e-12){if(k(p)<1e-12)continue;0<(f=-d/p)&&f<1&&_.push(f)}else(v=p*p-4*d*u)<0||(0<(g=(-p+(b=w(v)))/(2*u))&&g<1&&_.push(g),0<(m=(-p-b)/(2*u))&&m<1&&_.push(m));for(var A,T,M,E=_.length,O=E;E--;)A=(M=1-(f=_[E]))*M*M*t+3*M*M*f*o+3*M*f*f*r+f*f*f*l,C[0][E]=A,T=M*M*M*e+3*M*M*f*s+3*M*f*f*a+f*f*f*h,C[1][E]=T;C[0][O]=t,C[1][O]=e,C[0][O+1]=l,C[1][O+1]=h;var P=[{x:y.apply(null,C[0]),y:y.apply(null,C[1])},{x:x.apply(null,C[0]),y:x.apply(null,C[1])}];return i[c]=P,P}iws.util.drawArc=function(t,e,i,n){for(var s=n[0],r=n[1],a=n[2],l=n[3],h=n[4],c=[[],[],[],[]],u=o(n[5]-e,n[6]-i,s,r,l,h,a),p=0,d=u.length;p<d;p++)c[p][0]=u[p][0]+e,c[p][1]=u[p][1]+i,c[p][2]=u[p][2]+e,c[p][3]=u[p][3]+i,c[p][4]=u[p][4]+e,c[p][5]=u[p][5]+i,t.bezierCurveTo.apply(t,c[p])},iws.util.getBoundsOfArc=function(t,e,i,n,s,r,l,h,c){for(var u,p=0,d=0,f=[],g=o(h-t,c-e,i,n,r,l,s),m=0,v=g.length;m<v;m++)u=a(p,d,g[m][0],g[m][1],g[m][2],g[m][3],g[m][4],g[m][5]),f.push({x:u[0].x+t,y:u[0].y+e}),f.push({x:u[1].x+t,y:u[1].y+e}),p=g[m][4],d=g[m][5];return f},iws.util.getBoundsOfCurve=a}(),function(){iws.util.extend=function(t,e){for(var i in e)t[i]=e[i];return t},iws.util.clone=function t(e){if(null===e||"object"!=typeof e)return e;var i=e.constructor();for(var n in e)e.hasOwnProperty(n)&&(i[n]=t(e[n]));return i}}(),function(){iws.util.resize=function(t,e){var i=iws.util.makeElement("div",{class:"resize",style:"position:absolute; width:auto; height:auto; top:0; right:0; bottom:0; left:0; margin:0; padding:0; overflow:hidden; visibility:hidden; z-index:-1"});t.appendChild(i);var n=iws.util.makeElement("iframe",{style:"width:100%; height:0; border:0; visibility:visible; margin:0"});i.appendChild(n);var o=iws.util.makeElement("iframe",{style:"width:0; height:100%; border:0; visibility:visible; margin:0"});function s(){var i=this.resizeData;i.t&&i.w===t.offsetWidth&&i.h===t.offsetHeight||(i.t&&clearTimeout(i.t),i.t=setTimeout(function(){i.w=t.offsetWidth,i.h=t.offsetHeight,e()}.bind(this),i.throttle))}i.appendChild(o),this.callback=e,this.resizeData={w:t.offsetWidth,h:t.offsetHeight,t:null,throttle:10},n.contentWindow.addEventListener("resize",s.bind(this)),o.contentWindow.addEventListener("resize",s.bind(this))}}(),iws.util.regexp={},iws.util.regexp.checkUrlForm=function(t){return/^http[s]?\:\/\//i.test(t)},iws.util.regexp.getDigitString=function(t){return t.replace(/[^-\d\.]/g,"")},iws.util.fullscreen={toggleFullScreen:function(t){var e,i=void 0!==t.webkitRequestFullScreen,n=void 0!==t.mozRequestFullScreen,o=void 0!==t.msRequestFullscreen;function e(){return n?document.mozFullScreen:i?document.webkitIsFullScreen:o?null!==document.msFullscreenElement:void 0}(i||n||o)&&((e=e())?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():t.requestFullScreen?t.requestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT))},onFullScreenChange:function(t){$(document).on("webkitfullscreenchange mozfullscreenchange MSFullscreenChange fullscreenchange",function(e){var i=!!(document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement);t&&t(i)}.bind(this))}},t=new XMLHttpRequest,iws.util.blobUrlLoad=function(t,e){0==t.indexOf("blob:")?$.ajax({type:"GET",url:t}).then(function(t){e(t)},function(t,e,i){alert("code:"+t.status+"\nmessage:"+t.responseText+"\nerror:"+i)}):e(t)},iws.util.urlDownload=function(e,i,n,o){return function(e,i,n,o){var s=0;try{t.open("GET",e)}catch(t){n("XMLHttpRequest GET error : "+t)}return t.responseType=o&&o.responseType||"arraybuffer",t.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),t.onload=function(e){200===s&&i(t.response)},t.onprogress=function(t){t.lengthComputable&&(t.loaded,t.total)},t.onreadystatechange=function(){4===t.readyState&&(200===t.status?s=t.status:n?n("There was a problem with the request.\n"+t.statusText):alert("There was a problem with the request.\n"+t.statusText))},t.send(),t}(e,i,n,o)},iws.util.xhr=t,iws.util.Unique={prevTimeId:0,prevUniqueId:0,thumbFrameId:0,getUniqueID:function(){try{var t=(new Date).getTime();return t==iws.util.Unique.prevTimeId?iws.util.Unique.prevUniqueId=iws.util.Unique.prevUniqueId+1:(iws.util.Unique.prevTimeId=t,iws.util.Unique.prevUniqueId=0),t=t+""+iws.util.Unique.prevUniqueId}catch(t){console.log("mwUnique.getUniqueID error:"+t.message+".")}},getFrameId:function(){return"thumb_frame_"+(iws.util.Unique.thumbFrameId++).toString()}},iws.util.ListenDropFile=function(t,e){t.addEventListener("dragover",function(t){t.preventDefault(),t.dataTransfer.dropEffect="copy"}),t.addEventListener("drop",function(t){t.stopPropagation(),t.preventDefault();var i=t.dataTransfer.files;if(i.length>0){var n=[],o=new iws.util.sync({callback:function(){console.log("File loaded."),e&&e(n)}});Array.prototype.forEach.call(i,function(t){console.log(escape(t.name)+"("+t.type+") - "+(t.size/1024).toFixed(2).toString()+" kb, last modified: "+t.lastModifiedDate.toLocaleDateString()+"\n");var e={file:t,callback:function(e){var i=new FileReader;i.onload=function(){var i={type:"image",buffer:this.result,caption:t.name+" ("+t.type+") - "+(t.size/1024).toFixed(2).toString()+" kb"};n.push(i),e&&e()},i.readAsArrayBuffer(this.file)}};o.addWork(e)})}})},iws.util.RemoveDropFile=function(t){t.removeEventListener("dragover"),t.removeEventListener("drop")},iws.util.run_waitMe=function(t,e,i){var n={effect:e,text:"",bg:"rgba(255,255,255,0.2)",color:"#222222",maxSize:"20px",onClose:function(){}},o=$.extend({},n,i);iws.util.waitMe(t,o)},iws.util.hide_waitMe=function(t){iws.util.waitMe(t,"hide")},iws.util.waitMe=function(t,e){return function(){var i,n,o,s,r,a,l=t,h="waitMe",c=!1,u="background-color",p="",d="",f={init:function(){switch(r=$.extend({effect:"bounce",text:"",bg:"rgba(255,255,255,0.7)",color:"#000",maxSize:"",source:"",onClose:function(){}},e),a=(new Date).getMilliseconds(),s=$('<div class="'+h+'" data-waitme_id="'+a+'"></div>'),r.effect){case"none":o=0;break;case"bounce":o=3;break;case"rotateplane":o=1;break;case"stretch":o=5;break;case"orbit":o=2;break;case"roundBounce":o=12;break;case"win8":case"win8_linear":o=5,c=!0;break;case"ios":o=12;break;case"facebook":o=3;break;case"rotation":o=1,u="border-color";break;case"timer":if(o=2,$.isArray(r.color))var t=r.color[0];else t=r.color;p="border-color:"+t;break;case"pulse":o=1,u="border-color";break;case"progressBar":o=1;break;case"bouncePulse":o=3;break;case"img":o=1}if(""!==p&&(p+=";"),o>0){if("img"===r.effect)d='<img src="'+r.source+'">';else for(var f=1;f<=o;++f)$.isArray(r.color)?void 0==(t=r.color[f])&&(t="#000"):t=r.color,d+=c?'<div class="'+h+"_progress_elem"+f+'"><div style="'+u+":"+t+'"></div></div>':'<div class="'+h+"_progress_elem"+f+'" style="'+u+":"+t+'"></div>';n=$('<div class="'+h+"_progress "+r.effect+'" style="'+p+'">'+d+"</div>")}r.text&&(t=$.isArray(r.color)?r.color[0]:r.color,i=$('<div class="'+h+'_text" style="color:'+t+'">'+r.text+"</div>"));var g=l.find("> ."+h);g&&g.remove();var m=$('<div class="'+h+'_content"></div>');m.append(n,i),s.append(m),l[0]&&"HTML"==l[0].tagName&&(l=$("body")),l.addClass(h+"_container").attr("data-waitme_id",a).append(s),g=l.find("> ."+h);var v=l.find("."+h+"_content");if(g.css({background:r.bg}),v.css({marginTop:-v.outerHeight()/2+"px"}),""!==r.maxSize){var b=n.outerHeight(),w=(n.outerWidth(),b);"img"===r.effect?(n.css({height:r.maxSize+"px"}),n.find(">img").css({maxHeight:"100%"}),v.css({marginTop:-v.outerHeight()/2+"px"})):r.maxSize<w&&m.css({transform:"scale("+r.maxSize/w+")"})}function y(t){v.css({top:"auto",transform:"translateY("+t+"px) translateZ(0)"})}if(l.outerHeight()>$(window).height()){var x=$(window).scrollTop(),k=v.outerHeight(),_=l.offset().top,C=l.outerHeight(),S=x-_+$(window).height()/2;S<0&&(S=Math.abs(S)),S-k>=0&&S+k<=C?(_-x>$(window).height()/2&&(S=k),y(S)):y(S=x>_+C-k?x-_-k:x-_+k),$(document).scroll(function(){var t=$(window).scrollTop()-_+$(window).height()/2;t-k>=0&&t+k<=C&&y(t)})}return g.on("destroyed",function(){r.onClose&&$.isFunction(r.onClose)&&r.onClose(),g.trigger("close")}),$.event.special.destroyed={remove:function(t){t.handler&&t.handler()}},g},hide:function(){var t;t=l.attr("data-waitme_id"),l.removeClass(h+"_container").removeAttr("data-waitme_id"),l.find("."+h+'[data-waitme_id="'+t+'"]').remove()}};return f[e]?f[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void 0:f.init.apply(this,arguments)}()},(e=jQuery).fn.tabSlideOut=function(t){function i(t,e){return parseInt(t.css("border-"+e+"-width"),10)}function n(){return s.hasClass("ui-slideouttab-open")}function o(){var t=e(s).parent().height();return"top"!==a&&"bottom"!==a||(t=e(s).parent().width()),t-parseInt(r.otherOffset)-parseInt(r.offset)}var s=this;if("string"==typeof t)switch(t){case"open":n()||this.children(".ui-slideouttab-handle").click();break;case"close":n()&&this.children(".ui-slideouttab-handle").click();break;case"isOpen":return n();case"toggle":this.children(".ui-slideouttab-handle").click();break;case"bounce":this.children(".ui-slideouttab-handle").trigger("bounce");break;case"resize":this.trigger("resize");break;default:throw"Invalid tabSlideOut command"}else{var r=e.extend({tabLocation:"left",tabHandle:".handle",speed:300,action:"click",offset:"200px",offsetReverse:!1,otherOffset:null,handleOffset:null,handleOffsetReverse:!1,bounceDistance:"50px",bounceTimes:4,tabImage:null,tabImageHeight:null,tabImageWidth:null,onLoadSlideOut:!1,clickScreenToClose:!0,toggleButton:".tab-opener",onOpen:function(){},onClose:function(){},onOpenStart:function(){}},t||{}),a=r.tabLocation,l=r.tabHandle=e(r.tabHandle,s);if(s.addClass("ui-slideouttab-panel"),s.addClass("ui-slideouttab-"+a),r.offsetReverse&&s.addClass("ui-slideouttab-panel-reverse"),l.addClass("ui-slideouttab-handle"),r.handleOffsetReverse&&l.addClass("ui-slideouttab-handle-reverse"),r.toggleButton=e(r.toggleButton),null!==r.tabImage){var h=0,c=0;if(null!==r.tabImageHeight&&null!==r.tabImageWidth)h=r.tabImageHeight,c=r.tabImageWidth;else{var u=new Image;u.src=r.tabImage,h=u.naturalHeight,c=u.naturalWidth}l.addClass("ui-slideouttab-handle-image"),l.css({background:"url("+r.tabImage+") no-repeat",width:c,height:h})}function p(){return{panelWidth:parseInt(s.outerWidth()+1,10)+"px",panelHeight:parseInt(s.outerHeight()+1,10)+"px",handleWidth:parseInt(l.outerWidth(),10)+"px",handleHeight:parseInt(l.outerHeight()+1,10)+"px"}}if(l.css({display:"block",position:"absolute"}),s.css({position:"absolute"}),"top"===a||"bottom"===a?(r.panelOffsetFrom=r.offsetReverse?"right":"left",r.handleOffsetFrom=r.handleOffsetReverse?"right":"left"):(r.panelOffsetFrom=r.offsetReverse?"bottom":"top",r.handleOffsetFrom=r.handleOffsetReverse?"bottom":"top"),null===r.handleOffset&&(r.handleOffset="-"+i(s,r.handleOffsetFrom)+"px"),"top"===a||"bottom"===a){s.css(r.panelOffsetFrom,r.offset),l.css(r.handleOffsetFrom,r.handleOffset),null!==r.otherOffset&&(s.css("width",o()+"px"),s.on("resize",function(){s.css("width",o()+"px")}));var d=p();"top"===a?(s.css({top:"-"+d.panelHeight}),l.css({bottom:"-"+d.handleHeight})):(s.css({bottom:"-"+d.panelHeight}),l.css({top:"-"+d.handleHeight}))}"left"!==a&&"right"!==a||(s.css(r.panelOffsetFrom,r.offset),l.css(r.handleOffsetFrom,r.handleOffset),null!==r.otherOffset&&(s.css("height",o()+"px"),s.on("resize",function(){s.css("height",o()+"px")})),d=p(),"left"===a?(s.css({left:"-"+d.panelWidth}),l.css({right:"0"})):(s.css({right:"-"+d.panelWidth}),l.css({left:"0"}))),l.click(function(t){t.preventDefault()}),r.toggleButton.click(function(t){t.preventDefault()});var f=function(){var t,e=p();switch(a){case"top":case"bottom":t=e.panelHeight;break;case"left":case"right":t=e.panelWidth}var i=[];i[a]="-"+t,s.removeClass("ui-slideouttab-open").animate(i,r.speed,function(){s.trigger("slideouttabclose"),r.onClose()})},g=function(){r.onOpenStart();var t=[];t[a]="-"+i(s,a)+"px",s.animate(t,r.speed,function(){s.addClass("ui-slideouttab-open").trigger("slideouttabopen"),r.onOpen()})},m=[];m[a]="-="+r.bounceDistance;var v=[];v[a]="+="+r.bounceDistance;var b=function(){s.click(function(t){t.stopPropagation()}),r.toggleButton.click(function(t){t.stopPropagation()}),e(document).click(function(){n()&&f()})};"click"===r.action&&(l.click(function(t){n()?f():g()}),r.toggleButton.click(function(t){n()?f():g()}),r.clickScreenToClose&&b()),"hover"===r.action&&(s.hover(function(){n()||g()},function(){n()&&setTimeout(f,1e3)}),l.click(function(t){n()&&f()}),r.toggleButton.click(function(t){n()?f():g()}),r.clickScreenToClose&&b()),r.onLoadSlideOut&&(f(),setTimeout(g,500)),l.on("bounce",function(t){n()?function(){for(var t=s,e=0;e<r.bounceTimes;e++)t=t.animate(m,r.speed).animate(v,r.speed);s.trigger("slideouttabbounce")}():function(){for(var t=s,e=0;e<r.bounceTimes;e++)t=t.animate(v,r.speed).animate(m,r.speed);s.trigger("slideouttabbounce")}()})}return this},iws.util.work={},"undefined"==typeof Worker&&console.log(">>>> \tworker 작동하지 않는 환경입니다."),iws.util.work.Spliter=function(t,e){var i=new Worker(t);i.onerror=function(t){console.log("iwsT.Spliter : "+event.message+" ("+event.filename+":"+event.lineno+")")};var n=function(){},o=function(t){},s=iws.createPromiseCapability();return s.resolve(!0),{init:function(){return s.promise.then(function(){console.log("Spliter finished.")})},close:function(){return s.promise.then(function(){null!==i&&(i.terminate(),i=null,console.log("Spliter closed."))})},postMessage:function(t){s=iws.createPromiseCapability(),i.onmessage=function(t){n(t),s.resolve()},i.onerror=function(t){console.log("iwsT.Spliter : "+t.message+" ("+t.filename+":"+t.lineno+")"),o(t),s.reject()},i.postMessage(t)},callBackonmessage:function(t){n=t},callBackonerror:function(t){o=t}}},iws.util.work.WorkCrew=function(t,e,i,n){this.filename=t,this.count=this.mincount=e,this.maxcount=i||4,this.queue=[],this.results=[],this.pool=[],this.working={},this.uuid=0,this.fillPool(),this.isRunning=!1,this.inited=function(){},this.refresh=n,this._capability=iws.createPromiseCapability(),this._capability.resolve()},iws.util.work.WorkCrew.prototype.onfinish=function(){},iws.util.work.WorkCrew.prototype.onstarted=function(t){},iws.util.work.WorkCrew.prototype.oncomplete=function(t,e){},iws.util.work.WorkCrew.prototype.oncanceled=function(t){},iws.util.work.WorkCrew.prototype.unshiftWork=function(t){0===this.count&&(this.count++,this.addWorker()),this.isRunning=!0;var e=this.uuid++;return this.queue.unshift({id:e,work:t}),this.processQueue(),e},iws.util.work.WorkCrew.prototype.addWork=function(t){0===this.count&&(this.count++,this.addWorker()),this.isRunning=!0;var e=this.uuid++;return this.queue.push({id:e,work:t}),this.processQueue(),e},iws.util.work.WorkCrew.prototype.close=function(){this.mincount=0,this.init();for(var t=this.pool.length,e=0;e<t;e++){var i=this.pool.shift();i.terminate(),i=void 0}},iws.util.work.WorkCrew.prototype.init=function(){if(this.uuid=0,!0===this.isRunning){for(var t=this.queue.length-1;t>=0;t--)this.queue.splice(t,1);for(var t in this.working);}return this._capability.promise.then(function(){console.log("WorkCrew finished.")})},iws.util.work.WorkCrew.prototype.clearData=function(t){if(null===t)for(var e=this.queue.length-1;e>=0;e--)this.oncanceled(this.queue[e].work),this.queue.splice(e,1);else for(e=this.queue.length-1;e>=0;e--)t===this.queue[e].work.cmd&&(this.oncanceled(this.queue[e].work),this.queue.splice(e,1))},iws.util.work.WorkCrew.prototype.initAsync=function(){for(var t=this.queue.length-1;t>=0;t--)this.queue.splice(t,1);this.uuid=0;var e,i=this;e=this.inited,function t(){setTimeout(function(){!0===i.isRunning?t():e()},0)}()},iws.util.work.WorkCrew.prototype.processQueue=function(){if(0==this.queue.length&&this.pool.length==this.count){if(this.onfinish){var t=this.count-this.mincount;this.refresh&&(t=this.count);for(var e=0;e<t;e++)(i=this.pool.shift()).terminate(),i=void 0,this.count--;if(this.onfinish(),this.isRunning=!1,this.uuid=0,this.refresh)for(e=0;e<this.mincount;e++)this.addWorker(),this.count++}}else for(;this.queue.length>0&&this.pool.length>0;){var i,n=this.queue.shift();(i=this.pool.shift()).id=n.id,i.work=n.work,this.working[i.id]=i,i.postMessage(n.work),this.onstarted(n.work)}},iws.util.work.WorkCrew.prototype.addWorker=function(){var t=new Worker(this.filename),e=this;t.onmessage=function(t){var i=this.id;delete e.working[this.id],this.id=null,e.pool.push(this);try{e.oncomplete(i,t)}catch(n){console.log(n),console.log("iwsT.WorkCrew onmessage: "+n.message+" ("+n.filename+":"+n.lineno+")"),e.oncomplete(i,t)}0!==e.queue.length&&e.count<e.maxcount&&(e.addWorker(),e.count++),e.processQueue()},t.onerror=function(t){console.log("iwsT.WorkCrew onerror: "+t.message+" ("+t.filename+":"+t.lineno+")")},this.pool.push(t)},iws.util.work.WorkCrew.prototype.fillPool=function(){for(var t=0;t<this.count;t++)this.addWorker()},iws.util.sync=function(t){this.option=t,this.uuid=0,this.sendQueue=[],this.working=null,this.finishedCallback=[],this.processQueue=function(){var t=this;if(0===this.sendQueue.length&&null===this.working)this.onfinish();else if(this.sendQueue.length>0&&null===this.working){var e=this.working=this.sendQueue.shift();e.callback&&e.callback(function(){setTimeout(function(){t.working=null,t.processQueue()},10)})}}},iws.util.sync.prototype.getCurrentWork=function(){return this.working},iws.util.sync.prototype.clear=function(t){for(var e=this.sendQueue.length-1;e>=0;e--)this.sendQueue.splice(e,1);null!==this.working?(this.addFinishCallback(t),this.working.quit&&this.working.quit(),this.working.quit=null):t&&t()},iws.util.sync.prototype.addWork=function(t){return this._capability=iws.createPromiseCapability(),t.__id=this.uuid++,this.sendQueue.push(t),this.processQueue(),t.__id},iws.util.sync.prototype.addFinishCallback=function(t){this.finishedCallback.push(t)},iws.util.sync.prototype.onfinish=function(){this.uuid=0,this.option&&this.option.callback&&this.option.callback();for(var t=[],e=this.finishedCallback.length-1;e>=0;e--)t.push(this.finishedCallback.shift());t.forEach(function(t){t&&t()}),this._capability.resolve()},iws.directResample=function(t){var e=[{win:.5,filter:function(t){return t>=-.5&&t<.5?1:0}},{win:1,filter:function(t){if(t<=-1||t>=1)return 0;if(t>-1.1920929e-7&&t<1.1920929e-7)return 1;var e=t*Math.PI;return Math.sin(e)/e*(.54+.46*Math.cos(e/1))}},{win:2,filter:function(t){if(t<=-2||t>=2)return 0;if(t>-1.1920929e-7&&t<1.1920929e-7)return 1;var e=t*Math.PI;return Math.sin(e)/e*Math.sin(e/2)/(e/2)}},{win:3,filter:function(t){if(t<=-3||t>=3)return 0;if(t>-1.1920929e-7&&t<1.1920929e-7)return 1;var e=t*Math.PI;return Math.sin(e)/e*Math.sin(e/3)/(e/3)}}],i=14;function n(t){return Math.round(t*((1<<i)-1))}var o,s,r,a,l,h,c=function(t,i,o,s,r){var a,l,h,c,u,p,d,f,g,m,v,b,w,y,x,k,_,C=e[t].filter,S=1/s,A=Math.min(1,s),T=e[t].win/A,M=Math.floor(2*(T+1)),E=new Int16Array((M+2)*o),O=0,P=!E.subarray||!E.set;for(a=0;a<o;a++){for(l=(a+.5)*S+r,h=Math.max(0,Math.floor(l-T)),u=(c=Math.min(i-1,Math.ceil(l+T)))-h+1,p=new Float32Array(u),d=new Int16Array(u),f=0,g=h,m=0;g<=c;g++,m++)f+=v=C((g+.5-l)*A),p[m]=v;for(b=0,m=0;m<p.length;m++)b+=w=p[m]/f,d[m]=n(w);for(d[o>>1]+=n(1-b),y=0;y<d.length&&0===d[y];)y++;if(y<d.length){for(x=d.length-1;x>0&&0===d[x];)x--;if(k=h+y,_=x-y+1,E[O++]=k,E[O++]=_,P)for(m=y;m<=x;m++)E[O++]=d[m];else E.set(d.subarray(y,x+1),O),O+=_}else E[O++]=0,E[O++]=0}return E};function u(t){return t<0?0:t>255?255:t}function p(t){var e=t.src,i=t.width,n=t.height,o=t.toWidth,s=t.toHeight,r=t.scaleX||t.toWidth/t.width,a=t.scaleY||t.toHeight/t.height,l=t.offsetX||0,h=t.offsetY||0,p=t.dest||new Uint8Array(o*s*4),d=void 0===t.quality?3:t.quality,f=t.alpha||!1,g=c(d,i,o,r,l),m=c(d,n,s,a,h),v=new Uint8Array(o*n*4);return function(t,e,i,n,o,s){var r,a,l,h,c,p,d,f,g,m,v,b=0,w=0;for(g=0;g<n;g++){for(c=0,m=0;m<o;m++){for(p=s[c++],d=s[c++],f=b+4*p|0,r=a=l=h=0;d>0;d--)h=h+(v=s[c++])*t[f+3]|0,l=l+v*t[f+2]|0,a=a+v*t[f+1]|0,r=r+v*t[f]|0,f=f+4|0;e[w+3]=u(h+8192>>14),e[w+2]=u(l+8192>>14),e[w+1]=u(a+8192>>14),e[w]=u(r+8192>>14),w=w+4*n|0}w=4*(g+1)|0,b=(g+1)*i*4|0}}(e,v,i,n,o,g),function(t,e,i,n,o,s){var r,a,l,h,c,p,d,f,g,m,v,b=0,w=0;for(g=0;g<n;g++){for(c=0,m=0;m<o;m++){for(p=s[c++],d=s[c++],f=b+4*p|0,r=a=l=h=0;d>0;d--)h=h+(v=s[c++])*t[f+3]|0,l=l+v*t[f+2]|0,a=a+v*t[f+1]|0,r=r+v*t[f]|0,f=f+4|0;e[w+3]=u(h+8192>>14),e[w+2]=u(l+8192>>14),e[w+1]=u(a+8192>>14),e[w]=u(r+8192>>14),w=w+4*n|0}w=4*(g+1)|0,b=(g+1)*i*4|0}}(v,p,n,o,s,m),f||function(t,e,i){for(var n=3,o=e*i*4|0;n<o;)t[n]=255,n=n+4|0}(p,o,s),p}function d(t,e,i,n,o,s){var r,a,l,h,c,u,p,d,f,g,m,v,b,w;for(f=0;f<s;f++){for(p=f,d=0,h=c=(r=t[u=f*o])*n[6],m=n[0],v=n[1],b=n[4],w=n[5],g=0;g<o;g++)l=(a=t[u])*m+r*v+h*b+c*w,c=h,h=l,r=a,i[d]=h,d++,u++;for(d--,p+=s*(o-1),h=c=(r=t[--u])*n[7],a=r,m=n[2],v=n[3],g=o-1;g>=0;g--)l=a*m+r*v+h*b+c*w,c=h,h=l,r=a,a=t[u],e[p]=i[d]+h,u--,d--,p-=s}}var f,g,m=function(t,e,i,n){if(n){var c=new Uint16Array(t.length),u=new Float32Array(Math.max(e,i)),p=function(t){t<.5&&(t=.5);var e=Math.exp(.527076)/t,i=Math.exp(-e),n=Math.exp(-2*e),c=(1-i)*(1-i)/(1+2*e*i-n);return o=c,s=c*(e-1)*i,r=c*(e+1)*i,a=-c*n,l=2*i,h=-n,new Float32Array([o,s,r,a,l,h,(o+s)/(1-l-h),(r+a)/(1-l-h)])}(n);d(t,c,u,p,e,i),d(c,t,u,p,i,e)}};function v(t,e,i,n,o,s){var r,a,l,h,c,u,p,d,f,g,v,b,w;if(!(0===n||o<.5)){o>2&&(o=2);var y=function(t,e,i){for(var n,o,s,r,a,l=e*i,h=new Uint16Array(l),c=0;c<l;c++)n=t[4*c],o=t[4*c+1],s=t[4*c+2],a=n>=o&&n>=s?n:o>=s&&o>=n?o:s,r=n<=o&&n<=s?n:o<=s&&o<=n?o:s,h[c]=257*(a+r)>>1;return h}(t,e,i),x=new Uint16Array(y);m(x,e,i,o);for(var k=n/100*4096+.5|0,_=257*s|0,C=e*i,S=0;S<C;S++)b=2*(y[S]-x[S]),Math.abs(b)>=_&&(r=t[w=4*S],a=t[w+1],l=t[w+2],u=257*((d=r>=a&&r>=l?r:a>=r&&a>=l?a:l)+(p=r<=a&&r<=l?r:a<=r&&a<=l?a:l))>>1,p===d?h=c=0:(c=u<=32767?4095*(d-p)/(d+p)|0:4095*(d-p)/(510-d-p)|0,h=r===d?65535*(a-l)/(6*(d-p))|0:a===d?21845+(65535*(l-r)/(6*(d-p))|0):43690+(65535*(r-a)/(6*(d-p))|0)),(u+=k*b+2048>>12)>65535?u=65535:u<0&&(u=0),0===c?r=a=l=u>>8:(f=2*u-(g=u<=32767?u*(4096+c)+2048>>12:u+((65535-u)*c+2048>>12))>>8,g>>=8,r=(v=h+21845&65535)>=43690?f:v>=32767?f+(6*(g-f)*(43690-v)+32768>>16):v>=10922?g:f+(6*(g-f)*v+32768>>16),a=(v=65535&h)>=43690?f:v>=32767?f+(6*(g-f)*(43690-v)+32768>>16):v>=10922?g:f+(6*(g-f)*v+32768>>16),l=(v=h-21845&65535)>=43690?f:v>=32767?f+(6*(g-f)*(43690-v)+32768>>16):v>=10922?g:f+(6*(g-f)*v+32768>>16)),t[w]=r,t[w+1]=a,t[w+2]=l)}}return g=p(f=t),f.unsharpAmount&&v(g,f.toWidth,f.toHeight,f.unsharpAmount,f.unsharpRadius,f.unsharpThreshold),g},function(){iws.util.print={};var t=function(t,e,i,n,o,s){var r=iws.util.Rotate(s).size(n,o),a=t-2*i,l=e-2*i,h=1,c="";l/r.height*r.width<=a?(h=l/r.height,c="H"):(h=a/r.width,c="W");var u=a/2-n/2*h+i,p=l/2-o/2*h+i,d=u+n*h,f=p+o*h,g=Math.round(u+(d-u)/2),m=Math.round(p+(f-p)/2);return{scale:h,start:{x:u,y:p},end:{x:d,y:f},center:{x:g,y:m},offset:{x:g-Math.round(r.width*h/2),y:m-Math.round(r.height*h/2)},fit:c}},e=function(t){var e=[],i=iws.util.clone(t);return Object.keys(i).map(function(t,n){var o=i[t],s=iws.util.getKlass(o.type,null,"object");e[n]=s.fromObject(o)}),e},i=function(t,i,o,s){var r=iws.util.Rotate(o).size(i.pageinfo.width,i.pageinfo.height),a=document.createElement("canvas");a.width=r.width,a.height=r.height;var l={x:i.pageinfo.width/2,y:i.pageinfo.height/2};a.getContext("2d").save(),a.getContext("2d").translate(l.x,l.y),a.getContext("2d").rotate(o*Math.PI/180),a.getContext("2d").translate(-l.x,-l.y);var h={left:0,top:0,right:i.pageinfo.width,bottom:i.pageinfo.height},c=iws.util.Rotate(o).point(l.x,l.y,h.left,h.top),u=iws.util.Rotate(o).point(l.x,l.y,h.right,h.top),p=iws.util.Rotate(o).point(l.x,l.y,h.right,h.bottom),d=iws.util.Rotate(o).point(l.x,l.y,h.left,h.bottom),f=iws.util.Points([c,u,p,d]).getRect(),g=iws.util.Rotate(-o).point(0,0,f.left,f.top);a.getContext("2d").drawImage(t,-g.x,-g.y,i.pageinfo.width,i.pageinfo.height),a.getContext("2d").restore(),n(a.getContext("2d"),a.width,a.height,i.filter),a.getContext("2d").save();var m=!0,v=!0;(s&&s.authority&&("unvisible"===s.authority.annotation&&(m=!1),"unvisible"===s.authority.masking&&(v=!1)),m)&&e(i.annotation).forEach(function(t){t.setControlVisible("mrdel",!1);var e=i.pageinfo.xres<96?96:i.pageinfo.xres;t.render(a.getContext("2d"),null,1*e/96)}.bind(this));v&&e(i.masking).forEach(function(t){t.setControlVisible("mrdel",!1);var e=i.pageinfo.xres<96?96:i.pageinfo.xres;t.render(a.getContext("2d"),null,1*e/96)}.bind(this));return a.getContext("2d").restore(),new Promise(function(t,e){t(a)})},n=function(t,e,i,n){if(n.hasOwnProperty("brightness")&&n.hasOwnProperty("contrast")&&n.hasOwnProperty("gamma"))if(n.brightness!=iws.util.filter.defaultValue.brightness||n.contrast!=iws.util.filter.defaultValue.contrast){var o=t.getImageData(0,0,e,i),s=iws.util.filter.brightness_contrast(o,n.brightness,n.contrast);t.putImageData(s,0,0)}else if(n.gamma!=iws.util.filter.defaultValue.gamma){o=t.getImageData(0,0,e,i),s=iws.util.filter.gamma(o,n.gamma/100);t.putImageData(s,0,0)}};function o(e,n,o){var s=o.angle||0;return new Promise(function(r,a){i(e,o,s,n).then(function(e){var i=document.createElement("canvas"),s=i.getContext("2d");s.imageSmoothingEnabled=!0,i.width=1680,i.height=2376;var a=0;if(n&&n.printAutoFit){var l=i.width/i.height,h=e.width,c=e.height,u=iws.util.Rotate(90).size(e.width,e.height);a=Math.abs(l-h/c)>Math.abs(l-u.width/u.height)?90:0}var p=0;o.printString.message.length>0&&(s.save(),s.textBaseline="Bottom",s.font=o.printString.font,s.fillStyle=o.printString.fillStyle,p=parseInt(s.font),s.restore());var d=t(i.width,i.height,p+8,e.width,e.height,a);if(s.clearRect(0,0,i.width,i.height),s.save(),s.fillStyle="#fff",s.fillRect(0,0,i.width,i.height),s.translate(d.center.x,d.center.y),s.rotate(a*Math.PI/180),s.translate(-d.center.x,-d.center.y),s.translate(d.start.x,d.start.y),s.scale(d.scale,d.scale),s.drawImage(e,0,0),s.restore(),s.save(),o.printString.message.length>0){s.scale(1,1),s.textBaseline="Bottom",s.font=o.printString.font,s.fillStyle=o.printString.fillStyle;var f={width:s.measureText(o.printString.message).width,height:parseInt(s.font)};switch(o.printString.position){case"left":var g=90;s.rotate(g*Math.PI/180),s.fillText(o.printString.message,i.height/2-f.width/2,-8);break;case"top":var m=i.width/2-f.width/2,v=f.height;s.fillText(o.printString.message,m,v);break;case"right":g=90;s.rotate(g*Math.PI/180),s.fillText(o.printString.message,i.height/2-f.width/2,-i.width+f.height);break;default:m=i.width/2-f.width/2,v=i.height;s.fillText(o.printString.message,m,v-8)}}s.restore(),r(i.toDataURL("image/jpeg",n.quality))})})}iws.util.print.image=function(t,e,i){function n(t,e,i){return new Promise(function(n,s){var r=new iws.util.sync({callback:function(){return n(e)}});e.forEach(function(n,s){var a={work:n,callback:function(r){var a="";a+='<div class="page" id="'+n.id.index.toString()+'">',a+='<div class="subpage">',a+='<img class="printimg"/>',i.printMark&&i.printMark.src&&(a+='<img class="printmark" src='+i.printMark.src+"/>"),a+="</div>",a+="</div>";var l,h,c,u,p,d,f=$(a);t.append(f),console.log("페이지 붙이기 : "+s),l=n,h=i,p=n,d=f,c=function(t){$("body").find(".waitMe_progress_elem1").text((s+1).toString()+"/"+e.length.toString()),d.find(".printimg").each(function(){this.onload=function(t){console.log("이미지 로드 : "+p.id.index),r&&r()},this.onerror=function(t){throw"Print image load fail! ("+p.id.index+")"},this.src=t})},(u=new Image).onload=function(t){delete l.pageSrc,o(this,h,l.id.page).then(function(t){c&&c(t)})},u.src=l.pageSrc}};r.addWork(a)})})}var s=null;new Promise(function(t,e){iws.util.run_waitMe($("body"),"progressBar",{}),$("body").find(".waitMe_progress_elem1").css("color","white"),setTimeout(function(){t()},100)}).then(function(){return t=i,new Promise(function(e,i){var n=t.printMark&&t.printMark.css||"",o="print-"+(new Date).getTime(),s=$("<iframe/>",{id:o,class:"printBody",name:"printIframe",style:"visibility:hidden"});s.on("load",function(){console.log("load the iframe")}),s.appendTo("body");var r=s.contents().contents(),a=r.find("head"),l=r.find("body"),h="";h=t&&t.printPageMargine?".page {\twidth: 21cm;\tmin-height: 29.7cm; padding: 0.9cm; /*background-color:red*/}.subpage {\tmargin: 0cm; /*border:1px solid #888888;*/\t/*background-color: #DFDFDF;*/}.printimg{\twidth: 19.0cm;\theight: 27.7cm; /*border:1px solid #888888;*/}":".page {\twidth: 21cm;\tmin-height: 29.7cm; padding: 0.0cm; /*background-color:red*/}.subpage {\tmargin: 0cm; /*border:1px solid #888888;*/\t/*background-color: #DFDFDF;*/}.printimg{\twidth: 20.8cm;\theight: 29.5cm; /*border:1px solid #888888;*/}",a.append("<title>"+o+"</title>"),a.append('<meta charset="UTF-8">'),a.append('<style> body { margin: 0;\tpadding: 0;\t/*background-color: #FAFAFA;*/\tfont: 12pt "Tahoma"; }* {\tbox-sizing: border-box;\t-moz-box-sizing: border-box;}'+h+".printmark{"+n+"}@page {\tsize: A4;\tmargin: 0;}@media print {\t\t.page {\tmargin: 0; border: initial;\tborder-radius: initial;\twidth: initial;\tmin-height: initial; box-shadow: initial; background: initial; page-break-after: always; }}</style> "),e({iframe:s,head:a,body:l})});var t}).then(function(t){return s=t,n(t.body,e,i)}).then(function(t){return new Promise(function(t,e){setTimeout(function(){console.log("출력 명령"),!1===s.iframe[0].contentWindow.document.execCommand("print",!1,null)&&(console.log("출력 명령 print()"),s.iframe[0].contentWindow.print()),t()},1e3)})}).then(function(){iws.util.hide_waitMe($("body")),console.log("출력 자원 제거");var t=s.iframe;t[0].contentWindow.location.reload(!0),t.remove()}).catch(function(t){console.log("error! - "+t),iws.util.hide_waitMe($("body"))})}}(),function(){iws.Pattern=iws.util.createInheritClass(function(){this.initialize.apply(this,arguments)},{repeat:"repeat",offsetX:0,offsetY:0,initialize:function(t){if(t||(t={}),t.source)if("string"==typeof t.source)if(void 0!==iws.util.getFunctionBody(t.source))this.source=new Function(iws.util.getFunctionBody(t.source));else{var e=this;this.source=document.createElement("img"),iws.util.loadImage(t.source,function(t){e.source=t})}else this.source=t.source;t.repeat&&(this.repeat=t.repeat),t.offsetX&&(this.offsetX=t.offsetX),t.offsetY&&(this.offsetY=t.offsetY)},toLive:function(t){var e="function"==typeof this.source?this.source():this.source;if(!e)return"";if(void 0!==e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}})}(),function(){var t=function(t){var e=new Uint8Array(t);if(!(e&&e.length>1))return null;var i=function(t,i){i||(i={offset:0});for(var n=0;n<t.length;n++)if(t[n]!==e[n+i.offset])return!1;return!0};return i([255,216,255])?{ext:"jpg",mime:"image/jpeg"}:i([137,80,78,71,13,10,26,10])?{ext:"png",mime:"image/png"}:i([71,73,70])?{ext:"gif",mime:"image/gif"}:i([87,69,66,80],{offset:8})?{ext:"webp",mime:"image/webp"}:(i([73,73,42,0])||i([77,77,0,42]))&&i([67,82],{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:i([73,73,42,0])||i([77,77,0,42])?{ext:"tif",mime:"image/tiff"}:i([66,77])?{ext:"bmp",mime:"image/bmp"}:i([73,73,188])?{ext:"jxr",mime:"image/vnd.ms-photo"}:i([56,66,80,83])?{ext:"psd",mime:"image/vnd.adobe.photoshop"}:i([37,80,68,70])?{ext:"pdf",mime:"application/pdf"}:!i([80,75])||3!==e[2]&&5!==e[2]&&7!==e[2]||4!==e[3]&&6!==e[3]&&8!==e[3]?i([117,115,116,97,114],{offset:257})?{ext:"tar",mime:"application/x-tar"}:!i([82,97,114,33,26,7])||0!==e[6]&&1!==e[6]?i([31,139,8])?{ext:"gz",mime:"application/gzip"}:i([66,90,104])?{ext:"bz2",mime:"application/x-bzip2"}:i([55,122,188,175,39,28])?{ext:"7z",mime:"application/x-7z-compressed"}:i([0,0,0])&&(24===e[3]||32===e[3])&&i([102,116,121,112],{offset:4})||i([51,103,112,53])||i([0,0,0,28,102,116,121,112,109,112,52,50])&&i([109,112,52,49,109,112,52,50,105,115,111,109],{offset:16})||i([0,0,0,28,102,116,121,112,105,115,111,109])||i([0,0,0,28,102,116,121,112,109,112,52,50,0,0,0,0])?{ext:"mp4",mime:"video/mp4"}:i([77,90])?{ext:"exe",mime:"application/x-msdownload"}:null:{ext:"rar",mime:"application/x-rar-compressed"}:{ext:"zip",mime:"application/zip"}},e=["jpg","png","gif","bmp"];iws.util.WebImageType=function(i){var n=t(i);return-1!=e.indexOf(n&&n.ext)?n:null}}(),function(){iws.util.byteArrayToBase64=function(t){for(var e,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",o=0;t.length>=o+3;)e=(255&t[o++])<<16|(255&t[o++])<<8|255&t[o++],n+=i.charAt((16515072&e)>>18)+i.charAt((258048&e)>>12)+i.charAt((4032&e)>>6)+i.charAt(63&e);if(t.length-o>0&&t.length-o<3){var s=Boolean(t.length-o-1);e=(255&t[o++])<<16|(s?(255&t[o])<<8:0),n+=i.charAt((16515072&e)>>18)+i.charAt((258048&e)>>12)+(s?i.charAt((4032&e)>>6):"=")+"="}return n},iws.util.arrayBufferToBase64=function(t,e){var i=new Blob([t],{type:"application/octet-binary"}),n=new FileReader;n.onload=function(t){var i=t.target.result;e(i.substr(i.indexOf(",")+1))},n.readAsDataURL(i)},iws.util.arrayBufferToImageBase64=function(t,e,i){var n=new Blob([e],{type:t}),o=new FileReader;o.onload=function(t){t.target.result,i(t.target.result)},o.readAsDataURL(n)},iws.util.base64ToArrayBuffer=function(t){for(var e=atob(t),i=e.length,n=new Uint8Array(i),o=0;o<i;o++)n[o]=e.charCodeAt(o);return n.buffer},function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=new Uint8Array(256),i=0;i<t.length;i++)e[t.charCodeAt(i)]=i;iws.util.base64={decode:function(t){var i,n,o,s,r,a=.75*t.length,l=t.length,h=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var c=new ArrayBuffer(a),u=new Uint8Array(c);for(i=0;i<l;i+=4)n=e[t.charCodeAt(i)],o=e[t.charCodeAt(i+1)],s=e[t.charCodeAt(i+2)],r=e[t.charCodeAt(i+3)],u[h++]=n<<2|o>>4,u[h++]=(15&o)<<4|s>>2,u[h++]=(3&s)<<6|63&r;return c},encode:function(e){var i,n=new Uint8Array(e),o=n.length,s="";for(i=0;i<o;i+=3)s+=t[n[i]>>2],s+=t[(3&n[i])<<4|n[i+1]>>4],s+=t[(15&n[i+1])<<2|n[i+2]>>6],s+=t[63&n[i+2]];return o%3==2?s=s.substring(0,s.length-1)+"=":o%3==1&&(s=s.substring(0,s.length-2)+"=="),s}}}()}(),iws.util.showError=function(t,e){var i=$(t).children("#iws-message0");if(i.length>0)(s=i.find(".iws-message-body")).append($('<div class="iws-centered">'+e+"</div>"));else{var n=$(t).width()/2-175,o=$("<div/>",{id:"iws-message0",class:"iws-message",style:"z-index: 1500;top: 0px;width: 350px;left: "+n+"px;height: 170px;transition: 0s;transform: translateY(0px);"}),s=$('<div class="iws-message-body"> <div class="iws-centered">'+e+"</div></div>");o.append(s);var r=$('<div class="iws-message-buttons"></div>'),a=$("<button/>",{class:"iws-btn",click:function(){$(o).remove()}});a.text("OK"),r.append(a),o.append(r),$(t).append(o)}},iws.util.filter={defaultValue:{brightness:0,contrast:0,gamma:100},brightness_contrast:function(t,e,i,n){for(var o=new Uint8Array(256),s=i/100+1,r=128*(1-s)+e,a=0;a<o.length;a++){var l=a*s+r;o[a]=l<0?0:l>255?255:l}for(var h=document.createElement("canvas").getContext("2d").createImageData(t.width,t.height),c=t.data,u=(a=0,c.length);a<u;a+=4)h.data[a]=o[c[a]],h.data[a+1]=o[c[a+1]],h.data[a+2]=o[c[a+2]],h.data[a+3]=c[a+3];return h},brightness:function(t,e){for(var i=new Uint8Array(256),n=0;n<i.length;n++){var o=n+e;i[n]=o<0?0:o>255?255:o}for(var s=document.createElement("canvas").getContext("2d").createImageData(t.width,t.height),r=t.data,a=(n=0,r.length);n<a;n+=4)s.data[n]=i[r[n]],s.data[n+1]=i[r[n+1]],s.data[n+2]=i[r[n+2]],s.data[n+3]=r[n+3];return s},contrast:function(t,e){for(var i=new Uint8Array(256),n=e/100+1,o=128*(1-n),s=0;s<i.length;s++){var r=s*n+o;i[s]=r<0?0:r>255?255:r}for(var a=document.createElement("canvas").getContext("2d").createImageData(t.width,t.height),l=t.data,h=(s=0,l.length);s<h;s+=4)a.data[s]=i[l[s]],a.data[s+1]=i[l[s+1]],a.data[s+2]=i[l[s+2]],a.data[s+3]=l[s+3];return a},gamma:function(t,e){for(var i=new Uint8Array(256),n=0;n<i.length;n++){var o=255*Math.pow(n/255,1/e);i[n]=o<0?0:o>255?255:o}for(var s=document.createElement("canvas").getContext("2d").createImageData(t.width,t.height),r=t.data,a=(n=0,r.length);n<a;n+=4)s.data[n]=i[r[n]],s.data[n+1]=i[r[n+1]],s.data[n+2]=i[r[n+2]],s.data[n+3]=r[n+3];return s}}}(),function(){var t;!function(){function t(t,e){this.create=t,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=e||2e3}t.prototype.init=function(){this.available=this.available.filter(function(t){return t.destroy(),!1}),this.acquired={}},t.prototype.acquire=function(){var t=this,e=void 0;return 0!==this.available.length?e=this.available.pop():((e=this.create()).id=this.lastId++,e.release=function(){return t.release(e)}),this.acquired[e.id]=e,e},t.prototype.release=function(t){var e=this;delete this.acquired[t.id],t.lastUsed=Date.now(),this.available.push(t),0===this.timeoutId&&(this.timeoutId=setTimeout(function(){return e.gc()},100))},t.prototype.gc=function(){var t=this,e=Date.now();this.available=this.available.filter(function(i){return!(e-i.lastUsed>t.idle)||(i.destroy(),!1)}),0!==this.available.length?this.timeoutId=setTimeout(function(){return t.gc()},100):this.timeoutId=0},iws.Pool=t}(),iws.limiter=function(t){var e=0,i=[];function n(){e<t&&i.length&&(e++,i.shift()())}return function(t){return new Promise(function(o,s){i.push(function(){t().then(function(t){o(t),e--,n()},function(t){s(t),e--,n()})}),n()})}},t=function(){onmessage=function(t){var e=t.data.opts,i=[{win:.5,filter:function(t){return t>=-.5&&t<.5?1:0}},{win:1,filter:function(t){if(t<=-1||t>=1)return 0;if(t>-1.1920929e-7&&t<1.1920929e-7)return 1;var e=t*Math.PI;return Math.sin(e)/e*(.54+.46*Math.cos(e/1))}},{win:2,filter:function(t){if(t<=-2||t>=2)return 0;if(t>-1.1920929e-7&&t<1.1920929e-7)return 1;var e=t*Math.PI;return Math.sin(e)/e*Math.sin(e/2)/(e/2)}},{win:3,filter:function(t){if(t<=-3||t>=3)return 0;if(t>-1.1920929e-7&&t<1.1920929e-7)return 1;var e=t*Math.PI;return Math.sin(e)/e*Math.sin(e/3)/(e/3)}}],n=14;function o(t){return Math.round(t*((1<<n)-1))}var s,r,a,l,h,c,u=function(t,e,n,s,r){var a,l,h,c,u,p,d,f,g,m,v,b,w,y,x,k,_,C=i[t].filter,S=1/s,A=Math.min(1,s),T=i[t].win/A,M=Math.floor(2*(T+1)),E=new Int16Array((M+2)*n),O=0,P=!E.subarray||!E.set;for(a=0;a<n;a++){for(l=(a+.5)*S+r,h=Math.max(0,Math.floor(l-T)),u=(c=Math.min(e-1,Math.ceil(l+T)))-h+1,p=new Float32Array(u),d=new Int16Array(u),f=0,g=h,m=0;g<=c;g++,m++)f+=v=C((g+.5-l)*A),p[m]=v;for(b=0,m=0;m<p.length;m++)b+=w=p[m]/f,d[m]=o(w);for(d[n>>1]+=o(1-b),y=0;y<d.length&&0===d[y];)y++;if(y<d.length){for(x=d.length-1;x>0&&0===d[x];)x--;if(k=h+y,_=x-y+1,E[O++]=k,E[O++]=_,P)for(m=y;m<=x;m++)E[O++]=d[m];else E.set(d.subarray(y,x+1),O),O+=_}else E[O++]=0,E[O++]=0}return E};function p(t){return t<0?0:t>255?255:t}function d(t){var e=t.src,i=t.width,n=t.height,o=t.toWidth,s=t.toHeight,r=t.scaleX||t.toWidth/t.width,a=t.scaleY||t.toHeight/t.height,l=t.offsetX||0,h=t.offsetY||0,c=t.dest||new Uint8Array(o*s*4),d=void 0===t.quality?3:t.quality,f=t.alpha||!1,g=u(d,i,o,r,l),m=u(d,n,s,a,h),v=new Uint8Array(o*n*4);return function(t,e,i,n,o,s){var r,a,l,h,c,u,d,f,g,m,v,b=0,w=0;for(g=0;g<n;g++){for(c=0,m=0;m<o;m++){for(u=s[c++],d=s[c++],f=b+4*u|0,r=a=l=h=0;d>0;d--)h=h+(v=s[c++])*t[f+3]|0,l=l+v*t[f+2]|0,a=a+v*t[f+1]|0,r=r+v*t[f]|0,f=f+4|0;e[w+3]=p(h+8192>>14),e[w+2]=p(l+8192>>14),e[w+1]=p(a+8192>>14),e[w]=p(r+8192>>14),w=w+4*n|0}w=4*(g+1)|0,b=(g+1)*i*4|0}}(e,v,i,n,o,g),function(t,e,i,n,o,s){var r,a,l,h,c,u,d,f,g,m,v,b=0,w=0;for(g=0;g<n;g++){for(c=0,m=0;m<o;m++){for(u=s[c++],d=s[c++],f=b+4*u|0,r=a=l=h=0;d>0;d--)h=h+(v=s[c++])*t[f+3]|0,l=l+v*t[f+2]|0,a=a+v*t[f+1]|0,r=r+v*t[f]|0,f=f+4|0;e[w+3]=p(h+8192>>14),e[w+2]=p(l+8192>>14),e[w+1]=p(a+8192>>14),e[w]=p(r+8192>>14),w=w+4*n|0}w=4*(g+1)|0,b=(g+1)*i*4|0}}(v,c,n,o,s,m),f||function(t,e,i){for(var n=3,o=e*i*4|0;n<o;)t[n]=255,n=n+4|0}(c,o,s),c}function f(t,e,i,n,o,s){var r,a,l,h,c,u,p,d,f,g,m,v,b,w;for(f=0;f<s;f++){for(p=f,d=0,h=c=(r=t[u=f*o])*n[6],m=n[0],v=n[1],b=n[4],w=n[5],g=0;g<o;g++)l=(a=t[u])*m+r*v+h*b+c*w,c=h,h=l,r=a,i[d]=h,d++,u++;for(d--,p+=s*(o-1),h=c=(r=t[--u])*n[7],a=r,m=n[2],v=n[3],g=o-1;g>=0;g--)l=a*m+r*v+h*b+c*w,c=h,h=l,r=a,a=t[u],e[p]=i[d]+h,u--,d--,p-=s}}var g=function(t,e,i,n){if(n){var o=new Uint16Array(t.length),u=new Float32Array(Math.max(e,i)),p=function(t){t<.5&&(t=.5);var e=Math.exp(.527076)/t,i=Math.exp(-e),n=Math.exp(-2*e),o=(1-i)*(1-i)/(1+2*e*i-n);return s=o,r=o*(e-1)*i,a=o*(e+1)*i,l=-o*n,h=2*i,c=-n,new Float32Array([s,r,a,l,h,c,(s+r)/(1-h-c),(a+l)/(1-h-c)])}(n);f(t,o,u,p,e,i),f(o,t,u,p,i,e)}};function m(t,e,i,n,o,s){var r,a,l,h,c,u,p,d,f,m,v,b,w;if(!(0===n||o<.5)){o>2&&(o=2);var y=function(t,e,i){for(var n,o,s,r,a,l=e*i,h=new Uint16Array(l),c=0;c<l;c++)n=t[4*c],o=t[4*c+1],s=t[4*c+2],a=n>=o&&n>=s?n:o>=s&&o>=n?o:s,r=n<=o&&n<=s?n:o<=s&&o<=n?o:s,h[c]=257*(a+r)>>1;return h}(t,e,i),x=new Uint16Array(y);g(x,e,i,o);for(var k=n/100*4096+.5|0,_=257*s|0,C=e*i,S=0;S<C;S++)b=2*(y[S]-x[S]),Math.abs(b)>=_&&(r=t[w=4*S],a=t[w+1],l=t[w+2],u=257*((d=r>=a&&r>=l?r:a>=r&&a>=l?a:l)+(p=r<=a&&r<=l?r:a<=r&&a<=l?a:l))>>1,p===d?h=c=0:(c=u<=32767?4095*(d-p)/(d+p)|0:4095*(d-p)/(510-d-p)|0,h=r===d?65535*(a-l)/(6*(d-p))|0:a===d?21845+(65535*(l-r)/(6*(d-p))|0):43690+(65535*(r-a)/(6*(d-p))|0)),(u+=k*b+2048>>12)>65535?u=65535:u<0&&(u=0),0===c?r=a=l=u>>8:(f=2*u-(m=u<=32767?u*(4096+c)+2048>>12:u+((65535-u)*c+2048>>12))>>8,m>>=8,r=(v=h+21845&65535)>=43690?f:v>=32767?f+(6*(m-f)*(43690-v)+32768>>16):v>=10922?m:f+(6*(m-f)*v+32768>>16),a=(v=65535&h)>=43690?f:v>=32767?f+(6*(m-f)*(43690-v)+32768>>16):v>=10922?m:f+(6*(m-f)*v+32768>>16),l=(v=h-21845&65535)>=43690?f:v>=32767?f+(6*(m-f)*(43690-v)+32768>>16):v>=10922?m:f+(6*(m-f)*v+32768>>16)),t[w]=r,t[w+1]=a,t[w+2]=l)}}var v,b,w=(b=d(v=e),v.unsharpAmount&&m(b,v.toWidth,v.toHeight,v.unsharpAmount,v.unsharpRadius,v.unsharpThreshold),b);postMessage({result:w},[w.buffer])}},iws.workerBlobURL=function(e){var i=(e=e||t).toString(),n=window.URL||window.webkitURL||window.mozURL||window.msURL,o=new Blob(["(",i,")()"],{type:"text/javascript"}),s=n.createObjectURL(o),r=new Worker(s);return r.objectURL=s,r},function(){"use strict";var t=1e-5;function e(e){var i=Math.round(e);return Math.abs(e-i)<t?i:Math.floor(e)}function i(e){var i=Math.round(e);return Math.abs(e-i)<t?i:Math.ceil(e)}iws.tileRegions=function(t){var n,o,s,r,a,l,h,c=t.toWidth/t.width,u=t.toHeight/t.height,p=e(t.srcTileSize*c)-2*t.destTileBorder,d=e(t.srcTileSize*u)-2*t.destTileBorder,f=[];for(r=0;r<t.toHeight;r+=d)for(s=0;s<t.toWidth;s+=p)(n=s-t.destTileBorder)<0&&(n=0),n+(a=s+p+t.destTileBorder-n)>=t.toWidth&&(a=t.toWidth-n),(o=r-t.destTileBorder)<0&&(o=0),o+(l=r+d+t.destTileBorder-o)>=t.toHeight&&(l=t.toHeight-o),h={toX:n,toY:o,toWidth:a,toHeight:l,toInnerX:s,toInnerY:r,toInnerWidth:p,toInnerHeight:d,offsetX:n/c-e(n/c),offsetY:o/u-e(o/u),scaleX:c,scaleY:u,x:e(n/c),y:e(o/u),width:i(a/c),height:i(l/u)},f.push(h);return f}}(),function(){var t={},e=!1;try{"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.indexOf("Safari")>=0)}catch(t){}var i=1;"undefined"!=typeof navigator&&(i=Math.min(navigator.hardwareConcurrency||1,4));var n={tile:1024,concurrency:i,idle:2e3},o={quality:0,alpha:!1,unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0};function s(){return{value:iws.workerBlobURL(),destroy:function(){if(this.value.terminate(),"undefined"!=typeof window){var t=window.URL||window.webkitURL||window.mozURL||window.msURL;t&&t.revokeObjectURL&&this.value.objectURL&&t.revokeObjectURL(this.value.objectURL)}}}}function r(t){this.options=$.extend(n,t||{}),this.__limit=iws.limiter(this.options.concurrency)}r.prototype.init=function(){var e="wp_"+JSON.stringify(this.options);return t[e]?this.__workersPool=t[e]:(this.__workersPool=new iws.Pool(s,this.options.idle),t[e]=this.__workersPool),Promise.resolve(!0).then(function(t){return"abc"})},r.prototype.cancel=function(){this.__resolve&&this.__resolve("Stop!!!")},r.prototype.resize=function(t,i,n){var s=this;this.canceled=!1,this.cancelToken=new Promise(function(t,e){s.__resolve=t}).then(function(t){throw s.canceled=!0,t}),this.debug("Start resize...");var r=$.extend(o,n);r.toWidth=i.width,r.toHeigth=i.height,r.width=t.naturalWidth||t.width,r.height=t.naturalHeight||t.height;var a=i.getContext("2d",{alpha:Boolean(r.alpha)});return this.init().then(function(n){var o=t.getContext("2d",{alpha:Boolean(r.alpha)}),l=function(t,i){return s.__limit(function(){var n={src:o.getImageData(t.x,t.y,t.width,t.height).data,width:t.width,height:t.height,toWidth:t.toWidth,toHeight:t.toHeight,scaleX:t.scaleX,scaleY:t.scaleY,offsetX:t.offsetX,offsetY:t.offsetY,quality:r.quality,alpha:r.alpha,unsharpAmount:r.unsharpAmount,unsharpRadius:r.unsharpRadius,unsharpThreshold:r.unsharpThreshold};return Promise.resolve().then(function(){return t=n,e=i,new Promise(function(i,n){if(s.canceled)return n("cenceled!_02, index = "+e);var o=s.__workersPool.acquire();o.value.onmessage=function(t){o.release(),s.debug("Tile make is success, index = "+e),t.data.err?n(t.data.err):i(t.data.result)},o.value.postMessage({opts:t},[t.src.buffer]),s.debug("postMessage, index = "+e)});var t,e}).then(function(i){var n=a.createImageData(t.toWidth,t.toHeight);return n.data.set(i),e?a.putImageData(n,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth+1e-5,t.toInnerHeight+1e-5):a.putImageData(n,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth,t.toInnerHeight),"success"},function(t){return s.debug("ERROR-2 : "+t),t})})};return Promise.resolve().then(function(){if(s.canceled)return Promise.reject("cenceled!_03");var t=iws.tileRegions({width:r.width,height:r.height,srcTileSize:s.options.tile,toWidth:r.toWidth,toHeight:r.toHeigth,destTileBorder:Math.ceil(Math.max(3,2.5*r.unsharpRadius|0))}).map(function(t,e){return l(t,e)});return Promise.all(t).then(function(){return s.debug("End Finished!"),i},function(t){throw s.debug("End ERROR : "+t),t})},function(t){s.debug("ERROR : "+t)})})},r.prototype.debug=function(){},iws.resizer=r}()}(),function(){"use strict";function t(i){return{point:function(t,e,n,o){var s=Math.PI/180*i,r=Math.cos(s),a=Math.sin(s);return{x:r*(n-t)-a*(o-e)+t,y:r*(o-e)+a*(n-t)+e}},rect:function(n,o,s){return e([t(i).point(n,o,s.left,s.top),t(i).point(n,o,s.right,s.top),t(i).point(n,o,s.right,s.bottom),t(i).point(n,o,s.left,s.bottom)]).getRect()},size:function(e,n){var o=t(i).point(0,0,e,n);return{width:Math.round(Math.abs(o.x)),height:Math.round(Math.abs(o.y))}}}}function e(t){return{getRect:function(){var e,i,n,o,s,r,a,l;e=n=t[0].x,i=o=t[0].y;for(var h=0;h<t.length;h++)e>t[h].x&&(e=t[h].x),i>t[h].y&&(i=t[h].y),n<t[h].x&&(n=t[h].x),o<t[h].y&&(o=t[h].y);return r=i,l=o,(s=e)>(a=n)&&(a=[s,s=a][0]),r>l&&(l=[r,r=l][0]),{left:s,top:r,right:a,bottom:l}}}}function i(t){return{round:function(){return{left:Math.round(t.left),top:Math.round(t.top),right:Math.round(t.right),bottom:Math.round(t.bottom)}},abs:function(){return{left:Math.abs(t.left),top:Math.abs(t.top),right:Math.abs(t.right),bottom:Math.abs(t.bottom)}},size:function(){return{width:t.right-t.left,height:t.bottom-t.top}},width:function(){return Math.abs(t.right-t.left)},height:function(){return Math.abs(t.bottom-t.top)},center:function(){return{x:t.left+(t.right-t.left)/2,y:t.top+(t.bottom-t.top)/2}},normal:function(){var e=t.left,i=t.top,n=t.right,o=t.bottom;return e>n&&(n=[e,e=n][0]),i>o&&(o=[i,i=o][0]),{left:e,top:i,right:n,bottom:o,width:n-e,height:o-i}}}}function n(){this.leftMouseButtonDown=!1,this.mouseDownPos={x:0,y:0},this.mouseMovePos={x:0,y:0},this.mousePrevMoveOffset={x:0,y:0},this._mouseType="move",this.magnificationScale=2,this.intersectRect={}}function o(){this.initialize.apply(this,arguments)}iws.util.Rotate=t,iws.util.Points=e,iws.util.Rect=i,n.prototype={get mouseType(){return this._mouseType},set mouseType(t){this._mouseType=t},isRange:function(){return this.leftMouseButtonDown&&"range"==this.mouseType},isMove:function(){return this.leftMouseButtonDown&&"move"==this.mouseType},isGlass:function(){return this.leftMouseButtonDown&&"glass"==this.mouseType},getRect:function(){return i({left:this.mouseDownPos.x,top:this.mouseDownPos.y,right:this.mouseMovePos.x,bottom:this.mouseMovePos.y}).normal()},getLT:function(){var t=this.getRect();return{x:t.left,y:t.top}},getRB:function(){var t=this.getRect();return{x:t.right,y:t.bottom}},getIntersectRect:function(t){return this.intersectRect=this.getRect(),this.intersectRect.left<t.left?this.intersectRect.left=t.left:this.intersectRect.left>t.right&&(this.intersectRect.left=t.right),this.intersectRect.top<t.top?this.intersectRect.top=t.top:this.intersectRect.top>t.bottom&&(this.intersectRect.top=t.bottom),this.intersectRect.right>t.right?this.intersectRect.right=t.right:this.intersectRect.right<t.left&&(this.intersectRect.right=this.intersectRect.left),this.intersectRect.bottom>t.bottom?this.intersectRect.bottom=t.bottom:this.intersectRect.bottom<t.top&&(this.intersectRect.bottom=t.top),this.intersectRect},drawMagnifyGlass:function(t){t.getContext("2d").save();var e={};e.x=this.mouseMovePos.x-60,e.y=this.mouseMovePos.y-60,e.width=120,e.height=120;var i={width:e.width*this.magnificationScale,height:e.height*this.magnificationScale},n=e.x+e.width/2-i.width/2,o=e.y+e.height/2-i.height/2;e.x=e.x<0?0:e.x,e.x=e.x>t.width-120?t.width-120:e.x,e.y=e.y<0?0:e.y,e.y=e.y>t.height-120?t.height-120:e.y,n=(n=n<0?0:n)>t.width-i.width?t.width-i.width:n,o=(o=o<0?0:o)>t.height-i.height?t.height-i.height:o,t.getContext("2d").drawImage(t,e.x,e.y,e.width,e.height,n,o,i.width,i.height),t.getContext("2d").lineWidth=2,t.getContext("2d").strokeStyle="#FF0000",t.getContext("2d").strokeRect(n,o,i.width,i.height),t.getContext("2d").restore()},drawRange:function(t,e){var i=t.getContext("2d");this.intersectRect=this.getIntersectRect(e),i.save(),this._drawRect(i,this.intersectRect,"red","#FF0000"),i.restore()},drawSelect:function(t,e,i,n){i=i||"blue",n=n||"#0000FF";var o=t.getContext("2d");o.save(),this._drawRect(o,e,i,n),o.restore()},_drawRect:function(t,e,i,n){t.beginPath(),t.setLineDash([2]),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.lineWidth=1,t.strokeStyle=i,t.stroke(),t.fillStyle=n,t.globalAlpha=.2,t.fill()}},iws.TrackMouse=n,o.prototype={get width(){return this.imgCanvas.width},set width(t){this.imgCanvas.width=t},get height(){return this.imgCanvas.height},set height(t){this.imgCanvas.height=t},get angle(){return this.m_angle},set angle(t){this.m_angle=(t||0)%360},get scale(){return this.m_scale},set scale(t){t<.1&&(t=.1),t>4&&(t=4),this.m_scale=t},get fitMode(){return"scale"===this.m_fitMode.name&&(this.m_fitMode.scale=this.scale),this.m_fitMode},set fitMode(t){var e=this.scale,i=this.getDrawCenter();this.m_fitMode=t;var n=null;if(this.isValid()){switch(this.m_fitMode.name){case"auto":this.fitAuto();break;case"width":this.fitWidth();break;case"height":this.fitHeight();break;case"scale":this.fitScale();break;case"original":this.fitOriginal()}var o=this.getDrawCenter();n={oldScale:e,changeRate:this.scale/e,oldCenter:i,center:o,offset:{x:o.x-i.x,y:o.y-i.y}}}this.page.fire("page:fitMode",{input:{mode:t},output:n})},initialize:function(t){if(this.page=t,iws.mask){this.maskImage=new Image,this.maskImage.onload=function(t){iws.log("mask ready!")};iws&&iws.manufacturer?"narudata"==iws.manufacturer?this.maskImage.src="data:image/png;base64,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":iws.manufacturer:this.maskImage.src="data:image/png;base64,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"}var e=!0;iws.test&&void 0!==iws.test.canvasSmooth&&(e=iws.test.canvasSmooth),this.imgCanvas=document.createElement("canvas"),this.imgCanvas.getContext("2d").imageSmoothingEnabled=e,this.imgCanvas.width=0,this.imgCanvas.height=0,this.reSampleCanvas=document.createElement("canvas"),this.reSampleCanvas.getContext("2d").imageSmoothingEnabled=e,this.reSampleCanvas.width=0,this.reSampleCanvas.height=0,this.originalImageData=null,this.m_scale=1,this.m_scaleStep=.1,this.m_angle=0,this.m_fitMode={name:"auto"},this.startPt={x:0,y:0},this.getEndPt=function(){return{x:this.startPt.x+this.imgCanvas.width*this.scale,y:this.startPt.y+this.imgCanvas.height*this.scale}},this.getRect=function(){var t=this.startPt,e=this.getEndPt();return{left:t.x,top:t.y,right:e.x,bottom:e.y}},this.fitAuto=function(){var t=this.page.lowerCanvasEl,e=this.getRotateSize();t.clientHeight/e.height*e.width<=t.clientWidth?this.fitHeight():this.fitWidth()},this.fitHeight=function(){var t=this.page.lowerCanvasEl,e=this.getRotateSize();this.scale=t.clientHeight/e.height,this._fixPosition(t)},this.fitWidth=function(){var t=this.page.lowerCanvasEl,e=this.getRotateSize();this.scale=t.clientWidth/e.width,this._fixPosition(t)},this.fitScale=function(){this.m_fitMode.scale&&(this.scale=this.m_fitMode.scale);var t=this.page.lowerCanvasEl;this._fixPosition(t)},this.fitOriginal=function(){this.scale=96/this.xres,this.scaleX=96/this.xres,this.scaleY=96/this.yres;this.width,this.xres,this.height,this.yres;this.fitScale()},this._fixPosition=function(t){var e=this.startPt,n=this.getDrawRect();return i(n).height()>t.height?n.top>0?this.startPt.y=this.startPt.y-n.top:n.bottom<t.height&&(this.startPt.y+=t.height-n.bottom):this.startPt.y=t.height/2-this.height/2*this.scale,i(n).width()>t.width?n.left>0?this.startPt.x=this.startPt.x-n.left:n.right<t.width&&(this.startPt.x+=t.width-n.right):this.startPt.x=t.width/2-this.width/2*this.scale,{offsetX:this.startPt.x-e.x,offsetY:this.startPt.y-e.y}},this.ImageProps={xres:!0,yres:!0}},clear:function(){this.width=0,this.height=0,this.clearResample(),this.originalImageData=null},clearResample:function(){this.reSampleCanvas.width=0,this.reSampleCanvas.height=0},isValid:function(){return this.width>0&&this.height>0},isValidResample:function(){return this.reSampleCanvas.width>0&&this.reSampleCanvas.height>0},setSrc:function(t,e,i,n,o){var s=this,r=new Image;r.onload=function(){s.clear(),s.width=this.width,s.height=this.height,s.angle=n;var i=s.imgCanvas.getContext("2d");if(s.imgCanvas.width=t,s.imgCanvas.height=e,i.drawImage(this,0,0,s.imgCanvas.width,s.imgCanvas.height),s.maskImage){i.globalAlpha=.5,i.drawImage(s.maskImage,10,s.imgCanvas.height-s.maskImage.height-10),i.globalAlpha=1}s.page.fire("page:setRawData"),s.fitRefresh(),o&&o()},iws.util.blobUrlLoad(i,function(t){r.src=t})},setRawData:function(t,e,i,n,o){this.clear(),this.width=t,this.height=e,this.angle=n;var s=this.imgCanvas.getContext("2d").createImageData(this.imgCanvas.width,this.imgCanvas.height);s.data.set(i),this.imgCanvas.getContext("2d").putImageData(s,0,0),this.page.fire("page:setRawData"),this.fitRefresh(),o&&o()},setSizeResample:function(t,e){this.reSampleCanvas.width=t,this.reSampleCanvas.height=e},setRawDataReSample:function(t,e,i){this.reSampleCanvas.width=t,this.reSampleCanvas.height=e;var n=this.reSampleCanvas.getContext("2d").createImageData(t,e);n.data.set(i),this.reSampleCanvas.getContext("2d").putImageData(n,0,0)},setRawDataReSampleRange:function(t,e,i,n,o){var s=this.reSampleCanvas.getContext("2d").createImageData(t,e);s.data.set(i),this.reSampleCanvas.getContext("2d").putImageData(s,n,o)},getCanvas:function(){return this.imgCanvas},getCanvasResample:function(){return this.reSampleCanvas},getImageData:function(t,e,i,n){return this.isValid()?(t=t||0,e=e||0,i=i||this.width,n=n||this.height,this.imgCanvas.getContext("2d").getImageData(t,e,i,n)):null},getOriginalImageData:function(){return this.originalImageData||(this.originalImageData=this.getImageData()),this.originalImageData},putImageData:function(t){this.imgCanvas.getContext("2d").putImageData(t,0,0)},rotate:function(t){this.m_angle+=t,this.page.fire("page:rotate",{input:{angle:t}}),this.fitRefresh()},setAngle:function(t){var e=(t-this.m_angle+360)%360;this.m_angle=t,this.page.fire("page:rotate",{input:{angle:e}}),this.fitRefresh()},zoom:function(t,e){var n=this.page.lowerCanvasEl;e=e||{x:n.width/2,y:n.height/2};var o=this.getDrawCenter(),s=this.getDrawRect(),r=this.scale;if("in"===t?this.scale=this.scale*(1+this.m_scaleStep):"out"===t?this.scale=this.scale*(1-this.m_scaleStep):"object"==typeof t&&"custom"===t.name&&(this.scale=t.scale),r!==this.scale){var a=this.getDrawRect(),l=(e.x-s.left)/(s.right-s.left),h=(e.y-s.top)/(s.bottom-s.top),c=e.x-i(a).width()*l,u=e.y-i(a).height()*h;this.startPt.x+=c-a.left,this.startPt.y+=u-a.top,this._fixPosition(n),this.fitMode={name:"scale",scale:this.scale};var p=this.getDrawCenter(),d={oldScale:r,changeRate:this.scale/r,oldCenter:o,center:p,offset:{x:p.x-o.x,y:p.y-o.y}};this.page.fire("page:zoom",{input:{type:t,point:e},output:d})}},move:function(t){var e=this.startPt.x,i=this.startPt.y;this.startPt.x+=t.X,this.startPt.y+=t.Y;var n=this.page.lowerCanvasEl;this._fixPosition(n);var o={x:this.startPt.x-e,y:this.startPt.y-i};this.page.fire("page:move",{input:{delta:t},output:{offset:o}})},fixPosition:function(){var t={x:this.startPt.x,y:this.startPt.y},e=this.page.lowerCanvasEl;this._fixPosition(e);var i={x:this.startPt.x-t.x,y:this.startPt.y-t.y};this.page.fire("page:move",{input:{orgPt:t},output:{offset:i}})},fitRefresh:function(t){this.fitMode=this.fitMode},render:function(t){if(this.isValid()){t.save();var e=this.getDrawCenter();if(t.translate(e.x,e.y),t.rotate(this.angle*Math.PI/180),t.translate(-e.x,-e.y),t.translate(this.startPt.x,this.startPt.y),t.scale(this.scale,this.scale),t.drawImage(this.imgCanvas,0,0),t.restore(),this.isValidResample()){t.save();e=this.getDrawCenter();t.translate(e.x,e.y),t.rotate(this.angle*Math.PI/180),t.translate(-e.x,-e.y),t.translate(this.startPt.x,this.startPt.y);var i=this.getScaleSize().width/this.reSampleCanvas.width;t.scale(i,i),t.drawImage(this.reSampleCanvas,0,0),t.restore()}this.tempRect&&(n=t,o=this.tempRect,s="#FF0000",r="#FF0000",n.save(),n.beginPath(),n.setLineDash([2]),n.rect(o.left,o.top,o.right-o.left,o.bottom-o.top),n.lineWidth=1,n.strokeStyle=s,n.stroke(),n.fillStyle=r,n.globalAlpha=.05,n.fill(),n.restore()),this.page.fire("page:render",{})}var n,o,s,r},getDrawCenter:function(){return i(this.getRect()).center()},getRotateSize:function(){return t(this.angle).size(this.width,this.height)},getScaleSize:function(){return{width:Math.round(this.width*this.scale),height:Math.round(this.height*this.scale)}},getScaleSizeCustom:function(t,e){return{width:Math.round(t*this.scale),height:Math.round(e*this.scale)}},getDrawPoints:function(){var e=this.getDrawCenter(),i=this.getRect();return[t(this.angle).point(e.x,e.y,i.left,i.top),t(this.angle).point(e.x,e.y,i.right,i.top),t(this.angle).point(e.x,e.y,i.right,i.bottom),t(this.angle).point(e.x,e.y,i.left,i.bottom)]},getDrawRect:function(){return e(this.getDrawPoints()).getRect()},getDrawRangeRect:function(t){var i=[];return i.push(this.getDrawRangePoint({x:t.left,y:t.top})),i.push(this.getDrawRangePoint({x:t.right,y:t.bottom})),e(i).getRect()},isInDrawImage:function(t,e){var i=!1,n=this.getDrawPoints();return t.save(),t.beginPath(),t.moveTo(n[0].x,n[0].y),t.lineTo(n[1].x,n[1].y),t.lineTo(n[2].x,n[2].y),t.lineTo(n[3].x,n[3].y),t.closePath(),t.isPointInPath(e.x,e.y)&&(i=!0),t.restore(),i},getDrawRangePoint:function(e){var i=this.getDrawCenter(),n=function(t){return{x:this.startPt.x+t.x*this.scale,y:this.startPt.y+t.y*this.scale}}.call(this,e);return t(this.angle).point(i.x,i.y,n.x,n.y)},getImagePoint:function(t){var e={x:0,y:0};if(0===this.angle)e.x=t.x-this.startPt.x,e.y=t.y-this.startPt.y;else{var i=this.getDrawRect();e.x=t.x-i.left,e.y=t.y-i.top}var n={x:0,y:0};return n.x=e.x/this.scale,n.y=e.y/this.scale,{x:n.x,y:n.y}},getImageRect:function(t){var e=this.getImagePoint({x:t.left,y:t.top}),n=this.getImagePoint({x:t.right,y:t.bottom});return i({left:e.x,top:e.y,right:n.x,bottom:n.y}).normal()},getImageRangePoint:function(e){var i=this.getDrawCenter(),n=t(-this.angle).point(i.x,i.y,e.x,e.y);return function(t){return{x:(t.x-this.startPt.x)/this.scale,y:(t.y-this.startPt.y)/this.scale}}.call(this,n)},getImageRealRect:function(t){var e=this.getImageRangePoint({x:t.left,y:t.top}),n=this.getImageRangePoint({x:t.right,y:t.bottom});return i({left:e.x,top:e.y,right:n.x,bottom:n.y}).normal()},getBasicPoint:function(){var t=1/this.scale,e=i(this.getDrawRect()).size(),n=e.width*t/2,o=e.height*t/2,s=this.getDrawCenter();return{x:s.x-n,y:s.y-o,rate:t}}},iws.ImageControl=o}(),function(t){"use strict";var e;(e="undefined"!=typeof exports?exports:t.iwsT={}).getVersion=function(){return"1.0"},e.debug=!1,e._transform=function(t,e,i,n,o){var s,r=i/t,a=n/e;return 90!==o&&270!==o&&-90!==o&&-270!==o||(r=n/t,a=i/e),s=Math.min(r,a),{x:(i-t)/2,y:(n-e)/2,ratio:s}},e.defaults={debug:!1,direction:"V",useBookMark:!1,useBookMarkClick:!1,quality:20,useThumbNumber:!0,authority:{annotation:"editable",masking:"editable"},readOnlyOne:!1,useMulti:!1,firstAutoClick:!0,annotationSaveMode:"useSaveButton"},e._makeSrc=function(t,e,i,n){if(0===t.length)return"";var o=document.createElement("canvas"),s=o.getContext("2d").createImageData(e,i);return s.data.set(t),o.width=e,o.height=i,o.getContext("2d").putImageData(s,0,0),o.toDataURL("image/jpeg",n)},e._getDimension=function(t,e,i,n){var o=0,s=0,r=t/i,a=e/n,l=Math.max(r,a);return l>1?(o=t/l,s=e/l):(o=t,s=e),{w:o,h:s,x:(i-o)/2,y:(n-s)/2}},e._makeSrcFromImage=function(t,e,i,n){var o=document.createElement("canvas");o.width=e,o.height=i;var s=o.getContext("2d");return s.fillStyle="white",s.fillRect(0,0,o.width,o.height),s.drawImage(t,0,0,e,i),o.toDataURL("image/png",n)},e._makeThumbnail=function(t,e){var i=new Image;i.onload=e(index),i.src=data.src},e._MakeThumbFrame=function(t,e){var i=document.createElement("div"),n=iws.util.Unique.getFrameId();return $(i).attr("id",n).addClass("thumb_frame"),"V"===e?($(i).css("left","0"),$(i).css("right","0")):"H"===e&&($(i).css("top","0"),$(i).css("bottom","0"),$(i).css("white-space","nowrap")),t.append(i),{div:i,id:n,class:"thumb_frame"}},e.Thumbnail=function(i,n){var o=$.extend({},e.defaults,n),s=$(i);iws.util.ListenDropFile(s[0],function(t){D(t,function(){console.log("Load complete!")})});var r=function(){return{auto:function(t,e){t<e&&r().next(e),t>e&&r().prev(e)},prev:function(t){if("V"===o.direction){var e=c.item[t].layout_wrap$[0].offsetTop;s.scrollTop()-e>0&&s.scrollTop(e-4)}},next:function(t){if("V"===o.direction){var e=c.item[t].layout_wrap$,i=e[0].offsetTop,n=e.outerHeight(),r=s.innerHeight();if(s.scrollTop()+r-(i+n)<0){var a=i+n-r;s.scrollTop(a+4)}}}}};s.attr("tabindex","0").keydown(function(t){console.log("keydown : "+t.keyCode);var e=c.focusIndex,i=e;switch(t.keyCode){case 39:case 40:c.focusIndex+1<c.item.length&&(i=c.focusIndex+1);break;case 37:case 38:c.focusIndex>0&&(i=c.focusIndex-1)}return e!==i&&C(c.item[i].uniqueId).trigger("click"),!1});s.on("focus blur scroll",function(t){switch(t.type){case"focus":e.debug&&console.log("on focused...");break;case"blur":e.debug&&console.log("on blured...");break;case"scroll":e.debug&&console.log("on scroll...("+$(this).scrollTop()+", "+$(this).innerHeight()+")"),"V"===o.direction&&setTimeout(function(t){for(var e=t.scrollTop(),i=t.innerHeight(),n=-1,o=0;o<c.item.length;o++)if(e-((l=(r=$(k.div).children('[uniqueId="'+c.item[o].uniqueId+'"]'))[0].offsetTop)+r.outerHeight())<0){n=o;break}var s=[];if(-1!==n)for(o=n;o<c.item.length;o++){var r,a=c.item[o].uniqueId,l=(r=$(k.div).children('[uniqueId="'+a+'"]'))[0].offsetTop;r.outerHeight(),e+i-(l+4)>0&&""===c.item[o].imgsrc&&s.push({cmd:"loadAndMakeThumb",buffer:c.item[o].filebuffer,id:{index:o,uniqueId:c.item[o].uniqueId}})}g.clearData("loadAndMakeThumb"),s.forEach(function(t){t.__id=g.addWork(t)})}(s),100)}});var a=function(t,e){return function(e){p.fire("thumbMouseDblClick",t)}},l=function(t,e){return function(t){t.preventDefault(),t.stopPropagation();var i=c.focusIndex;if(-1===l||""===e)c.focusIndex=-1,R(i);else{var n=M(e);if(c.focusIndex=n,void 0==t.isTrigger?(c.item[n].clickType="mouse",p.fire("thumbMouseClick",n)):c.item[n].clickType="trigger",t.ctrlKey){var o=c.item[n];o.selected=!o.selected,o.layout_wrap$.find(".thumb_check").prop("checked",o.selected)}else if(t.shiftKey){var s=function(t,e){var i=c.item[t];i&&(i.selected=e,i.layout_wrap$.find(".thumb_check").prop("checked",i.selected))},a=c.item[n];if(a.selected=!a.selected,a.layout_wrap$.find(".thumb_check").prop("checked",a.selected),-1!==i)if(n>i)for(var l=i;l<n;l++)s(l,a.selected),R(l);else for(l=i;l>n;l--)s(l,a.selected),R(l)}I(n,i),R(i),R(n),r().auto(i,c.focusIndex)}}};s.click(l(-1,"")),s.on("mousemove",function(t){t.preventDefault()});var h=function(e,i,n){this.type="image",this.key=this.uniqueId=iws.util.Unique.getUniqueID(),this.imgWidth=e||0,this.imgHeight=i||0,this.imgsrc="",this.imgsrcOriginal="",this.filebuffer=n,this.pagebuffer=null,this.angle=0,this.angleDisplay=0,this.selected=!1,this.pageInfo=null,this.pageSrc="",this.caption="",this.nextLine="",this.annotModified=!1,this.errorMsg={success:!0,level:0,msg:"",title:""},this.setError=function(t,e,i){this.errorMsg.success=!1,this.errorMsg.msg=t,this.errorMsg.title=e||"Error!",this.errorMsg.level=i||0,this.layout_wrap$&&this.layout_wrap$.find(".thumb_bookmark").css("display","none")},this.mediaSource=null,this.clear=function(){(t.URL||t.webkitURL||t.mozURL||t.msURL).revokeObjectURL(this.pageSrc)};var o,s,r,a,l,h=this;this.bookmark=(o=!1,{getData:function(){return o},setData:function(t){o=t;var e=C(h.uniqueId);!0===o?e.children("div.thumb_border_wrap").children(".thumb_bookmark").addClass("thumb_bookmark_check").removeClass("thumb_bookmark_uncheck"):e.children("div.thumb_border_wrap").children(".thumb_bookmark").addClass("thumb_bookmark_uncheck").removeClass("thumb_bookmark_check")}}),this.annotation=(s=[],r=[],{getData:function(){return s},setData:function(t){var e=iws.util.equals(s,t);s=t,h._checkAnnotation(e)},getTemp:function(){return r},setTemp:function(t){var e=iws.util.equals(r,t);r=t,h._checkAnnotation(e)}}),this.masking=(a=[],l=[],{getData:function(){return a},setData:function(t){var e=iws.util.equals(a,t);a=t,h._checkAnnotation(e)},getTemp:function(){return l},setTemp:function(t){var e=iws.util.equals(l,t);l=t,h._checkAnnotation(e)}}),this._checkAnnotation=function(t){var e=C(h.uniqueId);this.annotation.getData().length>0||this.masking.getData().length>0?e.children("div.thumb_border_wrap").children(".thumb_annotation").css("display","block"):e.children("div.thumb_border_wrap").children(".thumb_annotation").css("display","none"),!t&&y(h),t||console.log("isEquals : "+t)},this.filter={},this.printString={message:"",position:"bottom",font:'14px "Jeju Gothic","Malgun Gothic","맑은 고딕",dotum,"돋움",sans-serif',fillStyle:"#fff"},this.started=!1},c=new function(t){this.width=200,this.height=160,this.direction=t||"V",this.focusIndex=-1,this.item=[],this.checkVisible=!1,this.freeFileBuffer=!0,this.icon={image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAoRJREFUaIHtmb+LE0EUx79vNH9BmqQ67g/QK61O7c+TaLGlEBFskgkxhWWyXHVFiDvZziJic7KgKLlGBEl5ndr5DwgLknASC9Fknk0iOU3uZjP54ZL9QCDsvnnvfZd5810SICFhs6EowcxMvu/vM/MOM1+yKTwYDJ5WKpUvNjmACAKYmZRSr4goZ1t0xAchxPVCofDdJomxgGazeZuZ3zBzpdfrKdd1B/MU9DyvRkRVrfUvInqbzWZzjuMM58kFAMI0kJl3AMCm+TOFhXhARLfCMGxY5TENHO/5RTQPAFLK58x8AKDoeV5x3jzGApaBlLKqtT5i5oZSam+eHJdtGvA8r2YSJ4ToFIvFzt/XiYhbrdb9fr+/pbV+0Wg0dsvl8scoPVgJIKKqSZzWGgA60+7l8/kfnuflhBAnAI7r9fq1KMerlQApZSQfmUWpVPqqlNrTWp+kUqm27/vGx+vKZ4CIGACq1eqZhyel/CyEuAvgynA4PAqCwMgo1zHEnwAgnU4/miLiPTM/jHK8Wm0hpRSbxDGzWyqVagCQyWTaYRi2ARym0+lDpdSsZUUA8qLcVgKY2TWJE0J0xt8dxxkGQXAnDMN9Zr6KKbuAiG4CuGGS20rA+KlGZfTq8Hr0+YfR64aRgLUa2SJYiZGZMMvsLmIlRmbCeWZ3Hv+FkdkQ+xmIvYCVGJkJk2YXhZUYmQmTZheFtRjZItnsGUiMbILEyOJK7AUkRmazfpLEyOJKYmQ26ydJjCyubI4AIvoGAL7vby2vnT9sAzg1CTSeAa31SyHEgdb6nVIqYOaF/NU0hW0iugfgiUlwpCFUSu0CUACm/qa5IE4BPOt2u49d1/25pBoJCWN+AzouHvLW3VsUAAAAAElFTkSuQmCC",video:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAACxklEQVR42u3aX0hTURwH8D30GgU9+BJI0D+C/jz10HsPCS116Nru7rzb3XXb9c/MhxVF2EuPEfTQQ4hUpsmdm1vpcMIghloERaWrpi2ozbncYLWWTm392q8SrLapadxz5R74wtg9B36f8TtnZzCFIj8qqrXlDMt7OL51ssFmj4gRtY6LqlS6Y4q1DiVF7aNN/IeR0Ue5eDwOYsXhcD7XMeaZytq62jUBaMY6+iAwDGIWj/H7/Y89nntgqG9KqDTshVUD1JQpE5ueJgLg8/nA6/VCU+u5ZI3WeKutrW3LioBaLTsndvFj40FotNlTCFjKxUuXU2qdKaBUKrcSD3jy9BnU82fSywGYK1evZfIdEjpRTe2UJABzo71jIY+YqqxhjkgSgOnq7gENbZ45paIriAS8GBsHo7n5czEAxtXnBtbSPGUy2cqIA2A0deas2+2BUohf8QuCsI04gMvdn+WsLbO9TteKiMHBweDAwEA5UQCMb8i/wFlaPmE7NdrOpkulodmepA3Wu0QBlhKNRuF1aKJkxoMvIV97mkjAapEyQAbIgP8AeBhOwPmRDBzvX4SDvbkfwdf4Hj4jFhCJxcE+/AX2CN9gtwAFg89wDs4lCoAFqYfmixb+Z3DuehEbCsBPdbXFLwXXEAHAvi7UNvsdAAd6oWQ7rWdPbBgAN2ehAl+lAJJZgKbR4ghcKzoAT5hCxS0f3vcARz1/z8G1ogPwmFwJgGN6FuCw6/c5uFYygMQcwCESAZJvoWKbOPRRIpu42DGKR+hehwSOUcl/kW2Kq4TkL3Ob4jot/yKTATJABsgAGSAD/glAsZlIJCI5QCg0AVSdJabQGa0BZ9/9nNQAN+/0LNIGa5fiZA29S0tzqc5u4Ws4/Jb4wicn30B7x+3503ouXlWl3/HzHytKTZneyHfSBj6q1denSQ7N8u9o1nqdYZjtWPt3zvlBAjtPgwAAAAAASUVORK5CYII=",audio:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAADdElEQVR42u2ZW0hTcRzH99Bz0EO9BEWQEUVRQi9B9VRhSqXM29mObs55meLQsrCIUQ8FQTfyJU1EScq7rulUbGpqZmleMLVNU+eubt7mfc79+v+PGd7yAoH/E+fAF/Y//B++n9/5Xf7jz+Ohx4emD4RKYwulsgRdjPzW4E4oiI4w8PnCc7ztPj4U5SEUR1s/1ta7LBYL7JRy8/JbBKIom1+QiNoWAC2W1VZV17p30jyWRqNpVCrfQ1hknI1PhSm2DBAokEyYTCYgAaC8vBxKS0tBnpBkDwiWZCkUil2bAgRQkpmdNt/xvRNi5ImjGGBJivsPRwMF4fVeXoLdxAO0tLZBeJTcsRwA6+nz5KkAQbgWNxlWAmClvE6fR2lu8vMTerISAOvtuxwIoqVD1/khPsTWgFgaN/k3AKyCwiIMaQyJit9PHABWsChyFpvcCAKrrKysSqVS7SEOoEhZMociPI0G2qYQarW6S6lUHiIKAKuiUuOURsePo2E2ESu/7dhIsrjEYaE4KpcogCUZDAbo/qHdUJ1d3eBPSaaIBNiKTGYzB8ABEAtgRnrW5IALynk4XbAAUs0MtA8MsQfgyVcHHM6BFbqomge9iSUA55WuNQBYqu4RMgG+9dsgtHIGanR2Zr2eeazU1vE1e4kAeNm8mDL3Pk1uCJDSMr5mLxEAL36bulu/OcDqvRzAvwBIbh5nTN2snWLWx/Pc6wJktI/B4y8TzG9FA0EAOR2jjKmraiezDqyYXWXeDR5ITX02kKCZgN9haGIAdAYrHM11wxFk8oPWDg29NjhT6FoBgCPfjDrQifzFr9P400bWHHjUuJgaePp+Rua0g1ZIbRljhlo1apl4EnuXOpk98R+nyBtkRrMFrqnnGIPHUA3cQPWQ1joGmSjv76CCPZm/8Aewz2glcxL3Gy1Md8H5vl4Rx9ZMM+lG/FGirtcODxommLrAxpPqJqFSO8yew5wJpVMPivRS2rT1D4HBzJLj9ABKo7PFaw9znuhY3aEfIh8AR9q3bA5OIcPLdbnEyXQm7h8ZB8ABcAAcAAfAAfxXAPiiW6/Xsw5Aq+uBYDrCyhOKojW5+cULbAPIzMp20SJZNu+KH3UwiI4YQS/me3p6WRH5tPQ3Thx9L3//vcw92SVfeh8dJstAX8NAhUQ4SJZQLNMjr6+8vSnmpvIXeEJwddSzQnIAAAAASUVORK5CYII=",error_network:"data:image/png;base64,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",error_loadfail:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAEhklEQVRoQ92aTYgcVRDH/1Xd69coKChZFXPQ2enu3VVDoone9KA5GyWGiDmJrDGJsvELERREhKCra4wRcpGgIkEUb64XPYm4WZIYdvr1bPYiqEGMCslEmJ1+JW93Zp2ZzFf3dE8y9nH6Vb36VdV7Xa/eEBJ4lOPcBOB+EbkHgKOZb2OtrwNwdUX9Oc38F4ucAlEA4Ach+nbU93/rdXqKq2Ahm70htKztAuwA0fqYeuZI5DCJfOoUCn/E0REZ4OT4+C12qfSCZn6CgSviTNooo4F/GDjEWu9zCoVfoujsGmAhm728bNt7NfAKA1dGmaTrsSLnQfS6tqypsfn5UjdyXQEEuZxbZj7CwO3dKO11jAA/schWNwjMemn7dARQjvOIiHwE5kwnZYm+17oI5h2eUl+009sWIO95T4vIfgY6giZqfEWZBsQS2ekGwYet9Lc0LO95O0nkQBqGRdVJIk+1gmgKYNImJDI5f1E832SXEiJ6eNT3v2x8d4GBZsFq4GgvOW+vW4fM1FTdXMXJSZSPH4/q/P/Ga30OzBs8pQq1SuoAzFZZsu3ZXnebVABWrD6hLWtj7RZbB+C77ssA3ojvphXJFAEgRC+O+v6+qo2rAOYLy+VykMRHKk0AiJwnYMQNgl8NxCqA77rvAdjdq/fTjkDFvnc8pSZXAUxhVrLtn5OqbVKNAABTO9larzUF4HIElOM8I0TvJuH9PkXATLPbU+r9ZQDfceZ6KIkv4E47ApUJZz2lNpI5jAhRpBK2U6T6BICybQ8bgMeE6ONORkV53y8AIdpGfi63H8y7ohjYaWwfAaYNwDdgfqCTUVHe9wsAwNc077qLDNwaxcBOY/sFIESLJgJ/gtl0EBJ7+gUArc8YgBKYhxKzPuVaqM5OrUv/C4DBTqHBX8SOMwOiBwdyDZhtNMkyuuoEHh7G0ObNdT5ZmpmBPn06ST+Zw820AdgO4JNENfdJGYk8SnnPu5FElk83g/YMLS2tWSmnXfcogA2DBCBEP476/qbqgWaPyacBA9g16vsHlgGCXO76MrM5UibSdU69lFjpYq/1lDpTe6g3EdiTRBRSBwCmPKX2GltXAYJc7mZNVADRVb1CpAqgdVEsa6R6PdXY2HoJwJuXNADwvKfUW1Ub6wDmx8YuozCcJeCOXiBS/JAdK2Yym+6am1tqCmB+VI7jiMhcL83dXuBbyWrgrDCvH8/nT9WOado+9113iwY+v4Ta69oS2eIGwVeNgC37/8pxJoToYBrejKHzSU+pQ83k2l5gGIiQ6IOLFQkNaAYmWhlft4228kre8x6iMDwM5uqtewwHRhcxOW+JPN4sbTqugcbpfNfNATgC4M7opsSSOBYyb21csJFTqFZgeYvV+lnS+tUkPnZNsVauVl8rZjLTtVtlOxdEvsSr9FKf08BEUrWTubTQRAeJ6O2ofwCJDFD1hikANfM2mD97AHfHSRRTEgMwf/b4zBRmcXTEBqid7OT4+BorDO8DcC+JOEI0QmF4LYBrKuPOimX9TSILQhSw1t/b5fJ32cXF3+MYXSvzL4K/IE4mLilyAAAAAElFTkSuQmCC",error_loadNotImage:"data:image/png;base64,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",error_unkown:"data:image/png;base64,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"}}(o.direction);function u(){}u.prototype=iws.Observable;var p=new u,d=new iws.util.sync({}),f=null,g=null,m="",v=null;if(o.path){o.useMulti&&(f=iws.util.work.Spliter(iws.util.string.combinePath(o.path,"/engine/iws.w.split.js"),!1));var b=iws.util.string.combinePath(o.path,"/engine/iws.w.loader.js"),w=iws.util.string.combinePath(o.path,"/engine/iws.w.loader.plugin.js");(v=function(i){null!==g&&g.close(),0===i?m=b:1===i&&(m=w),(g=new iws.util.work.WorkCrew(m,2,2,!1)).onstarted=function(t){if("loadAndMakeThumb"===t.cmd){var e=c.item[t.id.index];void 0!==e&&(e.started=!0,iws.util.run_waitMe(C(t.id.uniqueId),"facebook"))}else"loadpage"===t.cmd&&p.fire("loadpage_start",t.id.uniqueId)},g.onfinish=function(){0===function(){for(var t=[],e=0;e<c.item.length;e++)!1===c.item[e].started&&t.push({cmd:"loadAndMakeThumb",buffer:c.item[e].filebuffer,id:{index:e,uniqueId:c.item[e].uniqueId}});return t.forEach(function(t){t.__id=g.addWork(t)}),t.length}()&&p.fire("thumbLoad",-1,c.item.length,"loadcomplite")},g.oncanceled=function(t){if("loadpage"===t.cmd){E=!1;t.id;setTimeout(j(),0)}},g.oncomplete=function(i,n){var s,r,a=n.data,l=a.id,h=M(l.uniqueId),u=c.item[h];if("loadAndMakeThumb"===a.cmd){if(void 0===u)return;if(u.pageInfo=a.pageInfo,a.src||a.url){if(a.url)u.pageSrc=a.url;else{var d=(t.URL||t.webkitURL||t.mozURL||t.msURL).createObjectURL(new Blob([a.src],{type:"text/html"}));u.pageSrc=d}(f=new Image).onload=(r=h,function(t){var i=c.item[r];if(void 0!==i){if("image"===i.type&&1==i.errorMsg.success){var n=e._getDimension(this.width,this.height,200,200);i.imgWidth=n.w,i.imgHeight=n.h,i.imgsrcOriginal=i.imgsrc=e._makeSrcFromImage(this,n.w,n.h,20),x(r)}else i.imgWidth=this.width,i.imgHeight=this.height,i.imgsrc=f.src,x(r);y(i)}}),a.src?f.src=a.src:iws.util.blobUrlLoad(u.pageSrc,function(t){f.src=t})}else if(a.bytearray)u.imgWidth=a.xsize,c.item[h].imgHeight=a.ysize,u.imgsrcOriginal=u.imgsrc=e._makeSrc(a.bytearray,a.xsize,a.ysize,20),u.pagebuffer=a.pagearray,x(h),y(u);else{var f,g="";a.pageInfo&&!a.pageInfo.result?(u.setError("It is not an image file.","Notice.",1),g=c.icon.error_loadNotImage):(u.setError("unkown process!"),g=c.icon.error_unkown),(f=new Image).onload=(s=u.uniqueId,function(t){var e=M(s),i=c.item[e];void 0!==i&&(i.imgWidth=this.width,i.imgHeight=this.height,i.imgsrc=f.src,x(e))}),f.src=g}p.fire("thumbLoad",h,c.item.length,c.item[h]),0===h&&o.firstAutoClick&&C(c.item[h].uniqueId).trigger("click")}else"loadpage"===a.cmd&&(E=!1,u&&(u.pagebuffer=a.pagearray,u.pageInfo=a.pageInfo),P.length>0&&setTimeout(j(),0),p.fire("loadpage_end",l.uniqueId))}})(!0===o.plugin?1:0)}function y(t){var e;t&&(o.authority&&setTimeout((e=t.uniqueId,function(){var t=M(e),i=c.item[t];if(i&&i.imgsrcOriginal){var n=new Image;n.onload=function(){if(-1!=M(e)){var n=document.createElement("canvas"),s=n.getContext("2d");n.width=this.width,n.height=this.height,s.save(),s.drawImage(this,0,0);var r=-i.angle,a={x:this.width/2,y:this.height/2},l={left:0,top:0,right:this.width,bottom:this.height},h=iws.util.Rotate(r).rect(a.x,a.y,l),c=iws.util.Rotate(-r).point(0,0,h.left,h.top),u=this.width/i.pageInfo.width,p={x:i.pageInfo.width/2,y:i.pageInfo.height/2},d="useSaveButton"==o.annotationSaveMode,f=d?i.masking.getTemp():i.masking.getData();"unvisible"!=o.authority.masking&&f.forEach(function(t,e){m(t)});var g=d?i.annotation.getTemp():i.annotation.getData();"unvisible"!=o.authority.annotation&&g.forEach(function(t,e){m(t)}),s.restore(),i.imgsrc=n.toDataURL("image/jpeg",20),x(t)}function m(t){var e=iws.util.getKlass(t.type,null,"object").fromObject(t).clone();e._objectSizeChangeScale(u/1,{x:a.x-p.x,y:a.y-p.y},a),e._rotate(r,a),e._moveOffset({x:-c.x,y:-c.y}),e.render(s,null,u/1*(i.pageInfo.xres/96))}},n.src=i.imgsrcOriginal}}),10))}function x(t){var i=c.item[t],n=C(i.uniqueId),o=n.children("div.thumb_border_wrap").children("div.thumb_border"),s=e._transform(i.imgWidth,i.imgHeight,o.width(),o.height(),i.angle),r=o.children("div.thumb_img_wrap").children("img");r.attr("src",i.imgsrc);"image"===i.type&&s.ratio;r.css("transform","translate("+s.x+"px, "+s.y+"px) scale("+s.ratio+") rotate("+i.angleDisplay+"deg)"),iws.util.hide_waitMe(n),c.freeFileBuffer&&i.filebuffer&&delete i.filebuffer}var k=e._MakeThumbFrame(s,c.direction),_=$(k.div),C=function(t){return _.children('[uniqueId="'+t+'"]').children("div.thumb_layout")};iws.scroll&&(i.addClass("contentHolder"),iws.scroll.initialize(i));var S={w:_.width(),h:_.height()};function A(){if(e.debug&&console.log("ChangeSize ... ("+S.w+", "+S.h+")"),null!==c)for(var t=0;t<c.item.length;t++)R(t)}var T=setInterval(function(){var t=_.width(),e=_.height();"V"===o.direction&&t!=S.w&&(A(),S.w=_.width()),"H"===o.direction&&e!=S.h&&(A(),S.h=_.height()),iws.scroll&&iws.scroll.update(i)},1e3);function M(t){for(var e=0;e<c.item.length;e++)if(c.item[e].uniqueId===t)return e;return-1}var E=!1,O=null,P=[],j=function(){var t=P[P.length-1],e=M(t.thumbinfo.uniqueId),i=c.item[e];if(void 0!=i)if(null!==i.pagebuffer||""!==i.pageSrc||!0!==i.errorMsg.success)p.fire("pageLoad",e,i,t.oldIndex),i.pagebuffer=null,P.splice(0,P.length);else if(!1===E){E=!0;var n=[];n.push({cmd:"loadAndMakeThumb",buffer:i.filebuffer,id:{index:e,uniqueId:i.uniqueId,quick:!0}}),n.forEach(function(t){t.__id=g.unshiftWork(t)})}},I=function(t,e){null!==O&&clearTimeout(O),P.push({index:t,oldIndex:e,thumbinfo:c.item[t]}),O=setTimeout(j(),10)};function D(t,i){t=Array.isArray(t)?t:[t],p.fire("append-start"),d.addFinishCallback(i),d.addFinishCallback(function(){p.fire("append-complete")}),t.forEach(function(i,n){var s={pos:n,filedata:i,callback:function(i){p.fire("append-progress",this.__id,Math.max(d.uuid,t.length)),function(t,i,n){function s(t,i,n){var s=c.item[t]=new h(0,0,i);s.caption=n.caption||"",s.nextLine=n.text||"",n.key&&(s.key=n.key),s.type=n.type||"image",s.layout_wrap$=function(t,i){var n=$("<div/>",{class:"thumb_layout_wrap",id:"thumb_layout_wrap_"+t.toString()});n.attr("uniqueId",i),n.attr("index",t.toString());var s=$("<div>",{class:"thumb_layout",id:"thumb_layout_"+t});s.click(l(t,i)),s.dblclick(a(t,i)),n.append(s),_.append(n);var r=function(t,i){var n=$("<div/>",{class:"thumb_border_wrap",id:"thumb_border_wrap_"+t}),s=$("<input/>",{type:"checkbox",class:"thumb_check",id:"thumb_check"+t});s.css("visibility",!0===c.checkVisible?"visible":"hidden"),s.click((r=i,function(t){var e=M(r);1==$(this).is(":checked")?c.item[e].selected=!0:c.item[e].selected=!1,R(e),t.stopPropagation()})),n.append(s);var r;var a=$("<img/>",{class:"thumb_img",id:"thumb_img_"+t});a.attr("src",c.icon.image),a.css("opacity","0.0");var l=$("<div/>",{class:"thumb_img_wrap"});l.append(a);var h=$("<div/>",{class:"thumb_border"});h.append(l),n.append(h),a.on("load",(u=i,function(t){var i=M(u);if(i>=0){c.item[i].imgWidth=this.width,c.item[i].imgHeight=this.height;var n=C(u).children("div.thumb_border_wrap").children("div.thumb_border"),o=e._transform(this.width,this.height,n.width(),n.height(),c.item[i].angle),s=n.children("div.thumb_img_wrap").children("img"),r="image"===c.item[i].type?o.ratio:1;s.css("transform","translate("+o.x+"px, "+o.y+"px) scale("+r+") rotate("+c.item[i].angleDisplay+"deg)"),s.css("opacity","1.0")}}));var u;var d=$('<div class="thumb_number" id="thumb_number_'+t.toString()+'">'+(t+1)+"</div>");if(o.useThumbNumber?d.css("visibility","visible"):d.css("visibility","hidden"),n.append(d),o.useBookMark&&"image"==c.item[t].type){var f=$('<i class="thumb_bookmark"></i>');f.addClass("thumb_bookmark_uncheck"),n.append(f),o.useBookMarkClick&&f.on("click",(g=i,function(t){t.preventDefault(),t.stopPropagation();var e=M(g);c.item[e].bookmark.setData(!c.item[e].bookmark.getData()),p.fire("bookmarkMouseClick",e,c.item[e].bookmark.getData())}))}var g;var m=$('<i class="thumb_annotation"></i>');n.append(m);var v=$('<i class="thumb_multipage"></i>');return n.append(v),n}(t,i);return s.append(r),n.append('<div class="thumb_caption">'+c.item[t].caption+"</div>"),n.append('<div class="thumb_caption_nextLine">'+c.item[t].nextLine+"</div>"),n}(t,s.uniqueId),g||p.fire("error","Loader가 생성되지 않았습니다. path 설정이 잘못되었거나 engine폴더 셋팅을 확인하십시오.");var r={cmd:"loadAndMakeThumb",buffer:s.filebuffer,id:{index:t,uniqueId:s.uniqueId}};return r.__id=g.addWork(r),s}function r(t){if(i.annotation&&"string"==typeof i.annotation){var e=i.annotation.toLowerCase(),o=e.match(/^http?\:\/\/([^\:\/]+)/);if(o)iws.util.urlDownload(i.annotation,function(e){var i=M(t.uniqueId);F(e,i),n&&n()},function(t){n&&n("annotation:"+i.annotation+" - "+t)},{responseType:"text"});else{var s=M(t.uniqueId);F(i.annotation,s),n&&n()}}else n&&n();p.fire("splited",c.item.length)}switch(i.type){case"image":var u=function(t,e,i,r){if(f)f.callBackonmessage(function(e){var n=e.data,a=n.bufferarray,l=c.item.length;if(o.readOnlyOne){var h=s(t,a[0].buffer,i);h.pageCount=a.length,h.pageCount>1&&h.layout_wrap$.find(".thumb_multipage").css("display","block"),r&&r(h)}else{for(var u=null,p=0;p<a.length;p++){var d=l+p;0==p?(!i.text&&a.length>1&&(i.text="1"),u=s(d,a[p].buffer,i)):s(d,a[p].buffer,{caption:i.caption,text:(p+1).toString(),key:null})}r&&r(u)}}),f.callBackonerror(function(t){n&&n("An splite error occurred.")}),f.postMessage({cmd:"split",buffer:e});else{var a=s(t,e,i);r&&r(a)}};if(i.customFormat){var m=null;if(o.customFormatIcon&&(m=o.customFormatIcon[i.customFormat]),m)var v=iws.util.urlDownload(m,function(e){var o=s(t,e,i);o.setError("전자문서 입니다. ( "+i.customFormat+" 문서입니다. )","알림",1),n&&n()},function(e){var o=iws.util.base64.decode(c.icon.error_loadfail.substr(c.icon.error_loadfail.indexOf(",")+1));u(t,o,i,function(t){t.setError("image - "+m+" - "+e),n&&n()})});else{var b=iws.util.base64.decode(c.icon.error_loadfail.substr(c.icon.error_loadfail.indexOf(",")+1));u(t,b,i,function(t){t.setError("image - "+i.customFormat+" did not define"),n&&n()})}}else if(i.buffer)u(t,i.buffer,i,r);else if(i.url){var v=iws.util.urlDownload(i.url,function(e){u(t,e,i,r)},function(e){var o=d.getCurrentWork();if(!0!==o.aborted){var s=iws.util.base64.decode(c.icon.error_network.substr(c.icon.error_network.indexOf(",")+1));u(t,s,i,function(t){t.setError("image - "+i.url+" - "+e),n&&n()})}else n&&n()}),w=d.getCurrentWork();w.quit=(k=v,S=w,function(){S.aborted=!0,k.abort()})}else if(i.src){var b=iws.util.base64.decode(i.src.substr(i.src.indexOf(",")+1));u(t,b,i,r)}break;case"video":case"audio":var y=c.icon[i.type],b=iws.util.base64.decode(y.substr(y.indexOf(",")+1)),x=s(t,b,i);x.mediaSource={type:i.type,sources:i.sources},i.title&&(x.mediaSource.title=i.title),i.poster&&(x.mediaSource.poster=i.poster),i.tracks&&(x.mediaSource.tracks=i.tracks),r();break;default:n&&n("Unkown file type! - "+i.type)}var k,S}(c.item.length,this.filedata,function(t){t&&p.fire("error",t),i&&i()})}};d.addWork(s)})}function F(t,e){e=e||0;var i="useSaveButton"==o.annotationSaveMode;try{var n=JSON.parse(t);if("object"==typeof n){var s=function(t,e){c.item[t]&&(e.angle&&z(t,e.angle),e.annotation&&c.item[t].annotation.setData(e.annotation),i&&e.annotation&&c.item[t].annotation.setTemp(e.annotation),e.masking&&c.item[t].masking.setData(e.masking),i&&e.masking&&c.item[t].masking.setTemp(e.masking),c.item[t].annotModified=!1),p.fire("annotationLoaded",t)};Array.isArray(n)?n.forEach(function(t,i){s(e+i,t)}):s(e,n)}}catch(t){p.fire("error","annotation load error: "+t.message)}}function R(t){if(!(t<0||t>=c.item.length)){var i=c.item[t],n=C(i.uniqueId);c.focusIndex==t?n.addClass("thumb_layout_focused"):n.removeClass("thumb_layout_focused");var o=n.children("div.thumb_border_wrap").children("div.thumb_border");!0===i.selected?o.addClass("thumb_border_select"):o.removeClass("thumb_border_select");var s=e._transform(i.imgWidth,i.imgHeight,o.width(),o.height(),i.angle),r=o.children("div.thumb_img_wrap").children("img"),a="image"===i.type?s.ratio:1;r.css("transform","translate("+s.x+"px, "+s.y+"px) scale("+a+") rotate("+i.angleDisplay+"deg)")}}var B=function(t){return!0!==c.checkVisible&&c.focusIndex===t||!0===c.item[t].selected};function L(t){return t>=0&&t<c.item.length?c.item[t].angle:0}function z(t,e){if(e%90!=0)return!1;try{return c.item[t].angleDisplay=e,c.item[t].angle=e%360,c.item[t].angle<0&&(c.item[t].angle=360+c.item[t].angle),R(t),!0}catch(t){return!1}}return{setOption:function(t){o=$.extend({},o,t)},init:function(t){new Promise(function(t,e){d.clear(function(){var e=[];f&&e.push(f.init().then(function(){console.log("TTTT   spliter end")})),g&&e.push(g.init().then(function(){console.log("LLLL   loader end")})),Promise.all(e).then(function(){$(k.div).empty(),c.focusIndex=-1;for(var e=c.item.length-1;e>=0;e--)c.item[e].clear(),c.item.splice(e,1);return console.log("All   finished Thumb init"),t()},function(t){throw console("End ERROR : "+t),t})})}).then(function(){t&&t()})},appendContents:function(t,e){D(t,e)},setWidth:function(t){c.width=t},setHeight:function(t){c.height=t},rotate:function(t,e){!function(t,e){for(var i=0;i<c.item.length;i++)B(i)&&"image"==c.item[i].type&&(c.item[i].angleDisplay=c.item[i].angleDisplay+t,c.item[i].angle=(c.item[i].angle+t)%360,c.item[i].angle<0&&(c.item[i].angle=360+c.item[i].angle),R(i),c.item[i].annotModified=!0,e&&e(t,c.item[i]))}(t,e)},getAngle:function(t){return L(t)},setAngle:function(t,e){return z(t,e)},remove:function(){!function(){for(var t=c.item.length-1;t>=0;t--)B(t)&&(_.children("div.thumb_layout_wrap").remove('[uniqueId="'+c.item[t].uniqueId+'"]'),c.item[t].clear(),c.item.splice(t,1));for(t=0;t<c.item.length;t++)C(c.item[t].uniqueId).children("div.thumb_border_wrap").children("div.thumb_number").text((t+1).toString())}(),c.focusIndex>=0&&(c.focusIndex>=c.item.length&&(c.focusIndex=c.item.length-1),c.focusIndex>=0?C(c.item[c.focusIndex].uniqueId).trigger("click"):p.fire("pageLoad",-1,"removeAll",-1))},setBookmark:function(t,e){c.item[t]&&c.item[t].bookmark.setData(e)},getBookmark:function(t){return!!c.item[t]&&c.item[t].bookmark.getData()},setSelect:function(t,e){c.item[t].selected=e,C(c.item[t].uniqueId).children("div.thumb_border_wrap").children(".thumb_check").prop("checked",e),R(t)},getSelect:function(t){return c.item[t].selected},setCaption:function(t,e){var i=c.item[t];i&&(i.caption=e,_.children('[uniqueId="'+i.uniqueId+'"]').children("div.thumb_caption").text(e))},getCaption:function(t){var e=c.item[t];return e?e.caption:""},setText:function(t,e){var i=c.item[t];i&&(i.nextLine=e,i.layout_wrap$.find("div.thumb_caption_nextLine").text(e))},getText:function(t){var e=c.item[t];return e?e.nextLine:""},setKey:function(t,e){c.item[t]&&(c.item[t].key=e)},getKey:function(t){return c.item[t]&&c.item[t].key||null},setPrintString:function(t,e){var i=$.extend({},c.item[t].printString,e);c.item[t].printString=i},get pageIndex(){return c.focusIndex},set pageIndex(t){t>=0&&t<c.item.length&&C(c.item[t].uniqueId).trigger("click")},pageCount:function(){return c.item.length},get selectVisible(){return c.checkVisible},set selectVisible(t){c.checkVisible=t;for(var e=0;e<c.item.length;e++){var i=C(c.item[e].uniqueId).children("div.thumb_border_wrap").children(".thumb_check");!0===c.checkVisible?i.css("visibility","visible"):i.css("visibility","hidden")}},getItem:function(t){return c.item[t]},each:function(t){for(var e=0;e<c.item.length;e++)t&&t(c.item[e],e)},setLoadType:function(t){v(t)},print:function(){var t=[],e=new iws.util.sync({});e.addFinishCallback(function(){console.log("출력 선택 페이지 수 : "+t.length),t.length>0&&iws.util.print.image(i,t,o)});for(var n=0;n<c.item.length;n++){var s=c.item[n];if(B(n)&&"image"==s.type&&""!==s.pageSrc&&1==s.errorMsg.success){var r={pos:n,callback:function(e){return function(i){var n=c.item[e];iws.util.blobUrlLoad(n.pageSrc,function(o){t.push({cmd:"print",pageSrc:o,id:{index:e,uniqueId:n.uniqueId,page:{angle:n.angle,annotation:n.annotation.getData(),masking:n.masking.getData(),pageinfo:n.pageInfo,filter:n.filter,printString:n.printString}}}),i&&i()})}}(n)};e.addWork(r)}}},pageSave:function(e,i){var n=";base64,";var o,s,r=c.focusIndex;-1==r?(i(!1,null),p.fire("error","선택된 페이지가 없습니다. \n 저장실패.")):"image"==c.item[r].type&&1==c.item[r].errorMsg.success?c.item[r].filebuffer?i(!0,c.item[r].filebuffer):""!=c.item[r].pageSrc?(o=c.item[r].pageSrc,s=function(t){i(!0,t)},iws.util.blobUrlLoad(o,function(e){var i=e.indexOf(n)+n.length,o=t.atob(e.substring(i)),r=Uint8Array.from(Array.prototype.map.call(o,function(t){return t.charCodeAt(0)}));s(r)})):p.fire("error","저장요소를 포함하고 있지 않습니다. \n 저장실패."):(i(!1,null),p.fire("error","이미지만 저장할 수 있습니다. \n 저장실패."))},pageSaveTiff:function(t){},annotationSave:function(t){var e=new Array;c.item.forEach(function(t,i){var n={version:1};n.angle=L(i),n.annotation=t.annotation.getData(),n.masking=t.masking.getData(),0==n.angle&&0==n.annotation.length&&0==n.masking.length&&(n={}),e.push(n)}),t(JSON.stringify(e))},getAnnotationData:function(t){var e=this.getItem(t);if(e){var i={version:1};return i.angle=L(t),i.annotation=e.annotation.getData(),i.masking=e.masking.getData(),0==i.angle&&0==i.annotation.length&&0==i.masking.length&&(i={}),JSON.stringify(i)}return"{}"},annotationLoad:function(t,e){F(t,e)},findIndex:function(t){return M(t)},getObserver:function(){return p},destroy:function(){if(s.off("dragover drop keydown focus blur scroll click mousemove"),_.remove(),c){for(var t=c.item.length-1;t>=0;t--)c.item[t].clear(),c.item.splice(t,1);c=null}null!==f&&(f.close(),f=null),null!==g&&(g.close(),g=null),clearInterval(T)},drawAnnototation:function(t){y(c.item[t])},getImageToBase64:function(t){var i=function(t){var e=[],i=iws.util.clone(t);return Object.keys(i).map(function(t,n){var o=i[t],s=iws.util.getKlass(o.type,null,"object");e[n]=s.fromObject(o)}),e};function n(t,e){return new Promise(function(n,o){var s=new Image;s.onload=function(t){var o=function(t,e){var n=e.angle||0,o=iws.util.Rotate(n).size(e.pageinfo.width,e.pageinfo.height),s=document.createElement("canvas");s.width=o.width,s.height=o.height;var r={x:e.pageinfo.width/2,y:e.pageinfo.height/2};s.getContext("2d").save(),s.getContext("2d").translate(r.x,r.y),s.getContext("2d").rotate(n*Math.PI/180),s.getContext("2d").translate(-r.x,-r.y);var a={left:0,top:0,right:e.pageinfo.width,bottom:e.pageinfo.height},l=iws.util.Rotate(n).point(r.x,r.y,a.left,a.top),h=iws.util.Rotate(n).point(r.x,r.y,a.right,a.top),c=iws.util.Rotate(n).point(r.x,r.y,a.right,a.bottom),u=iws.util.Rotate(n).point(r.x,r.y,a.left,a.bottom),p=iws.util.Points([l,h,c,u]).getRect(),d=iws.util.Rotate(-n).point(0,0,p.left,p.top);return s.getContext("2d").drawImage(t,-d.x,-d.y,e.pageinfo.width,e.pageinfo.height),s.getContext("2d").restore(),s.getContext("2d").save(),i(e.annotation).forEach(function(t){t.setControlVisible("mrdel",!1);var i=e.pageinfo.xres<96?96:e.pageinfo.xres;t.render(s.getContext("2d"),null,1*i/96)}.bind(this)),i(e.masking).forEach(function(t){t.setControlVisible("mrdel",!1);var i=e.pageinfo.xres<96?96:e.pageinfo.xres;t.render(s.getContext("2d"),null,1*i/96)}.bind(this)),s.getContext("2d").restore(),s}(this,e);n(o)},s.src=t})}return new Promise(function(i,o){var s=c.item[t];if("image"==s.type&&""!==s.pageSrc&&1==s.errorMsg.success){var r={angle:s.angle,annotation:s.annotation.getData(),masking:s.masking.getData(),pageinfo:s.pageInfo};n(s.pageSrc,r).then(function(t){return i=t,new Promise(function(t,n){var o=e._getDimension(i.width,i.height,1e3,1e3),s=document.createElement("canvas");s.width=o.w,s.height=o.h,(new iws.resizer).resize(i,s,{quality:3,alpha:!0,unsharpAmount:80,unsharpRadius:.6,unsharpThreshold:255,transferable:!0}).then(function(){t(s)})});var i}).then(function(t){var e=t.toDataURL("image/jpeg",50);i(e)},function(t){console.log(t)})}else o()})}}}}(window),function(){"use strict";iws.Page=iws.util.createInheritClass(function(){this.initialize.apply(this,arguments)},iws.Observable,{containerClass:"page-container",lowerCanvasEl:null,viewportTransform:[1,0,0,1,0,0],backgroundVpt:!0,overlayVpt:!0,backgroundColor:"",imageCtrl:null,stopRendering:!0,dirty:!1,autoResize:!0,reSampleUse:!0,reSampleRate:.8,reSampleFilter:"convolveFloat32",info:{},filter:{},rangeType:"ZoomIn",initialize:function(t,e){if(e||(e={}),this.imageCtrl=new iws.ImageControl(this),this.trackMouse=new iws.TrackMouse,this._initWrapperElement(t),this._initOptions(e),this._initEventListeners(),this._initResample(),window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var e=(new Date).getTime(),i=Math.max(0,16-(e-o)),n=window.setTimeout(function(){t(e+i)},i),o=e+i;return n}),this.notCreat_toolbar&&0!=this.notCreat_toolbar||(this.mainToolbar=new iws.toolbar.page(this)),this.setTrackMode("move"),this.fire("annotation:use",!1),void 0!==this.visibleToolbar&&this.fire("toolbar:visible",this.visibleToolbar),void 0!==this.fitMode&&this.setFitMode(this.fitMode),this.autoResize&&(this.resizer=new iws.util.resize(this.fullScreenEl,this._reSize.bind(this))),this._reSize(),void 0!==window.Hammer){this.touchInfo=new function(){return{isStarted:!1,scale:0,pinchScale:0,timerId:0,center:{x:0,y:0}}};var i=/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),n=new Hammer(this.lowerCanvasEl,{domEvents:!0});n.on("swipeleft",function(){if(i){var t=this.imageCtrl.getDrawRect(),e=t.right-t.left;t.bottom,t.top;"move"===this.getTrackMode()&&e<=this.width&&this.fire("page:swipe_left")}}.bind(this)),n.on("swiperight",function(){if(i){var t=this.imageCtrl.getDrawRect(),e=t.right-t.left;t.bottom,t.top;"move"===this.getTrackMode()&&e<=this.width&&this.fire("page:swipe_right")}}.bind(this)),n.get("pinch").set({enable:!0}),n.on("pan",function(t){}.bind(this)),n.on("panend",function(t){}),n.on("pinchstart",function(t){this.touchInfo.isStarted=!0}.bind(this)),n.on("pinch",function(t){if("move"===this.getTrackMode()){this.touchInfo.pinchScale=t.scale;var e=$(this.lowerCanvasEl).offset();this.touchInfo.center={x:t.center.x-e.left,y:t.center.y-e.top},clearTimeout(this.touchInfo.timerId),this.touchInfo.timerId=setTimeout(function(){var t=this.touchInfo.scale*this.touchInfo.pinchScale;this._zoom({name:"custom",scale:t},this.touchInfo.center)}.bind(this),1)}}.bind(this)),n.on("pinchend",function(t){this.touchInfo.isStarted=!1}.bind(this)),n.on("doubletap",function(t){(console.log("doubletap"),"move"===this.getTrackMode()||"range"===this.getTrackMode())&&("auto"!==this.getFitMode().name&&this.setFitMode({name:"auto"}))}.bind(this))}},_initWrapperElement:function(t){this.wrapperEl=t,$(this.wrapperEl).css("overflow","hidden"),this.fullScreenEl=iws.util.makeElement("div",{class:"page-fullScreen"}),this.wrapperEl.appendChild(this.fullScreenEl),this.pageContainer=iws.util.makeElement("div",{class:"page-container"}),this.fullScreenEl.appendChild(this.pageContainer),this._createLowerCanvas(this.pageContainer),this.elErrorContainer=iws.util.makeElement("div",{class:"page-errorContainer w3-container"}),this.elErrorContainer.innerHTML='<div class="w3-panel w3-red"><h3>Error!</h3><p>Message.</p></div>',this.pageContainer.appendChild(this.elErrorContainer),this.tooltipBox=iws.util.makeElement("div",{class:"iws-viewer-tooltip"}),iws.util.makeElementUnselectable(this.tooltipBox),this.pageContainer.appendChild(this.tooltipBox),this.pageContainer.addClass("contentHolder"),iws.scroll&&iws.scroll.initialize(this.pageContainer,{handlers:["click-rail","drag-scrollbar"],customInfo:{getContentInfo:function(){var t=this.imageCtrl.getDrawRect();return{scrollWidth:t.right-t.left,scrollHeight:t.bottom-t.top,scrollLeft:-t.left,scrollTop:-t.top}}.bind(this),setContentInfo:function(t){var e=this.imageCtrl.getDrawRect();if("top"===t.direction){var i=e.top-t.value;this.imageCtrl.move({X:0,Y:-i}),this.renderAll()}else if("left"===t.direction){var n=e.left-t.value;this.imageCtrl.move({X:-n,Y:0}),this.renderAll()}}.bind(this)}}),this.observe("page:render",function(){iws.scroll&&iws.scroll.update(this.pageContainer)}),iws.pageFilter&&(this.pageFilter=new iws.pageFilter(this))},_createLowerCanvas:function(t){this.lowerCanvasEl=iws.util.makeElement("canvas",{class:"lower-canvas"}),this.contextContainer=this.lowerCanvasEl.getContext("2d"),this.contextContainer.imageSmoothingEnabled=!0,t.appendChild(this.lowerCanvasEl)},_reSize:function(){var t=this.fullScreenEl.clientWidth,e=this.fullScreenEl.clientHeight,i=t,n=e;this.mainToolbar&&this.mainToolbar.isVisible()&&(n=e-this.mainToolbar.height()),this.pageContainer.style.width=i+"px",this.pageContainer.style.height=n+"px",this.lowerCanvasEl.width=i,this.lowerCanvasEl.height=n,this.lowerCanvasEl.style.width=i+"px",this.lowerCanvasEl.style.height=n+"px",this.width=parseInt(t,10)||0,this.height=parseInt(e,10)||0,this.imageCtrl.fitRefresh(),this.renderAll()},_initOptions:function(t){for(var e in t)this[e]=t[e];this.viewportTransform=this.viewportTransform.slice()},_initEventListeners:function(){$(this.lowerCanvasEl).on("mousedown touchstart",this.onMouseDown.bind(this)),$(this.lowerCanvasEl).on("mousemove touchmove",this.onMouseMove.bind(this)),$(this.lowerCanvasEl).on("mousewheel DOMMouseScroll",this.onMouseWheel.bind(this)),$(this.lowerCanvasEl).on("dblclick",this.onMouseDblclick.bind(this)),this.observe("page:zoom",function(){this.tooltip()}),this.observe("page:fitMode",function(){this.tooltip()})},_initResample:function(){if("undefined"!=typeof Worker&&void 0!==this.path&&this.reSampleUse){if(void 0===iws.resizer)return void console.log("iws.resizer undefined");var t=function(){this.resizer=new iws.resizer,this.initialize.apply(this,arguments)};t.prototype={reSampler_Queue:[],reSampler_Running:!1,lastInfo:{scale:0,width:0,height:0},currentInfo:{scale:0,width:0,height:0},initialize:function(t,e,i){for(var n in t)this[n]=t[n];this.callback_Resampled=e,this.callback_Canceled=i},requestResample:function(t,e){this.currentInfo={scale:t,width:e.width,height:e.height},this.timer_Resample&&clearTimeout(this.timer_Resample),this._needToResample(t)?(this.resizer.cancel(),this.timer_Resample=setTimeout(function(){this.reSampler_Queue.push({scale:t,width:e.width,height:e.height}),this.reSampler_Running||this._workLastRequest()}.bind(this),100)):this.callback_Canceled&&this.callback_Canceled()},init:function(){this.reSampler_Running=!1,this.lastInfo={scale:0,width:0,height:0},this.currentInfo={scale:0,width:0,height:0},this.timer_Resample&&clearTimeout(this.timer_Resample);for(var t=this.reSampler_Queue.length-1;t>=0;t--)this.reSampler_Queue.splice(t,1)},_workLastRequest:function(){var t=this.reSampler_Queue.pop();if(t.scale!==this.lastInfo.scale){this.lastInfo=t,this.reSampler_Running=!0;var e=this.imgCtrl.getCanvasResample();e.width=t.width,e.height=t.height,this.resizer.resize(this.imgCtrl.getCanvas(),e,{quality:0,alpha:!0,unsharpAmount:80,unsharpRadius:.6,unsharpThreshold:2,transferable:!0}).then(function(){this.reSampler_Running=!1,this.callback_Resampled()}.bind(this)).catch(function(t){throw console.log("Resample fail!!!!!! : "+t),t})}for(var i=this.reSampler_Queue.length-1;i>=0;i--)this.reSampler_Queue.splice(i,1)},_needToResample:function(t){return t<=this.reSampleRate}};var e=function(){this.imageCtrl.isValid()&&this.reSample.requestResample(this.imageCtrl.scale,this.imageCtrl.getScaleSize())};this.reSample=new t({path:this.path,reSampleRate:this.reSampleRate,reSampleFilter:this.reSampleFilter,imgCtrl:this.imageCtrl},function(t,e,i){this.renderAll()}.bind(this),function(){this.imageCtrl.clearResample(),this.renderAll()}.bind(this)),this.observe("page:setRawData",function(){this.reSample.init()}),this.observe("page:setFilter",function(){this.reSample.init(),e.call(this)}),this.observe("canvas:cleared",function(){this.reSample.init()}),this.observe("page:zoom",function(){e.call(this)}),this.observe("page:fitMode",function(){e.call(this)})}},_initSpliter:function(){"undefined"!=typeof Worker&&void 0!==this.path&&(this.pages=[],this.observe("canvas:cleared",function(){this.pages=[],this.spliter&&this.spliter.init()}),this.observe("page:setBuffer",function(t,e){this.spliter&&this.spliter.callBackonmessage(function(t){var i=t.data.bufferarray;this.pages=i,this.pages.length>1&&this.pageContainer.appendChild('<div id="lg-counter"><span id="lg-counter-current">2</span> / <span id="lg-counter-all">4</span></div>'),e&&e()}.bind(this)),this.spliter&&this.spliter.callBackonerror(function(t){var i="A splite error occurred.(page)";this.fire("error",i),e&&e(i)}.bind(this)),this.spliter&&this.spliter.postMessage({cmd:"split",buffer:t})}.bind(this)),this.spliter=iws.util.work.Spliter(iws.util.string.combinePath(this.path,"/engine/iws.w.split.js"),!1))},setCursor:function(t){this.lowerCanvasEl.style.cursor=t},onMouseDown:function(t){this.touchInfo&&(this.touchInfo.scale=this.imageCtrl.scale),$(this.lowerCanvasEl).off("mousemove touchmove"),$(document).on("mousemove touchmove",this.onMouseMove.bind(this)),$(document).on("mouseup touchend",this.onMouseUp.bind(this)),this._onMouseDown(t.originalEvent||t)},onMouseMove:function(t){this._onMouseMove(t.originalEvent||t)},onMouseUp:function(t){$(document).off("mouseup touchend"),$(document).off("mousemove touchmove"),$(this.lowerCanvasEl).on("mousemove touchmove",this.onMouseMove.bind(this)),this._onMouseUp(t.originalEvent||t)},_onMouseDown:function(t){var e=iws.util.getPointers(t);if(1===e.length){var i=this.getPointer(t);this.trackMouse.mouseMovePos=this.trackMouse.mouseDownPos=i,this.trackMouse.leftMouseButtonDown=!0,this.renderAll()}else console.log("_onMouseDown : ("+e[0].x+", "+e[0].y+"), ("+e[1].x+", "+e[1].y+")")},_onMouseMove:function(t){if(!this.touchInfo||this.touchInfo&&!this.touchInfo.isStarted){var e=this.getPointer(t),i=this.trackMouse.mousePrevMoveOffset.x=e.x-this.trackMouse.mouseMovePos.x,n=this.trackMouse.mousePrevMoveOffset.y=e.y-this.trackMouse.mouseMovePos.y;this.trackMouse.isMove()&&this.imageCtrl.move({X:i,Y:n}),this.imageCtrl.isInDrawImage(this.contextContainer,e)?"move"==this.trackMouse.mouseType?this.setCursor("move"):"range"==this.trackMouse.mouseType?this.setCursor("crosshair"):"glass"==this.trackMouse.mouseType&&(this.trackMouse.leftMouseButtonDown?this.setCursor("none"):this.setCursor("pointer")):this.setCursor("default"),this.trackMouse.mouseMovePos=e,this.renderAll()}},_onMouseUp:function(t){if(this.trackMouse.isRange()&&this.imageCtrl.isValid()){var e=this.trackMouse.getIntersectRect(this.imageCtrl.getDrawRect()),i=this.imageCtrl.getImageRect(e),n=iws.util.Rect(i);if(n.width()>4&&n.height()>4)if("ZoomIn"==this.rangeType){var o=this.imageCtrl.getImageRealRect(e);e.width=e.right-e.left,e.height=e.bottom-e.top;var s=(d=this.lowerCanvasEl.width,f=this.lowerCanvasEl.height,g=e.width,m=e.height,v=0,b=0,w=d/g,y=f/m,(x=Math.min(w,y))>1?(v=d/x,b=f/x):(v=d,b=f),{w:v,h:b,x:(g-v)/2,y:(m-b)/2,ratio:x}),r=this.imageCtrl.scale*s.ratio;this.imageCtrl.zoom({name:"custom",scale:r});var a=this.imageCtrl.getDrawRangeRect(o);a.width=a.right-a.left,a.height=a.bottom-a.top;var l=(this.lowerCanvasEl.width-a.width)/2,h=(this.lowerCanvasEl.height-a.height)/2,c=-a.left+l,u=-a.top+h;this.imageCtrl.move({X:c,Y:u});var p=this.imageCtrl.getDrawRangeRect(o);this.imageCtrl.tempRect=p,this.renderAll(),setTimeout(function(){this.imageCtrl.tempRect=null,this.renderAll()}.bind(this),400)}else this.fire("mouse:drawRanged",n.round())}var d,f,g,m,v,b,w,y,x;this.trackMouse.leftMouseButtonDown=!1,this.renderAll()},onMouseWheel:function(t){t.preventDefault(),t.stopPropagation();var e=$(this.lowerCanvasEl).offset(),i=(t.pageX||t.originalEvent.pageX,e.left,t.pageY||t.originalEvent.pageY,e.top,this.getPointer(t.originalEvent||t));t.originalEvent.detail<0||t.originalEvent.wheelDelta>0?this._zoom("in",i):this._zoom("out",i)},onMouseDblclick:function(t){t.preventDefault(),t.stopPropagation(),"move"!==this.getTrackMode()&&"range"!==this.getTrackMode()||"auto"!==this.getFitMode().name&&this.setFitMode({name:"auto"})},tooltip:function(){if(this.imageCtrl.isValid()){var t,e,i=this,n=i.tooltipBox,o=i.imageCtrl.scale;t=n,e=Math.round(100*o)+"%",void 0!==t.textContent?t.textContent=e:t.innerText=e,clearTimeout(i.tooltiping),i.tooltiping?clearTimeout(i.tooltiping):(i.fading&&iws.event.dispatchEvent(n,"transitionend"),n.addClass("iws-viewer-show"),n.addClass("iws-viewer-fade"),n.addClass("iws-viewer-transition"),n.addClass("iws-viewer-in")),i.tooltiping=setTimeout(function(){iws.event.addListener(n,"transitionend",function(){n.removeClass("iws-viewer-show"),n.removeClass("iws-viewer-fade"),n.removeClass("iws-viewer-transition"),i.fading=!1},!0),n.removeClass("iws-viewer-in"),i.fading=!0,i.tooltiping=!1},1e3)}},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.clearContext(this.contextContainer),this.imageCtrl.clear(),this.fire("canvas:cleared"),this.renderAll(),this.stopRendering=!0,$(this.elErrorContainer).css("display","none"),this},setInfo:function(t){for(var e in t)this.info[e]=t[e],e in this.imageCtrl.ImageProps&&(this.imageCtrl[e]=t[e])},_setDefault:function(){this.pageFilter&&this.pageFilter.changeDefaultValue(),$(this.elErrorContainer).css("display","none")},setSrc:function(t,e,i,n,o){this._setDefault();Date.now();this.imageCtrl.setSrc(e,i,t,n,function(){o&&o(),this.renderAll()}.bind(this))},setRawData:function(t,e,i,n,o){this._setDefault();Date.now();this.imageCtrl.setRawData(e,i,new Uint8Array(t),n,function(){o&&o(),this.renderAll()}.bind(this))},setBuffer:function(t,e){this.fire("page:setBuffer",t,e)},setErrorMsg:function(t){this.clear(),0==t.level?($(this.elErrorContainer).find("div").toggleClass("w3-red",!0),$(this.elErrorContainer).find("div").toggleClass("w3-notice",!1)):1==t.level&&($(this.elErrorContainer).find("div").toggleClass("w3-red",!1),$(this.elErrorContainer).find("div").toggleClass("w3-notice",!0)),$(this.elErrorContainer).find("h3").text(t.title),$(this.elErrorContainer).find("p").text(t.msg),$(this.elErrorContainer).css("display","inline-block")},setFitMode:function(t){this.imageCtrl.fitMode=t,this.renderAll()},getFitMode:function(){return this.imageCtrl.fitMode},_zoom:function(t,e){this.imageCtrl.zoom(t,e),this.renderAll()},zoomIn:function(){this._zoom("in")},zoomOut:function(){this._zoom("out")},setRotate:function(t){this.imageCtrl.rotate(t),this.renderAll()},setAngle:function(t){this.imageCtrl.setAngle(t),this.renderAll()},setTrackMode:function(t){this.trackMouse.mouseType=t,this.fire("mouseTrackChange",t)},getTrackMode:function(){return this.trackMouse.mouseType},renderAll:function(){if(iws.useAnimationFrame){if(this.dirty=!0,this.stopRendering){this.stopRendering=!1;var t=this,e=function(){if(t.dirty){t.dirty=!1;var i=t.contextContainer;t._renderCanvas(i)}t.stopRendering||window.requestAnimationFrame(e)};e()}}else this._renderCanvas(this.contextContainer);return this},_renderCanvas:function(t){this._renderBefore(t),console.log("_renderCanvas................."),this.imageCtrl.render(t),this._renderTracking(t),this._renderAfter(t)},_renderBefore:function(t){this.clearContext(t),this.fire("before:render"),this._renderBackgroundOrOverlay(t,"background")},_renderTracking:function(t){this.trackMouse.isGlass()&&this.trackMouse.drawMagnifyGlass(this.lowerCanvasEl),this.trackMouse.isRange()&&this.imageCtrl.isValid()&&this.trackMouse.drawRange(this.lowerCanvasEl,this.imageCtrl.getDrawRect())},_renderAfter:function(t){this._renderBackgroundOrOverlay(t,"overlay"),this.fire("after:render")},_renderBackgroundOrOverlay:function(t,e){var i=this[e+"Color"];i&&(t.fillStyle=i.toLive?i.toLive(t):i,t.fillRect(i.offsetX||0,i.offsetY||0,this.width,this.height)),(i=this[e+"Image"])&&(this[e+"Vpt"]&&(t.save(),t.transform.apply(t,this.viewportTransform)),i.render(t),this[e+"Vpt"]&&t.restore())},setBackgroundColor:function(t){return this.__setBgOverlayColor("backgroundColor",t,this.renderAll.bind(this))},__setBgOverlayColor:function(t,e,i){if(e&&e.source){var n=this;iws.util.loadImage(e.source,function(o){null!=o&&(n[t]=new iws.Pattern({source:o,repeat:e.repeat,offsetX:e.offsetX,offsetY:e.offsetY})),i&&i()})}else this[t]=e,i&&i();return this},restorePointerVpt:function(t){return iws.util.transformPoint(t,iws.util.invertTransform(this.viewportTransform))},getPointer:function(t,e){var i,n=iws.util.getPointer(t),o=this.lowerCanvasEl.getBoundingClientRect(),s=o.width||0,r=o.height||0;return s&&r||("top"in o&&"bottom"in o&&(r=Math.abs(o.top-o.bottom)),"right"in o&&"left"in o&&(s=Math.abs(o.right-o.left))),this._offset=iws.util.getElementOffset(this.lowerCanvasEl),n.x=n.x-this._offset.left,n.y=n.y-this._offset.top,e||(n=this.restorePointerVpt(n)),i=0===s||0===r?{width:1,height:1}:{width:this.lowerCanvasEl.width/s,height:this.lowerCanvasEl.height/r},{x:n.x*i.width,y:n.y*i.height}},crop:function(t,e){var i=this.imageCtrl.getRotateSize(),n=document.createElement("canvas");n.width=i.width,n.height=i.height;var o=n.getContext("2d"),s={x:this.imageCtrl.width/2,y:this.imageCtrl.height/2};o.translate(s.x,s.y),o.rotate(this.imageCtrl.angle*Math.PI/180),o.translate(-s.x,-s.y);var r={left:0,top:0,right:this.imageCtrl.width,bottom:this.imageCtrl.height},a=iws.util.Rotate,l=this.imageCtrl.angle,h=a(l).rect(s.x,s.y,r),c=a(-l).point(0,0,h.left,h.top);o.drawImage(this.imageCtrl.imgCanvas,-c.x,-c.y);var u=iws.util.Rect(t).width(),p=iws.util.Rect(t).height(),d=document.createElement("canvas");d.width=u,d.height=p,d.getContext("2d").drawImage(n,t.left,t.top,u,p,0,0,u,p);var f=d.toDataURL("image/png");e&&e(f,function(t){for(var e=t.split(","),i=(e[0].match(/:(.*?);/)[1],atob(e[1])),n=i.length,o=new Uint8Array(n);n--;)o[n]=i.charCodeAt(n);return o}(f))},visible:function(t,e){this.fire(t+":visible",e)},setFilter:function(){this.pageFilter&&this.filter&&this.pageFilter.setFilter()},showFilter:function(t){return this.pageFilter?this.pageFilter.showFilter(t):null},destroy:function(){this.reSample&&(this.reSample.init(),this.reSample=null),this.spliter&&(this.spliter.init(),this.spliter=null),$(this.fullScreenEl).remove()}})}(),iws.pageFilter=function(t){this.page=t,this.initialize()},iws.pageFilter.prototype={defaultValue:iws.util.filter.defaultValue,initialize:function(){this.imageFilter=iws.util.makeElement("div",{class:"page-imageFilter",id:"imageFilter"}),this.imageFilter.innerHTML='<a class="handle ui-slideouttab-handle-rounded">Filter<i class="fa fa-icon fa-bank"></i></a><div class="range-slider"><label class="range-label" >Brightness</label><div class="range-input-wrap"><input id="brightness" class="range-slider__range" type="range" value="0" min="-255" max="255" step="5"><span class="range-slider__value">0</span></div></div><div class="range-slider"><label class="range-label" >Contrast</label><div class="range-input-wrap"><input id="contrast" class="range-slider__range" type="range" value="0" min="-100" max="100" step="5"><span class="range-slider__value">0</span></div></div><div class="range-slider"><label class="range-label" >Gamma</label><div class="range-input-wrap"><input id="gamma" class="range-slider__range" type="range" value="100" min="0" max="255" step="5"><span class="range-slider__value">0</span></div></div><button type="button" class="range-btn range-btnGray" id="reset" title="Set default value">Reset default</button>',this.page.pageContainer.appendChild(this.imageFilter);var t=this;$(this.imageFilter).find("button#reset").on("click",function(){t.changeDefaultValue(),$(t.imageFilter).find(".range-slider__range").each(function(){$(this).trigger("input")})}),$(this.imageFilter).tabSlideOut({offset:10,tabLocation:"bottom",offsetReverse:!0,handleOffsetReverse:!0}),function(){var e=$(this.imageFilter).find(".range-slider"),i=$(this.imageFilter).find(".range-slider__range"),n=$(this.imageFilter).find(".range-slider__value"),o=null;this.page,n.each(function(){var e=$(this).prev().attr("id"),i=t.defaultValue[e];$(this).prev().val(i),$(this).html(i)}),e.each(function(){i.on("input change",function(){$(this).next(n).html(this.value),clearTimeout(o);var e=this;o=setTimeout(function(){switch(e.id){case"brightness":case"contrast":t.changeValue({gamma:t.defaultValue.gamma}),t._executeFilter(function(e){return t.changeValue({brightness:Number(i.filter("#brightness").val()),contrast:Number(i.filter("#contrast").val())}),iws.util.filter.brightness_contrast(e,t.page.filter.brightness,t.page.filter.contrast)});break;case"gamma":t.changeValue({brightness:t.defaultValue.brightness,contrast:t.defaultValue.contrast}),t._executeFilter(function(i){return t.changeValue({gamma:Number(e.value)}),iws.util.filter.gamma(i,t.page.filter.gamma/100)})}},10)})})}.call(this),this.page.observe("filter:visible",function(t){"show"===t&&(this.imageFilter.style.display="block"),"hide"===t&&(this.imageFilter.style.display="none")}.bind(this))},_executeFilter:function(t){var e=this.page.imageCtrl.getOriginalImageData();if(e){var i=t(e);this.page.imageCtrl.putImageData(i),this.page.fire("page:setFilter"),this.page.renderAll()}},changeDefaultValue:function(t){var e=this;$(this.imageFilter).find(".range-slider__value").each(function(){var i=$(this).prev().attr("id");if(!t||-1!=t.indexOf(i)){var n=e.defaultValue[i];$(this).prev().val(n),$(this).html(n)}})},changeValue:function(t){var e=this;$(this.imageFilter).find(".range-slider__value").each(function(){var i=$(this).prev().attr("id");if(t.hasOwnProperty(i)){var n=t[i];$(this).prev().val(n),$(this).html(n),e.page.filter[i]=n}})},setFilter:function(){var t=this;this.page.filter.hasOwnProperty("brightness")&&this.page.filter.hasOwnProperty("contrast")&&this.page.filter.hasOwnProperty("gamma")&&(this.page.filter.brightness!=this.defaultValue.brightness||this.page.filter.contrast!=this.defaultValue.contrast?(this.changeDefaultValue(["gamma"]),this.changeValue({brightness:this.page.filter.brightness,contrast:this.page.filter.contrast}),this._executeFilter(function(e){return iws.util.filter.brightness_contrast(e,t.page.filter.brightness,t.page.filter.contrast)})):this.page.filter.gamma!=this.defaultValue.gamma&&(this.changeDefaultValue(["brightness","contrast"]),this.changeValue({gamma:this.page.filter.gamma}),this._executeFilter(function(e){return iws.util.filter.gamma(e,t.page.filter.gamma/100)})))},showFilter:function(t){return $(this.imageFilter).tabSlideOut(t||"toggle")}},function(t){"use strict";var e=iws.logger(!0,"[iws.media]"),i=e._log;e._warn;function n(t,e,n,o){i("_event:"+e+", bubbles:"+n)}var o,s,r,a,l,h,c,u,p,d,f,g={object:function(t){return null!==t&&"object"==typeof t},array:function(t){return null!==t&&"object"==typeof t&&t.constructor===Array},number:function(t){return null!==t&&("number"==typeof t&&!isNaN(t-0)||"object"==typeof t&&t.constructor===Number)},string:function(t){return null!==t&&("string"==typeof t||"object"==typeof t&&t.constructor===String)},boolean:function(t){return null!==t&&"boolean"==typeof t},nodeList:function(t){return null!==t&&t instanceof NodeList},htmlElement:function(t){return null!==t&&t instanceof HTMLElement},function:function(t){return null!==t&&"function"==typeof t},undefined:function(t){return null!==t&&void 0===t}},m=function(){var t=!1,e="",i=["webkit","o","moz","ms","khtml"];if(g.undefined(document.cancelFullScreen))for(var n=0,o=i.length;n<o;n++){if(e=i[n],!g.undefined(document[e+"CancelFullScreen"])){t=!0;break}if(!g.undefined(document.msExitFullscreen)&&document.msFullscreenEnabled){e="ms",t=!0;break}}else t=!0;return{supportsFullScreen:t,prefix:e,fullScreenEventName:"ms"===e?"MSFullscreenChange":e+"fullscreenchange",isFullScreen:function(t){switch(g.undefined(t)&&(t=document.body),this.prefix){case"":return document.fullscreenElement===t;case"moz":return document.mozFullScreenElement===t;default:return document[e+"FullscreenElement"]===t}},requestFullScreen:function(t){return g.undefined(t)&&(t=document.body),""===e?t.requestFullScreen():t[e+("ms"===e?"RequestFullscreen":"RequestFullScreen")]()},cancelFullScreen:function(){return""===e?document.cancelFullScreen():document[e+("ms"===e?"ExitFullscreen":"CancelFullScreen")]()},element:function(){return""===e?document.fullscreenElement:document[e+"FullscreenElement"]}}}(),v=(a=navigator.userAgent,l=navigator.appName,h=""+parseFloat(navigator.appVersion),c=parseInt(navigator.appVersion,10),u=!1,p=!1,d=!1,f=!1,-1!==navigator.appVersion.indexOf("Windows NT")&&-1!==navigator.appVersion.indexOf("rv:11")?(u=!0,l="IE",h="11"):-1!==(s=a.indexOf("MSIE"))?(u=!0,l="IE",h=a.substring(s+5)):-1!==(s=a.indexOf("Chrome"))?(d=!0,l="Chrome",h=a.substring(s+7)):-1!==(s=a.indexOf("Safari"))?(f=!0,l="Safari",h=a.substring(s+7),-1!==(s=a.indexOf("Version"))&&(h=a.substring(s+8))):-1!==(s=a.indexOf("Firefox"))?(p=!0,l="Firefox",h=a.substring(s+8)):(o=a.lastIndexOf(" ")+1)<(s=a.lastIndexOf("/"))&&(l=a.substring(o,s),h=a.substring(s+1),l.toLowerCase()===l.toUpperCase()&&(l=navigator.appName)),-1!==(r=h.indexOf(";"))&&(h=h.substring(0,r)),-1!==(r=h.indexOf(" "))&&(h=h.substring(0,r)),c=parseInt(""+h,10),isNaN(c)&&(h=""+parseFloat(navigator.appVersion),c=parseInt(navigator.appVersion,10)),{name:l,version:c,isIE:u,isFirefox:p,isChrome:d,isSafari:f,isIos:/(iPad|iPhone|iPod)/g.test(navigator.platform),isIphone:/(iPhone|iPod)/g.test(navigator.userAgent),isTouch:"ontouchstart"in document.documentElement});function b(t){return t.keyCode?t.keyCode:t.which}function w(t,e,i){var n=document.createElement(t);!function(t,e){for(var i in e)t.setAttribute(i,g.boolean(e[i])&&e[i]?"":e[i])}(n,i),e.insertBefore(n,e.firstChild)}var y={autoplay:!1,loop:!1,seekTime:10,volume:10,volumeMin:0,volumeMax:10,volumeStep:1,duration:null,displayDuration:!0,clickToPlay:!0,hideControls:!0,showPosterOnEnd:!1,disableContextMenu:!0,tooltips:{controls:!1,seek:!0},selectors:{html5:"video, audio",embed:"[data-type]",editable:"input, textarea, select, [contenteditable]",container:".iwsmedia",controls:{wrapper:".__controls"},buttons:{seek:'[data-btn="seek"]',play:'[data-btn="play"]',pause:'[data-btn="pause"]',restart:'[data-btn="restart"]',rewind:'[data-btn="rewind"]',forward:'[data-btn="fast-forward"]',mute:'[data-btn="mute"]',captions:'[data-btn="captions"]',fullscreen:'[data-btn="fullscreen"]'},volume:{input:'[data-btn="volume"]',display:".__volume--display"},progress:{container:".__progress",buffer:".__progress--buffer",played:".__progress--played"},captions:".__captions",currentTime:".__time--current",duration:".__time--duration"},classes:{setup:"c--setup",ready:"c--ready",videoWrapper:"c--video-wrapper",type:"iws--{0}",stopped:"c--stopped",playing:"c--playing",muted:"c--muted",loading:"c--loading",tooltip:"c--tooltip",hidden:"c--sr-only",hideControls:"c--hide-controls",isIos:"c--is-ios",isTouch:"c--is-touch",captions:{enabled:"c--captions-enabled",active:"c--captions-active"},fullscreen:{enabled:"c--fullscreen-enabled",active:"c--fullscreen-active"},tabFocus:"tab-focus"},captions:{defaultActive:!1},fullscreen:{enabled:!0,fallback:!0,allowAudio:!1},storage:{enabled:!0,key:"iws.media"},controls:["play-large","play","progress","current-time","mute","volume","captions","fullscreen","restart","rewind","fast-forward"],i18n:{restart:"Restart",rewind:"Rewind {seektime} secs",play:"Play",pause:"Pause",forward:"Forward {seektime} secs",played:"played",buffered:"buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",toggleMute:"Mute",toggleCaptions:"Captions",toggleFullscreen:"Fullscreen"},types:{html5:["video","audio"]},events:["ready","ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied"]};function x(t,e){return 0===t||0===e||isNaN(t)||isNaN(e)?0:(t/e*100).toFixed(2)}function k(t,e,i,n){C(t,e,function(e){i.apply(t,[e])},n)}function _(t,e,i,n,o){var s=e.split(" ");if(g.boolean(o)||(o=!1),t instanceof NodeList)for(var r=0;r<t.length;r++)t[r]instanceof Node&&_(t[r],arguments[1],arguments[2],arguments[3]);else for(var a=0;a<s.length;a++)t[n?"addEventListener":"removeEventListener"](s[a],i,o)}function C(t,e,i,n){t&&_(t,e,i,!0,n)}function S(t,e,i,n){t&&_(t,e,i,!1,n)}iws.media=function(t,e){var o=this,s=this,r=$.extend({},y,e);function a(t){s.media&&(D(s.media.currentTime,s.currentTime),t&&"timeupdate"===t.type&&s.media.seeking||l(t))}function l(t){var e,i=s.progress.played,n=0,r=_();if(t)switch(t.type){case"timeupdate":case"seeking":if(s.controls.pressed)return;n=x(s.media.currentTime,r),"timeupdate"===t.type&&s.buttons.seek&&(s.buttons.seek.value=n);break;case"playing":case"progress":i=s.progress.buffer,n=(e=s.media.buffered)&&e.length?x(e.end(0),r):g.number(e)?100*e:0}o._setProgress(i,n)}function h(){s.media&&($(s.container).toggleClass(r.classes.playing,!s.media.paused),$(s.container).toggleClass(r.classes.stopped,s.media.paused),o._toggleControls(s.media.paused))}function c(){var t=_()||0;!s.duration&&r.displayDuration&&s.media.paused&&D(t,s.currentTime),s.duration&&D(t,s.duration),F()}function u(t){var e="waiting"===t.type;clearTimeout(o.timers.loading),o.timers.loading=setTimeout(function(){$(s.container).toggleClass(r.classes.loading,e),o._toggleControls(e)},e?250:0)}function p(t){return t||(t=s.media.paused),t?o._play():o._pause(),t}function d(t){g.number(t)||(t=r.seekTime),w(s.media.currentTime-t)}function f(t){g.number(t)||(t=r.seekTime),w(s.media.currentTime+t)}function w(t){var e=0,n=(s.media.paused,_());$.isNumeric(t)?e=t:"object"==typeof t&&-1!==["input","change"].indexOf(t.type)&&(e=t.target.value/t.target.max*n),e<0?e=0:e>n&&(e=n),o._updateSeekDisplay(e);try{s.media.currentTime=e.toFixed(4)}catch(t){}i("Seeking to "+s.media.currentTime+" seconds")}function _(){var t=parseInt(r.duration),e=0;return s.media&&null!==s.media.duration&&!isNaN(s.media.duration)&&(e=s.media.duration),isNaN(t)?e:t}function S(t){var e=$(r.selectors.captions)[0],i=document.createElement("span");e.innerHTML="",g.undefined(t)&&(t=""),g.string(t)?i.innerHTML=t.trim():i.appendChild(t),e.appendChild(i)}function A(t){g.boolean(t)||(t=!s.media.muted),s.media.muted=t,0===s.media.volume&&T(r.volume)}function T(t){var e=r.volumeMax,i=r.volumeMin;g.undefined(t)&&(t=s.storage.volume),(null===t||isNaN(t))&&(t=r.volume),t>e&&(t=e),t<i&&(t=i),s.media.volume=parseFloat(t/e),s.volume.display&&(s.volume.display.value=t),0===t?s.media.muted=!0:s.media.muted&&t>0&&A()}function M(t){var e=s.media.muted?0:s.media.volume*r.volumeMax;g.number(t)||(t=r.volumeStep),T(e+t)}function E(t){var e=s.media.muted?0:s.media.volume*r.volumeMax;g.number(t)||(t=r.volumeStep),T(e-t)}function O(){var t=s.media.muted?0:s.media.volume*r.volumeMax;s.volume.input&&(s.volume.input.value=t),s.volume.display&&(s.volume.display.value=t),P({volume:t}),$(s.container).toggleClass(r.classes.muted,0===t)}function P(t){$.extend(s.storage,t),window.localStorage.setItem(r.storage.key,JSON.stringify(s.storage))}function j(t){var e=m.supportsFullScreen;if(e){if(!t||t.type!==m.fullScreenEventName)return m.isFullScreen(s.container)?m.cancelFullScreen():(o._saveScrollPosition(),m.requestFullScreen(s.container)),void(s.isFullscreen=m.isFullScreen(s.container));s.isFullscreen=m.isFullScreen(s.container)}else s.isFullscreen=!s.isFullscreen,document.body.style.overflow=s.isFullscreen?"hidden":"";$(s.container).toggleClass(r.classes.fullscreen.active,s.isFullscreen),o.resize(),n(s.container,s.isFullscreen?"enterfullscreen":"exitfullscreen",!0),!s.isFullscreen&&e&&o._restoreScrollPosition()}function I(t){s.buttons.captions&&(g.boolean(t)||(t=-1===s.container.className.indexOf(r.classes.captions.active)),s.captionsEnabled=t,$(s.container).toggleClass(r.classes.captions.active,s.captionsEnabled),n(s.container,s.captionsEnabled?"captionsenabled":"captionsdisabled",!0),P({captionsEnabled:s.captionsEnabled}))}function D(t,e){if(e){isNaN(t)&&(t=0),s.secs=parseInt(t%60),s.mins=parseInt(t/60%60),s.hours=parseInt(t/60/60%60);var i=parseInt(_()/60/60%60)>0;s.secs=("0"+s.secs).slice(-2),s.mins=("0"+s.mins).slice(-2),e.innerHTML=(i?s.hours+":":"")+s.mins+":"+s.secs}}function F(t){var e=_();if(r.tooltips.seek&&s.progress.container&&0!==e){var i=s.progress.container.getBoundingClientRect(),n=0,o=r.classes.tooltip+"--visible";if(t)n=100/i.width*(t.pageX-i.left);else{if(!$(s.progress.tooltip).hasClass(o))return;n=s.progress.tooltip.style.left.replace("%","")}n<0?n=0:n>100&&(n=100),D(e/100*n,s.progress.tooltip),s.progress.tooltip.style.left=n+"%",t&&-1!==["mouseenter","mouseleave"].indexOf(t.type)&&$(s.progress.tooltip).toggleClass(o,"mouseenter"===t.type)}}this.config=r,this.parentEl=t,this.timers={},this._scroll={x:0,y:0},this._saveScrollPosition=function(){o._scroll={x:window.pageXOffset||0,y:window.pageYOffset||0}},this._restoreScrollPosition=function(){window.scrollTo(o._scroll.x,o._scroll.y)},this._eventCheckTab=function(t){var e,i=b(t),n=e=(e=document.activeElement)&&e!==document.body?document.querySelector(":focus"):null;9===i&&function(t){for(var e in s.buttons){var i=s.buttons[e];$(i).each(function(e){$(this).toggleClass(r.classes.tabFocus,this===t)})}}(n)},this._eventHandleKey=function(t){var e,i=b(t),n="keydown"===t.type;if($.isNumeric(i)&&n){switch(-1!==[48,49,50,51,52,53,54,56,57,32,75,38,40,77,39,37,70,67].indexOf(i)&&(t.preventDefault(),t.stopPropagation()),i){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:e=s.media.duration,g.number(e)&&w(e/10*(i-48));break;case 32:case 75:p();break;case 38:M();break;case 40:E();break;case 77:A();break;case 39:f();break;case 37:d();break;case 70:j();break;case 67:I()}s.isFullscreen&&27===i&&j()}},this._setupMedia=function(){if($(o.container).removeClass(),$(o.container).addClass(r.selectors.container.replace(".","")),$(o.container).addClass(r.classes.type.replace("{0}",o.type)),$(o.container).toggleClass(r.classes.stopped,r.autoplay),$(o.container).toggleClass(r.classes.isIos,v.isIos),$(o.container).toggleClass(r.classes.isTouch,v.isTouch),"video"===o.type){var t=document.createElement("div");t.setAttribute("class",r.classes.videoWrapper),function(t,e){t.length||(t=[t]);for(var i=t.length-1;i>=0;i--){var n=i>0?e.cloneNode(!0):e,o=t[i],s=o.parentNode,r=o.nextSibling;return n.appendChild(o),r?s.insertBefore(n,r):s.appendChild(n),n}}(o.media,t),o.videoContainer=t}},this._setupInterface=function(){var t,e,b=!o.container.querySelectorAll(r.selectors.controls.wrapper).length;if(b){var y=(e=[],-1!==(t=r).controls.indexOf("play-large")&&e.push('<button type="button" data-btn="play" class="__play-large">','<svg><use xlink:href="#iws-play" /></svg>','<span class="c--tooltip">'+t.i18n.play+"</span>","</button>"),e.push("<div class="+t.selectors.controls.wrapper.replace(".","")+">"),-1!==t.controls.indexOf("restart")&&e.push('<button type="button" data-btn="restart">','<svg><use xlink:href="#iws-restart" /></svg>','<span class="c--tooltip">'+t.i18n.restart+"</span>","</button>"),-1!==t.controls.indexOf("rewind")&&e.push('<button type="button" data-btn="rewind">','<svg><use xlink:href="#iws-rewind" /></svg>','<span class="c--tooltip">'+t.i18n.rewind+"</span>","</button>"),-1!==t.controls.indexOf("play")&&e.push('<button type="button" data-btn="play">','<svg><use xlink:href="#iws-play" /></svg>','<span class="c--tooltip">'+t.i18n.play+"</span>","</button>",'<button type="button" data-btn="pause">','<svg><use xlink:href="#iws-pause" /></svg>','<span class="c--tooltip">'+t.i18n.pause+"</span>","</button>"),-1!==t.controls.indexOf("fast-forward")&&e.push('<button type="button" data-btn="fast-forward">','<svg><use xlink:href="#iws-fast-forward" /></svg>','<span class="c--tooltip">'+t.i18n.forward+"</span>","</button>"),-1!==t.controls.indexOf("progress")&&(e.push('<span class="__progress">','<label for="seek{id}" class="c--tooltip">Seek</label>','<input id="seek{id}" class="__progress--seek" type="range" min="0" max="100" step="0.1" value="0" data-btn="seek">','<progress class="__progress--played" max="100" value="0" role="presentation"></progress>','<progress class="__progress--buffer" max="100" value="0">',"<span>0</span>% "+t.i18n.buffered,"</progress>"),t.tooltips.seek&&e.push('<span class="c--tooltip">00:00</span>'),e.push("</span>")),-1!==t.controls.indexOf("current-time")&&e.push('<span class="__time">','<span class="c--tooltip">'+t.i18n.currentTime+"</span>",'<span class="__time--current">00:00</span>',"</span>"),-1!==t.controls.indexOf("duration")&&e.push('<span class="__time">','<span class="c--tooltip">'+t.i18n.duration+"</span>",'<span class="__time--duration">00:00</span>',"</span>"),-1!==t.controls.indexOf("mute")&&e.push('<button type="button" data-btn="mute">','<svg class="iconc--muted"><use xlink:href="#iws-muted" /></svg>','<svg><use xlink:href="#iws-volume" /></svg>','<span class="c--tooltip">'+t.i18n.toggleMute+"</span>","</button>"),-1!==t.controls.indexOf("volume")&&e.push('<span class="__volume">','<label for="volume{id}" class="c--tooltip">'+t.i18n.volume+"</label>",'<input id="volume{id}" class="plyr__volume--input" type="range" min="'+t.volumeMin+'" max="'+t.volumeMax+'" value="'+t.volume+'" data-btn="volume">','<progress class="__volume--display" max="'+t.volumeMax+'" value="'+t.volumeMin+'" role="presentation"></progress>',"</span>"),-1!==t.controls.indexOf("captions")&&e.push('<button type="button" data-btn="captions">','<svg class="icon--captions-on"><use xlink:href="#iws-captions-on" /></svg>','<svg><use xlink:href="#iws-captions-off" /></svg>','<span class="c--tooltip">'+t.i18n.toggleCaptions+"</span>","</button>"),-1!==t.controls.indexOf("fullscreen")&&e.push('<button type="button" data-btn="fullscreen">','<svg class="icon--exit-fullscreen"><use xlink:href="#iws-exit-fullscreen" /></svg>','<svg><use xlink:href="#iws-enter-fullscreen" /></svg>','<span class="c--tooltip">'+t.i18n.toggleFullscreen+"</span>","</button>"),e.push("</div>"),e.join(""));y=(y=y.replace(/{seektime}/g,r.seekTime)).replace(/{id}/g,Math.floor(1e4*Math.random())),o.container.insertAdjacentHTML("beforeend",y)}(function(){try{return s.controls=s.container.querySelector(r.selectors.controls.wrapper),s.buttons={},s.buttons.seek=s.container.querySelector(r.selectors.buttons.seek),s.buttons.play=s.container.querySelectorAll(r.selectors.buttons.play),s.buttons.pause=s.container.querySelector(r.selectors.buttons.pause),s.buttons.restart=s.container.querySelector(r.selectors.buttons.restart),s.buttons.rewind=s.container.querySelector(r.selectors.buttons.rewind),s.buttons.forward=s.container.querySelector(r.selectors.buttons.forward),s.buttons.fullscreen=s.container.querySelector(r.selectors.buttons.fullscreen),s.buttons.mute=s.container.querySelector(r.selectors.buttons.mute),s.buttons.captions=s.container.querySelector(r.selectors.buttons.captions),s.progress={},s.progress.container=s.container.querySelector(r.selectors.progress.container),s.progress.buffer={},s.progress.buffer.bar=s.container.querySelector(r.selectors.progress.buffer),s.progress.buffer.text=s.progress.buffer.bar&&s.progress.buffer.bar.getElementsByTagName("span")[0],s.progress.played=s.container.querySelector(r.selectors.progress.played),s.progress.tooltip=s.progress.container&&s.progress.container.querySelector("."+r.classes.tooltip),s.volume={},s.volume.input=s.container.querySelector(r.selectors.volume.input),s.volume.display=s.container.querySelector(r.selectors.volume.display),s.duration=s.container.querySelector(r.selectors.duration),s.currentTime=s.container.querySelector(r.selectors.currentTime),s.seekTime=s.container.querySelector(r.selectors.seekTime),!0}catch(t){return i("It looks like there is a problem with your controls HTML"),!1}})()&&("audio"===o.type&&$(s.controls).css("margin-top",(o.size.height-54)/2+"px"),b&&function(){function t(){var t=p(),e=s.buttons[t?"play":"pause"],i=s.buttons[t?"pause":"play"];if(i=i&&i.length>1?i[i.length-1]:i[0]){var n=$(e).hasClass(r.classes.tabFocus);setTimeout(function(){i.focus(),n&&($(e).toggleClass(r.classes.tabFocus,!1),$(i).toggleClass(r.classes.tabFocus,!0))},100)}}for(var e in s.buttons){var i=s.buttons[e];C(i,"blur",function(){$(i).toggleClass("tab-focus",!1)})}k(s.buttons.play,"click",t),k(s.buttons.pause,"click",t),k(s.buttons.restart,"click",w),k(s.buttons.rewind,"click",d),k(s.buttons.forward,"click",f),k(s.buttons.seek,"change",w),k(s.volume.input,"change",function(){T(s.volume.input.value)}),k(s.buttons.mute,"click",A),k(s.buttons.fullscreen,"click",j),C(document,m.fullScreenEventName,j),k(s.buttons.captions,"click",I),C(s.progress.container,"mouseenter mouseleave mousemove",F),r.hideControls&&(C(s.controls,"mouseenter mouseleave",function(t){s.controls.hover="mouseenter"===t.type}),C(s.controls,"mousedown mouseup touchstart touchend touchcancel",function(t){s.controls.pressed=-1!==["mousedown","touchstart"].indexOf(t.type)}),C(s.controls,"focus blur",o._toggleControls,!0));C(s.volume.input,"wheel",function(t){t.preventDefault();var e=t.webkitDirectionInvertedFromDevice,i=r.volumeStep/5;(t.deltaY<0||t.deltaX>0)&&(e?E(i):M(i)),(t.deltaY>0||t.deltaX<0)&&(e?M(i):E(i))})}(),function(){if(C(s.media,"timeupdate seeking",a),C(s.media,"durationchange loadedmetadata",c),C(s.media,"ended",function(){"video"===s.type&&r.showPosterOnEnd&&("video"===s.type&&S(),w(),s.media.load())}),C(s.media,"progress playing",l),C(s.media,"volumechange",O),C(s.media,"play pause ended",h),C(s.media,"waiting canplay seeked",u),r.clickToPlay&&"audio"!==s.type){var t=s.container.querySelector("."+r.classes.videoWrapper);if(!t)return;t.style.cursor="pointer",C(t,"click",function(){r.hideControls&&v.isTouch&&!s.media.paused||(s.media.paused?o._play():s.media.ended?(w(),o._play()):o._pause())})}r.disableContextMenu&&C(s.media,"contextmenu",function(t){t.preventDefault()});C(s.media,r.events.concat(["keyup","keydown"]).join(" "),function(t){n(s.container,t.type,!0)})}(),function(){if("audio"!==s.type||r.fullscreen.allowAudio){$(s.container).toggleClass(r.classes.fullscreen.enabled,!0)}}(),function(){if("video"!==s.type)return;s.container.querySelector(r.selectors.captions)||s.videoContainer.insertAdjacentHTML("afterbegin",'<div class="'+r.selectors.captions.replace(".","")+'"></div>');s.usingTextTracks=!1,s.media.textTracks&&(s.usingTextTracks=!0);for(var t,e="",n=s.media.childNodes,o=0;o<n.length;o++)"track"===n[o].nodeName.toLowerCase()&&("captions"!==(t=n[o].kind)&&"subtitles"!==t||(e=n[o].getAttribute("src")));if(s.captionExists=""!==e,function(){if(s.buttons.captions&&($(s.container).toggleClass(r.classes.captions.enabled,s.captionExists),s.captionExists)){var t=s.storage.captionsEnabled;g.boolean(t)||(t=r.captions.defaultActive),t&&$(s.container).toggleClass(r.classes.captions.active,!0)}}(),s.captionExists){for(var a=s.media.textTracks,l=0;l<a.length;l++)a[l].mode="hidden";if((v.isIE&&v.version>=10||v.isFirefox&&v.version>=31)&&(i("Detected browser with known TextTrack issues - using manual fallback"),s.usingTextTracks=!1),s.usingTextTracks){i("TextTracks supported");for(var h=0;h<a.length;h++){var c=a[h];"captions"!==c.kind&&"subtitles"!==c.kind||C(c,"cuechange",function(){this.activeCues[0]&&"text"in this.activeCues[0]?S(this.activeCues[0].getCueAsHTML()):S()})}}}}(),T(),O(),a(),h())},this._ready=function(){window.setTimeout(function(){n(o.media,"ready")},0),$(o.media).toggleClass(r.classes.setup,!0),$(o.container).toggleClass(r.classes.ready,!0),r.autoplay&&o._play()},this._setTitle=function(){var t=r.i18n.play;if(g.string(r.title)&&r.title.length&&(t+=", "+r.title,o.container.setAttribute("aria-label",r.title)),o.buttons.play)for(var e=o.buttons.play.length-1;e>=0;e--)o.buttons.play[e].setAttribute("aria-label",t)},this._cancelRequests=function(){if(-1!==r.types.html5.indexOf(o.type)&&o.media)for(var t=o.media.querySelectorAll("source"),e=0;e<t.length;e++)t[e].parentNode.removeChild(t[e])},this._setProgress=function(t,e){if(g.undefined(e)&&(e=0),g.undefined(t)){if(!o.progress||!o.progress.buffer)return;t=o.progress.buffer}g.htmlElement(t)?t.value=e:t&&(t.bar&&(t.bar.value=e),t.text&&(t.text.innerHTML=e))},this._play=function(){s.media&&"play"in s.media&&s.media.play()},this._pause=function(){s.media&&"pause"in s.media&&s.media.pause()},this._updateSeekDisplay=function(t){g.number(t)||(t=0);var e=x(t,_());o.progress&&o.progress.played&&(o.progress.played.value=e),o.buttons&&o.buttons.seek&&(o.buttons.seek.value=e)},this._toggleControls=function(t){if(s.media&&r.hideControls&&"audio"!==s.type){var e=0,i=!1,n=t,a=$(s.container).hasClass(r.classes.loading);if(g.boolean(t)||(t&&t.type?(i="enterfullscreen"===t.type,n=-1!==["mousemove","touchstart","mouseenter","focus"].indexOf(t.type),-1!==["mousemove","touchmove"].indexOf(t.type)&&(e=2e3),"focus"===t.type&&(e=3e3)):n=$(s.container).hasClass(r.classes.hideControls)),window.clearTimeout(o.timers.hover),n||s.media.paused||a){if($(s.container).toggleClass(r.classes.hideControls,!1),s.media.paused||a)return;v.isTouch&&(e=3e3)}n&&s.media.paused||(o.timers.hover=window.setTimeout(function(){(!s.controls.pressed&&!s.controls.hover||i)&&$(s.container).toggleClass(r.classes.hideControls,!0)},e))}},function(){if(o.init)return null;var t,e;o.storage={},r.storage.enabled&&(window.localStorage.removeItem("plyr-volume"),(t=window.localStorage.getItem(r.storage.key))&&(/^\d+(\.\d+)?$/.test(t)?P({volume:parseFloat(t)}):o.storage=JSON.parse(t))),o.container=iws.util.makeElement("div",{class:r.selectors.container.replace(".","")}),$(o.parentEl).append(((e=[]).push('<svg xmlns="http://www.w3.org/2000/svg" style="display:none;">'),e.push('<symbol id="iws-play" width="16" height="16" viewBox="0 0 16 16">','<path fill="#FFF" fill-rule="evenodd" d="M14.503 6.11L3.627.443C1.632-.596 0 .254 0 2.334v11.333c0 2.079 1.632 2.929 3.627 1.89L14.503 9.89c1.996-1.04 1.996-2.74 0-3.78"/>',"</symbol>"),e.push('<symbol id="iws-pause" width="16" height="16" viewBox="0 0 16 16">','<path fill="#FFF" fill-rule="evenodd" d="M2.667.019a2.667 2.667 0 0 1 2.666 2.667v10.647a2.667 2.667 0 1 1-5.333 0V2.686A2.667 2.667 0 0 1 2.667.019zM13.333 0A2.667 2.667 0 0 1 16 2.667v10.647a2.667 2.667 0 1 1-5.333 0V2.667A2.667 2.667 0 0 1 13.333 0z"/>',"</symbol>"),e.push('<symbol id="iws-enter-fullscreen" viewBox="0 0 16 16">','<path fill="#FFF" fill-rule="evenodd" d="M14.366 13.361h-2.322a1.32 1.32 0 1 0 0 2.639h3.608c.467 0 .878-.243 1.112-.61.152-.214.241-.476.241-.76v-3.608a1.32 1.32 0 1 0-2.639 0v2.34zM1.034 14.876a1.32 1.32 0 0 0 1.303 1.115h3.608a1.32 1.32 0 1 0 0-2.638H3.65V11.02a1.32 1.32 0 1 0-2.639 0v3.608c0 .084.008.167.024.248zM16.848.75A1.32 1.32 0 0 0 15.658 0H12.05a1.32 1.32 0 1 0 0 2.639h2.311v2.334a1.32 1.32 0 0 0 2.639 0V1.365c0-.222-.055-.43-.152-.614zM3.634 2.639H5.94A1.32 1.32 0 1 0 5.94 0H2.333a1.32 1.32 0 0 0-1.228.835c-.07.162-.11.34-.11.529v3.608a1.32 1.32 0 1 0 2.639 0V2.639z"/>',"</symbol>"),e.push('<symbol id="iws-exit-fullscreen" viewBox="0 0 16 16">','<g fill="none" fill-rule="evenodd">','<g fill="#FFF">','<path d="M-2.634 13.361h-2.322a1.32 1.32 0 1 0 0 2.639h3.608c.467 0 .878-.243 1.112-.61.152-.214.241-.476.241-.76v-3.608a1.32 1.32 0 1 0-2.639 0v2.34zm-13.332 1.515a1.32 1.32 0 0 0 1.303 1.115h3.608a1.32 1.32 0 1 0 0-2.638h-2.296V11.02a1.32 1.32 0 1 0-2.639 0v3.608c0 .084.008.167.024.248zM-.152.75A1.32 1.32 0 0 0-1.342 0H-4.95a1.32 1.32 0 1 0 0 2.639h2.311v2.334a1.32 1.32 0 0 0 2.639 0V1.365c0-.222-.055-.43-.152-.614zm-13.214 1.888h2.307a1.32 1.32 0 1 0 0-2.639h-3.608a1.32 1.32 0 0 0-1.228.835c-.07.162-.11.34-.11.529v3.608a1.32 1.32 0 1 0 2.639 0V2.639z"/>','<path d="M12.676 3.386V1.394a1.354 1.354 0 0 0-2.71 0V4.7c0 .203.046.396.126.569.206.485.687.825 1.247.825h3.307a1.354 1.354 0 0 0 0-2.71h-1.97zM5.38 5.89c.417-.231.7-.676.7-1.186V1.397a1.354 1.354 0 0 0-2.71 0v1.989H1.359a1.354 1.354 0 1 0 0 2.709h3.306c.264 0 .51-.076.717-.205zm4.387 4.698c-.045.134-.07.277-.07.426v3.612a1.333 1.333 0 0 0 2.665 0v-2.361h2.304a1.333 1.333 0 0 0 0-2.666h-3.611c-.617 0-1.137.42-1.288.989zM3.644 12.31v2.308a1.333 1.333 0 1 0 2.665 0v-3.612c0-.41-.185-.778-.477-1.022a1.328 1.328 0 0 0-.888-.339H1.333a1.333 1.333 0 1 0 0 2.665h2.311z"/>',"</g>","</g>","</symbol>"),e.push('<symbol id="iws-volume" viewBox="0 0 16 16">','<g fill="none" fill-rule="evenodd">','<path fill="#FFF" d="M2.407 5.084a.717.717 0 0 0-.306.551v.078H.357A.361.361 0 0 0 0 6.077v3.845c0 .2.16.364.357.364H2.1v.079c0 .2.138.448.306.55l3.85 2.354c.397.295.732.295.732-.1V2.984c0-.683-.564-.356-.733-.253L2.407 5.084zm8.565-.285a.939.939 0 0 0-1.345 0 .983.983 0 0 0 0 1.372c.99 1.008.99 2.65 0 3.658a.982.982 0 0 0 0 1.371.936.936 0 0 0 1.345 0c1.73-1.765 1.73-4.636 0-6.4m2.705-2.516a.938.938 0 0 0-1.345 0 .984.984 0 0 0 0 1.372A6.16 6.16 0 0 1 14.098 8a6.16 6.16 0 0 1-1.766 4.344.985.985 0 0 0 0 1.372.941.941 0 0 0 1.345 0A8.11 8.11 0 0 0 16 8c0-2.16-.825-4.19-2.323-5.716"/>',"</g>","</symbol>"),e.push('<symbol id="iws-muted" viewBox="0 0 16 16">','<g fill="none" fill-rule="evenodd">','<g fill="#FFF">','<path d="M2.658 4.887l-.277.17a.71.71 0 0 0-.302.545v.077H.353A.358.358 0 0 0 0 6.04V9.85c0 .199.158.36.353.36h1.726v.079c0 .198.136.443.302.546l3.808 2.332c.393.292.724.292.724-.1V7.98l1.927 1.4c-.088.133-.19.26-.306.38a.974.974 0 0 0 0 1.357.925.925 0 0 0 1.33 0c.19-.195.36-.404.51-.624l1.436 1.044c-.18.25-.381.49-.601.714a.977.977 0 0 0 0 1.36.93.93 0 0 0 1.33 0 8.08 8.08 0 0 0 .805-.96l1.192.867a.743.743 0 1 0 .874-1.202l-1.316-.957a8.123 8.123 0 0 0 .743-3.412c0-2.14-.816-4.152-2.297-5.664a.927.927 0 0 0-1.331 0 .976.976 0 0 0 0 1.359 6.11 6.11 0 0 1 1.747 4.305c0 .792-.147 1.56-.429 2.274l-1.529-1.11c.392-1.498.014-3.163-1.134-4.336a.927.927 0 0 0-1.33 0 .975.975 0 0 0 0 1.359 2.58 2.58 0 0 1 .732 1.717L6.913 6.141V2.974c0-.677-.558-.353-.724-.25l-2.16 1.322-2.621-1.905a.743.743 0 1 0-.874 1.202l2.124 1.544zM29.366 13.361h-2.322a1.32 1.32 0 1 0 0 2.639h3.608c.467 0 .878-.243 1.112-.61.152-.214.241-.476.241-.76v-3.608a1.32 1.32 0 1 0-2.639 0v2.34zm-13.332 1.515a1.32 1.32 0 0 0 1.303 1.115h3.608a1.32 1.32 0 1 0 0-2.638H18.65V11.02a1.32 1.32 0 1 0-2.639 0v3.608c0 .084.008.167.024.248zM31.848.75A1.32 1.32 0 0 0 30.658 0H27.05a1.32 1.32 0 1 0 0 2.639h2.311v2.334a1.32 1.32 0 0 0 2.639 0V1.365c0-.222-.055-.43-.152-.614zM18.634 2.639h2.307a1.32 1.32 0 1 0 0-2.639h-3.608a1.32 1.32 0 0 0-1.228.835c-.07.162-.11.34-.11.529v3.608a1.32 1.32 0 1 0 2.639 0V2.639z"/>',"</g>","</g>","</symbol>"),e.push('<symbol id="iws-restart" viewBox="0 0 16 16"> \x3c!-- 재실행 --\x3e','<g fill="none" fill-rule="evenodd">','<path fill="#FFF" d="M14.958 9.063l-4.722-.113a1 1 0 0 1-.73-1.657l2.418-2.771a1 1 0 0 1 1.535.033l2.304 2.884a1 1 0 0 1-.805 1.624z"/>','<path stroke="#FFF" stroke-linecap="round" stroke-width="3" d="M10.536 2.16a6.083 6.083 0 0 0-2.656-.608c-3.408 0-6.171 2.799-6.171 6.25C1.709 11.254 4.592 14 8 14c3.408 0 5-2.548 5-6"/>',"</g>","</symbol>"),e.push('<symbol id="iws-captions-off" viewBox="0 0 16 16">','<g fill="none" fill-rule="evenodd">','<path fill="#FFF" d="M2 3h12a2 2 0 0 1 2 2v6.077a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm7.667 10.077h3.69l-3.489 2.859a.5.5 0 0 1-.801-.51l.6-2.349zM2.005 8.375h1.323a.672.672 0 1 1 0 1.343H2.005a.672.672 0 1 1 0-1.343zm3.333 0h3.99a.672.672 0 1 1 0 1.343h-3.99a.672.672 0 0 1 0-1.343zm6 0h2.657a.672.672 0 1 1 0 1.343h-2.657a.672.672 0 0 1 0-1.343zM2.005 10.39h5.323a.672.672 0 1 1 0 1.344H2.005a.672.672 0 1 1 0-1.344zm7.333 0h1.99a.672.672 0 1 1 0 1.344h-1.99a.672.672 0 0 1 0-1.344z"/>','<path fill="#FFF" d="M1.537.452l14.084 14.12a.749.749 0 1 1-1.06 1.06L.477 1.513a.749.749 0 1 1 1.06-1.06z"/>',"</g>","</symbol>"),e.push('<symbol id="iws-captions-on" viewBox="0 0 16 16">','<g fill="none" fill-rule="evenodd">','<path fill="#FFF" d="M-13.333 4.925l-.26.16a.717.717 0 0 0-.306.55v.078h-1.744a.361.361 0 0 0-.357.364v3.845c0 .2.16.364.357.364h1.744v.079c0 .2.138.448.306.55l3.85 2.354c.397.295.732.295.732-.1V8.183l2.476 1.866a.983.983 0 0 0 .162 1.152.936.936 0 0 0 1.354-.01l1.426 1.075a6.24 6.24 0 0 1-.075.079.985.985 0 0 0 0 1.372.941.941 0 0 0 1.345 0c.093-.095.183-.191.27-.29l.584.44a.75.75 0 1 0 .903-1.198l-.596-.45A8.147 8.147 0 0 0 0 8c0-2.16-.825-4.19-2.323-5.716a.938.938 0 0 0-1.345 0 .984.984 0 0 0 0 1.372A6.16 6.16 0 0 1-1.902 8a6.197 6.197 0 0 1-.798 3.06l-1.464-1.103c.79-1.684.502-3.765-.864-5.158a.939.939 0 0 0-1.345 0 .983.983 0 0 0 0 1.372c.688.7.897 1.707.629 2.595l-3.267-2.462V2.983c0-.683-.564-.356-.733-.253l-2.213 1.354-2.527-1.904a.75.75 0 1 0-.903 1.198l2.054 1.547z"/>','<path fill="#FFF" d="M2 3h12a2 2 0 0 1 2 2v6.077a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm7.667 10.077h3.69l-3.489 2.859a.5.5 0 0 1-.801-.51l.6-2.349zM2.005 8.375h1.323a.672.672 0 1 1 0 1.343H2.005a.672.672 0 1 1 0-1.343zm3.333 0h3.99a.672.672 0 0 1 0 1.344h-3.99a.672.672 0 0 1 0-1.344zm6 0h2.657a.672.672 0 1 1 0 1.343h-2.657a.672.672 0 0 1 0-1.343zM2.005 10.39h5.323a.672.672 0 1 1 0 1.344H2.005a.672.672 0 1 1 0-1.344zm7.333 0h1.99a.672.672 0 1 1 0 1.344h-1.99a.672.672 0 0 1 0-1.344zM17.537.452l14.084 14.12a.749.749 0 1 1-1.06 1.06L16.477 1.513a.749.749 0 1 1 1.06-1.06z"/>',"</g>","</symbol>"),e.push('<symbol id="iws-fast-forward" viewBox="0 0 16 16"> \x3c!-- 다음으로 >> --\x3e','<g fill="none" fill-rule="evenodd">','<path fill="#FFF" d="M7 5.778L2.04 2.333C.918 1.553 0 2.19 0 3.75v8.499c0 1.56.918 2.197 2.04 1.417L7 10.222v2.028c0 1.56.918 2.197 2.04 1.417l6.118-4.25c1.123-.78 1.123-2.055 0-2.835L9.04 2.332C7.918 1.554 7 2.192 7 3.752v2.027z"/>',"</g>","</symbol>"),e.push('<symbol id="iws-rewind" viewBox="0 0 16 16"> \x3c!-- 이전으로 << --\x3e','<g fill="none" fill-rule="evenodd">','<path fill="#FFF" d="M-1.067 9.076l-4.723-.113a1 1 0 0 1-.73-1.657l2.418-2.772a1 1 0 0 1 1.535.033l2.305 2.885a1 1 0 0 1-.805 1.624z"/>','<path fill="#FFF" d="M9 5.778l4.96-3.445C15.082 1.553 16 2.19 16 3.75v8.499c0 1.56-.918 2.197-2.04 1.417L9 10.222v2.028c0 1.56-.918 2.197-2.04 1.417L.842 9.417c-1.123-.78-1.123-2.055 0-2.835l6.118-4.25C8.082 1.554 9 2.192 9 3.752v2.027z"/>',"</g>","</symbol>"),e.push("</svg>"),e.join(""))),$(o.parentEl).append(o.container),o.elErrorContainer=iws.util.makeElement("div",{class:"page-errorContainer w3-container"}),o.elErrorContainer.innerHTML='<div class="w3-panel w3-notice"><h3>알림!</h3><p>Message.</p></div>',o.parentEl.appendChild(o.elErrorContainer),o.container.setAttribute("tabindex",0),r.hideControls&&C(s.container,"mouseenter mouseleave mousemove touchstart touchend touchcancel touchmove enterfullscreen",o._toggleControls),C(s.container,"keydown keyup",o._eventHandleKey),C(window,"keyup",o._eventCheckTab),o.init=!0}()},iws.media.prototype.updateSource=function(t){if(g.object(t)&&"sources"in t){var e=this,n=this.config;$(this.container).toggleClass(n.classes.ready,!1),this._pause(),this._updateSeekDisplay(),this._setProgress(),this._cancelRequests(),clearTimeout(e.timers.cleanUp),function(){switch(e.container&&$(e.container).children().remove(),"type"in t&&(e.type=t.type),e.type){case"video":e.media=document.createElement("video");break;case"audio":e.media=document.createElement("audio");break;default:return void i("This format is not support.("+e.type+")")}e.resize(),$(e.elErrorContainer).css("display","none"),e.media.addEventListener("error",function(t){if(e.media){var i="";if(e.media.error&&e.media.error.code){var n={1:"MEDIA_ERR_ABORTED - fetching process aborted by user",2:"MEDIA_ERR_NETWORK - error occurred when downloading",3:"MEDIA_ERR_DECODE - error occurred when decoding",4:"MEDIA_ERR_SRC_NOT_SUPPORTED - audio/video not supported"}[e.media.error.code];n&&(i=n)}switch(console.log(">>>>   video open error. : "+i),e.clear(),e.type){case"video":$(e.elErrorContainer).find("p").text("일반 동영상 파일 입니다.");break;case"audio":$(e.elErrorContainer).find("p").text("일반 오디오 파일 입니다.")}$(e.elErrorContainer).css("display","inline-block")}},!0),e.container.insertBefore(e.media,e.container.firstChild),g.boolean(t.autoplay)&&(n.autoplay=t.autoplay),n.crossorigin&&e.media.setAttribute("crossorigin",""),n.autoplay&&e.media.setAttribute("autoplay",""),"poster"in t&&e.media.setAttribute("poster",t.poster),n.loop&&e.media.setAttribute("loop",""),o("source",t.sources),e._setupMedia(),"tracks"in t&&o("track",t.tracks),e.media.load(),e._setupInterface(),e._ready(),n.title=t.title,e._setTitle()}()}else i("Invalid source format");function o(t,i){if(g.string(i))w(t,e.media,{src:i});else if(i.constructor===Object)w(t,e.media,i);else if(i.constructor===Array)for(var n=i.length-1;n>=0;n--)w(t,e.media,i[n])}},iws.media.prototype.resize=function(t){var e=this;e.media&&("video"!=e.type&&"audio"!=e.type||(e.isFullscreen?(e.size=t||{width:e.container.clientWidth,height:e.container.clientHeight},$(e.media).css("width",e.size.width+"px"),$(e.media).css("height",e.size.height+"px")):(e.size=t||{width:e.parentEl.clientWidth,height:e.parentEl.clientHeight},$(e.media).css("width",e.size.width+"px"),$(e.media).css("height",e.size.height+"px"))))},iws.media.prototype.clear=function(){var t=this;clearTimeout(t.timers.cleanUp),t._pause(),t.container&&$(t.container).children().remove(),$(t.elErrorContainer).css("display","none"),t.media&&(t.media.src="",t.media.load(),delete t.media,t.media=null)},iws.media.prototype.destroy=function(){var t=this;t.clear(),t.init=!1,t.config.hideControls&&S(t.container,"mouseenter mouseleave mousemove touchstart touchend touchcancel touchmove enterfullscreen",t._toggleControls),S(t.container,"keydown keyup",t._eventHandleKey),S(window,"keyup",t._eventCheckTab),t.parentEl&&$(t.parentEl).children().remove(),$(t.elErrorContainer).remove(),i("Media destroyed!")}}("undefined"!=typeof exports&&exports),function(){"use strict";iws.PageAnnotation=iws.util.createInheritClass(function(){this.initialize.apply(this,arguments)},iws.Page,{defaultCursor:"default",moveCursor:"move",freeDrawingCursor:"crosshair",useAnnotation:!1,useMasking:!1,useFilter:!1,annotation:null,masking:null,authority:{annotation:"editable",masking:"editable"},initialize:function(t,e){this.callSuper("initialize",t,e),$(this.lowerCanvasEl).attr("tabindex","0"),this.notCreat_toolbar&&0!=this.notCreat_toolbar||(this.annotToolbar=new iws.toolbar.annotation(this),this.maskingToolbar=new iws.toolbar.masking(this)),this.annotation=new iws.PageAnnotation.annotation(this),this.masking=new iws.PageAnnotation.masking(this),this._initEvent(),this.visible("annotation",this.useAnnotation?"show":"hide"),this.visible("masking",this.useMasking?"show":"hide"),this.visible("filter",this.useFilter?"show":"hide")},_reSize:function(){this.callSuper("_reSize")},keydownControl:!1,_initEvent:function(){this.observe("page:zoom",this._eventPageZoom),this.observe("page:fitMode",this._eventPageZoom),this.observe("page:rotate",this._eventPageRotate),this.observe("page:move",this._eventPageMove),document.addEventListener("keydown",function(t){"Control"!==t.key||(this.keydownControl=!0)}.bind(this),!1),document.addEventListener("keyup",function(t){"Control"!==t.key||(this.keydownControl=!1)}.bind(this),!1)},_eventPageZoom:function(t){this.annotation&&this.annotation._annotations.getData().forEach(function(e){t.output&&e._objectSizeChangeScale(t.output.changeRate,t.output.offset,t.output.center)}.bind(this)),this.masking&&this.masking._maskings.getData().forEach(function(e){e._objectSizeChangeScale(t.output.changeRate,t.output.offset,t.output.center)})},_eventPageRotate:function(t){var e=t.input.angle,i=this.imageCtrl.getDrawCenter();this.annotation&&this.annotation._annotations.getData().forEach(function(t){t._rotate(e,i)}),this.masking&&this.masking._maskings.getData().forEach(function(t){t._rotate(e,i)})},_eventPageMove:function(t){var e=t.output.offset;this.annotation&&this.annotation._annotations.getData().forEach(function(t){t._moveOffset(e)}),this.masking&&this.masking._maskings.getData().forEach(function(t){t._moveOffset(e)})},clear:function(){this.annotation&&this.annotation._annotations.remove(),this.masking&&this.masking._maskings.remove(),this.callSuper("clear")},destroy:function(){this.clear(),this.annotToolbar&&this.annotToolbar.destroy(),this.maskingToolbar&&this.maskingToolbar.destroy(),this.annotation.destroy(),this.masking.destroy(),this.callSuper("destroy")},showAnnotation:function(t){this.fire("annotation:visible",t)},_enlivenObjects:function(t,e){var i=this,n=[];Object.keys(t).map(function(o,s){var r=t[o],a=iws.util.getKlass(r.type,null,"object");n[s]=a.fromObject(r),n[s]._set("canvas",i),e&&e(n[s],s)})},_renderCanvas:function(t){if(this._renderBefore(t),this.imageCtrl.render(t),this._renderMasking(t),this._drawMaskingControls(t),this._renderObjects(t),this._drawObjectsControls(t),this._renderTracking(t),iws.debug&&this.mousePoint){var e="mouse = "+this.mousePoint.x+", "+this.mousePoint.y;t.fillText(e,40,40)}this._renderAfter(t)},_renderTracking:function(t){this.callSuper("_renderTracking",t),this.fire("render:Tracking",t)},_renderObjects:function(t){t.save(),t.transform.apply(t,this.viewportTransform),this.imageCtrl.isValid()&&void 0===this.imageCtrl.xres&&console.log("need to get image resolution.");var e=this.imageCtrl.scale,i=this.imageCtrl.xres;this.authority&&"unvisible"!=this.authority.annotation&&this.annotation&&this.annotation._annotations.getData().forEach(function(n){n.render(t,void 0,e*(i/96))}),t.restore()},_drawObjectsControls:function(t){this.authority&&"unvisible"!=this.authority.annotation&&this.annotation&&this.annotation._annotations.getData().forEach(function(e){e.active&&e._renderControls(t)})},_renderMasking:function(t){t.save(),t.transform.apply(t,this.viewportTransform),this.authority&&"unvisible"!=this.authority.masking&&this.masking&&this.masking._maskings.getData().forEach(function(e){e.render(t)}),t.restore()},_drawMaskingControls:function(t){this.authority&&"unvisible"!=this.authority.masking&&this.masking&&this.masking._maskings.getData().forEach(function(e){e.active&&e._renderControls(t)})},_onMouseDown:function(t){this.fire("MouseDown_beforeCallSuper",t),this.callSuper("_onMouseDown",t),this.fire("MouseDown_afterCallSuper",t)},_onMouseMove:function(t){this.fire("MouseMove_beforeCallSuper",t),this.callSuper("_onMouseMove",t),this.fire("MouseMove_afterCallSuper",t)},_onMouseUp:function(t){this.fire("MouseUp_beforeCallSuper",t),this.callSuper("_onMouseUp",t),this.fire("MouseUp_afterCallSuper",t)},getAnnotation:function(){var t=[],e=this.imageCtrl.getBasicPoint();return this.annotation&&this.annotation._annotations.getData().forEach(function(i){var n=i.clone();n._objectSizeChangeScale(e.rate,{x:0,y:0},this.imageCtrl.getDrawCenter()),n._moveOffset({x:-e.x,y:-e.y}),t.push(n)}.bind(this)),t.filter(function(t){return!t.excludeFromExport}).map(function(t){return t.toObject(null)},this)},setAnnotation:function(t){this.annotation&&this.annotation._annotations._remove();var e=iws.util.clone(t);this._enlivenObjects(e,function(t,e){this.annotation&&this.annotation._annotations._add(t)}.bind(this));var i=this.imageCtrl.getBasicPoint();this.annotation&&this.annotation._annotations.getData().forEach(function(t){t._moveOffset(i),t._objectSizeChangeScale(this.imageCtrl.scale,{x:0,y:0},this.imageCtrl.getDrawCenter())}.bind(this)),this.renderAll()},addAnnotation:function(t){var e=this.imageCtrl.getBasicPoint();t._moveOffset(e),t._objectSizeChangeScale(this.imageCtrl.scale,{x:0,y:0},this.imageCtrl.getDrawCenter()),this.annotation&&this.annotation._annotations.add(t),this.renderAll()},removeAnnotation:function(){this.annotation&&this.annotation._annotations.remove(),this.renderAll()},getMasking:function(){var t=[],e=this.imageCtrl.getBasicPoint();return this.masking&&this.masking._maskings.getData().forEach(function(i){var n=i.clone();n._objectSizeChangeScale(e.rate,{x:0,y:0},this.imageCtrl.getDrawCenter()),n._moveOffset({x:-e.x,y:-e.y}),t.push(n)}.bind(this)),t.filter(function(t){return!t.excludeFromExport}).map(function(t){return t.toObject(null)},this)},setMasking:function(t){this.masking._maskings._remove();var e=iws.util.clone(t);this._enlivenObjects(e,function(t,e){t.setControlsVisibility({mtr:!1,mrdel:!1}),this.masking._maskings._add(t)}.bind(this));var i=this.imageCtrl.getBasicPoint();this.masking._maskings.getData().forEach(function(t){t._moveOffset(i),t._objectSizeChangeScale(this.imageCtrl.scale,{x:0,y:0},this.imageCtrl.getDrawCenter())}.bind(this)),this.renderAll()},addMasking:function(t,e,i,n,o){o=o||"#000";var s=new iws.objectRect({top:e,left:t,width:i,height:n,backgroundColor:o});s.setControlsVisibility({mtr:!1,mrdel:!1});var r=this.imageCtrl.getBasicPoint();s._moveOffset(r),s._objectSizeChangeScale(this.imageCtrl.scale,{x:0,y:0},this.imageCtrl.getDrawCenter()),this.masking._maskings.add(s),this.renderAll()},removeMasking:function(){this.masking&&this.masking._maskings.remove(),this.renderAll()}})}(),function(){var t=function(){this.initialize.apply(this,arguments)};t.prototype={annotationMap:["annotSelect","annotDrawFree","annotDrawLine","annotDrawArrowLine","annotDrawEllipse","annotDrawRect","annotDrawText","annotDrawCheckV","annotDrawCheckX","annotDrawStamp","annotDrawStamp2","annotDrawStamp3","annotDrawStamp4","annotDrawMarker"],_annotations:null,_mouseDownPoint:null,_copyAnnotation:[],initialize:function(){this.page=arguments[0];var t=this;this._annotations=function(){var e=[];function i(){e.push.apply(e,arguments)}function n(){var t=!1;if(0===arguments.length&&e.length>0)return e.splice(0,e.length),void(t=!0);for(var i=0,n=arguments.length;i<n;i++){var o=e.indexOf(arguments[i]);-1!==o&&(t=!0,e.splice(o,1))}return t}return{add:function(){i.apply(this,arguments),t.page.fire("object:added")},_add:function(){i.apply(this,arguments)},remove:function(){var e=n.apply(this,arguments);return e&&t.page.fire("object:removed"),e},_remove:function(){return n.apply(this,arguments)},getData:function(){return e}}}(),this.createObject=null,this._initialize_event()},destroy:function(){},isSelectMode:function(){return this.page.getTrackMode()===this.annotationMap[0]},setSelectMode:function(){this.page.setTrackMode(this.annotationMap[0])},isAnnotationMode:function(){if(this.page.authority&&"editable"!==this.page.authority.annotation)return!1;var t=this.page.getTrackMode();return this.annotationMap.indexOf(t)>=0},_initialize_event:function(){this.page.observe("MouseDown_afterCallSuper",function(t){this.isAnnotationMode()&&this.__onMouseDown_AnnotationControl(t)}.bind(this)),this.page.observe("MouseMove_afterCallSuper",function(t){this.isAnnotationMode()&&this.__onMouseMove_AnnotationControl(t)}.bind(this)),this.page.observe("MouseUp_beforeCallSuper",function(t){this.isAnnotationMode()&&this.__onMouseUp_AnnotationControl(t)}.bind(this)),this.page.observe("render:Tracking",function(t){if(this.isSelectMode()){var e=this.page;e.trackMouse.leftMouseButtonDown&&!this._currentTransform&&e.trackMouse.drawSelect(e.lowerCanvasEl,e.trackMouse.getRect(),"blue","blue")}}.bind(this)),$(this.page.lowerCanvasEl).keydown(function(t){if(console.log("keydown - lowerCanvasEl : "+t.keyCode),this.isSelectMode())if(46===t.which){var e=this._selectedObjects();e.length>0&&this._annotations.remove.apply(this._annotations,e),this.page.renderAll()}else if(65===t.which&&t.shiftKey)this._annotations.getData().forEach(function(t){t.set("active",!0)}),this.page.renderAll();else if(65===t.which&&t.ctrlKey)t.preventDefault(),this._annotations.getData().forEach(function(t){t.set("active",!0)}),this.page.renderAll();else if(67===t.which&&t.ctrlKey){t.preventDefault(),console.log("copy"),this._copyAnnotation.splice(0,this._copyAnnotation.length),(i=this._selectedObjects()).forEach(function(t){var e=t.clone();this._copyAnnotation.push(e)}.bind(this))}else if(88===t.which&&t.ctrlKey){var i;t.preventDefault(),console.log("cut"),this._copyAnnotation.splice(0,this._copyAnnotation.length),(i=this._selectedObjects()).forEach(function(t){var e=t.clone();this._copyAnnotation.push(e)}.bind(this)),i.length>0&&this._annotations.remove.apply(this._annotations,i),this.page.renderAll()}else if(86===t.which&&t.ctrlKey){if(t.preventDefault(),console.log("paste"),0==this._copyAnnotation.length)return;this.deActiveAll();var n=this._copyAnnotation[0],o=0;this._annotations.getData().filter(function(t){if(Math.round(n.left)==Math.round(t.left)&&Math.round(n.top)==Math.round(t.top)&&Math.round(n.width)==Math.round(t.width)&&Math.round(n.height)==Math.round(t.height))return t}).length>0&&(o=10),this._copyAnnotation.forEach(function(t){t._moveOffset({x:o,y:o});var e=t.clone();e.set("active",!0),this._add(e)}.bind(this)),this.page.fire("object:modified",{target:this._copyAnnotation}),this.page.renderAll()}}.bind(this))},__onMouseDown_AnnotationControl:function(t){t.preventDefault(),this.page.lowerCanvasEl.focus(),console.log("down : "+this.page.getTrackMode());var e=this.page.getPointer(t,!0);if(this.isSelectMode()){var i=iws.util.object._findTarget(e,this._annotations.getData());switch(i.find){case"contain":t.ctrlKey?!1===i.active?this._setActiveObject(i.target):(this._deActiveObject(i.target),1===this._selectedObjects().length&&this._setActiveObject(this._selectedObjects()[0])):!1===i.active&&(this.deActiveAll(),this._setActiveObject(i.target));case"corner":break;case"nothing":this.deActiveAll()}i.target&&(this._setupCurrentTransform(e,i.target),i.target.fire("mouseDown",t))}else{var n=this.page.annotToolbar.getInitParam(this.page.getTrackMode());switch(this.page.getTrackMode()){case"annotDrawFree":this.createObject=new iws.objectPath(n),this._add(this.createObject);break;case"annotDrawArrowLine":this.createObject=new iws.objectArrowLine(n),this._add(this.createObject);break;case"annotDrawLine":this.createObject=new iws.objectLine(n),this._add(this.createObject);break;case"annotDrawEllipse":this.createObject=new iws.objectEllipse(n),this._add(this.createObject);break;case"annotDrawRect":this.createObject=new iws.objectRect(n),this._add(this.createObject);break;case"annotDrawText":if(this._mouseDownPoint=e,0!=$(this.page.wrapperEl).find(".annotText").length)return void(this._mouseDownPoint=null);break;case"annotDrawCheckV":this.createObject=new iws.objectImageCheckV(n),this._add(this.createObject);break;case"annotDrawCheckX":this.createObject=new iws.objectImageCheckX(n),this._add(this.createObject);break;case"annotDrawStamp":case"annotDrawStamp2":case"annotDrawStamp3":case"annotDrawStamp4":this.createObject=new iws.objectStamp(n),this._add(this.createObject);break;case"annotDrawMarker":this.createObject=new iws.objectMarker(n),this._add(this.createObject)}this.deActiveAll(),this.createObject&&this.createObject._onCreateMouseDown(t)}this.page.renderAll()},__onMouseMove_AnnotationControl:function(t){var e=this.page.getPointer(t,!0);if(this.isSelectMode())if(this._currentTransform){var i=this._selectedObjects();i.length>1?(i.forEach(function(e){e._moveOffset(this.page.trackMouse.mousePrevMoveOffset),this.page.fire("object:moving",{target:e}),e.fire("mouseMove",t)}.bind(this)),this._currentTransform.actionPerformed=!0,this.page.renderAll()):(this._currentTransform.target.isMoving=!0,this.__performTransformAction(this._currentTransform,e),this._currentTransform.actionPerformed&&this.page.renderAll(),this._currentTransform.target.fire("mouseMove",t)),this._currentTransform.lastPointer=this.page.getPointer(t)}else{var n=iws.util.object._findTarget(e,this._annotations.getData());iws.util.object.setCursorFromEvent(e,n.target,function(t){this.page.setCursor(t)}.bind(this))}else if(this.createObject&&"annotDrawText"!==this.page.getTrackMode())this.page.setCursor(this.page.defaultCursor),this.createObject&&this.createObject._onCreateMouseMove(t),this.page.renderAll();else if("annotDrawText"==this.page.getTrackMode()&&0!==t.buttons&&this._mouseDownPoint){var o=this._mouseDownPoint;this.page.imageCtrl.tempRect={left:o.x,top:o.y,right:e.x,bottom:e.y},this.page.renderAll()}},__onMouseUp_AnnotationControl:function(t){if(console.log("up : "+this.page.getTrackMode()),this.isSelectMode())this._currentTransform?(this._finalizeCurrentTransform(),this._currentTransform.target.fire("mouseUp",t),this._currentTransform=null,this.page.renderAll()):this._collectObjects();else if(this.createObject)this.page.keydownControl||this.setSelectMode(),this.createObject._onCreateMouseUp(t),this._setActiveObject(this.createObject),this.page.fire("object:modified",{target:this.createObject}),this.createObject=null;else if("annotDrawText"==this.page.getTrackMode()&&null!==this._mouseDownPoint){this.page.annotToolbar.getInitParam("annotDrawText");var e=this._makeText(t);setTimeout(function(){e.select()},1),this._mouseDownPoint=null,this.page.imageCtrl.tempRect=null,this.page.renderAll()}},_add:function(t){t._set("canvas",this.page),t.setCoords(),this._annotations.add(t)},deActiveAll:function(){var t=[];return this._annotations.getData().forEach(function(e){e.get("active")&&(e.set("active",!1),e.fire("deselected"),t.push(e))}),this.page.fire("selection:cleared",{objects:t}),this},_selectedObjects:function(){for(var t=[],e=0;e<this._annotations.getData().length;e++)this._annotations.getData()[e].get("active")&&t.push(this._annotations.getData()[e]);return t},_deActiveObject:function(t,e){t.set("active",!1),t.fire("deselected"),(void 0===e||!0===e)&&this.page.fire("selection:cleared",{target:t,selecteds:this._selectedObjects()}),this.page.renderAll()},_setActiveObject:function(t,e){t.set("active",!0),t.fire("selected"),(void 0===e||!0===e)&&this.page.fire("object:selected",{target:t,selecteds:this._selectedObjects()}),this.page.renderAll()},_collectObjects:function(){for(var t,e=[],i=this.page.trackMouse.getLT(),n=this.page.trackMouse.getRB(),o=new iws.Point(i.x,i.y),s=new iws.Point(n.x,n.y),r=i.x===n.x&&i.y===n.y,a=this._annotations.getData().length;a--&&!((t=this._annotations.getData()[a])&&t.selectable&&t.visible&&t.isContainedWithinRect(o,s)&&(e.push(t),r)););e.forEach(function(t){t.set("active",!0)}),this.page.fire("object:selected",{target:1===e.length?e[0]:null,selecteds:this._selectedObjects()})},_makeText:function(t){var e="off";iws.config&&iws.config.annotation&&iws.config.annotation.textarea_wrap&&(e=iws.config.annotation.textarea_wrap);var i=this.page.getPointer(t),n=iws.util.Rect({left:this._mouseDownPoint.x,top:this._mouseDownPoint.y,right:i.x,bottom:i.y}).normal(),o=$('<textarea placeholder="Memo ... " class="annotText" ></textarea>');o.attr("wrap",e);var s={x:n.left,y:n.top},r=this.page.annotToolbar.getInitParam(this.page.getTrackMode());this.page.imageCtrl.xres=this.page.imageCtrl.xres<96?96:this.page.imageCtrl.xres;var a=this.page.imageCtrl.scale*(this.page.imageCtrl.xres/96),l=r.fontSize*a,h=Math.round(8*l),c=Math.round(3*l);n.width>40&&(h=n.width),n.height>20&&(c=n.height),o.css({left:s.x,top:s.y,width:h,height:c,"font-family":'"Jeju Gothic","Malgun Gothic","맑은 고딕",dotum,"돋움",sans-serif',"font-size":l+"px",color:r.fontColor,background:r.backgroundColor,position:"absolute","line-height":1.2,border:"0 none white",padding:0,outline:"none","IME-MODE":"active"}).appendTo($(this.page.pageContainer));var u=this;return o.on("focusout",function(t){if(""!=$(this).val()){r.left=s.x,r.top=s.y,r.width=o.width(),r.height=o.height(),u.createObject=new iws.objectText(r),u.createObject.text=$(this).val(),u._add(u.createObject),console.log("focusout"),u.page.fire("object:modified",{target:u.createObject});var e=u.createObject;u.createObject=null,u.setSelectMode(),setTimeout(function(){u._setActiveObject(e),u.page.renderAll()},100)}$(this).remove()}),"off"==e&&o.on("input",function(){o[0].scrollHeight>o.height()&&o.css({"overflow-y":"hidden"}).height(o[0].scrollHeight),o[0].scrollWidth>o.width()&&o.css({"overflow-x":"hidden"}).width(o[0].scrollWidth)}),o.on("keydown",function(t){27==t.keyCode&&""==$(this).val()&&(u.setSelectMode(),$(this).remove())}),o}},iws.util.extend(t.prototype,iws.Observable),iws.PageAnnotation.annotation=t,iws.util.extend(iws.PageAnnotation.annotation.prototype,{_finalizeCurrentTransform:function(){var t=this._currentTransform,e=t.target;e._scaling&&(e._scaling=!1),e.isMoving&&(e.isMoving=!1),e.setCoords(),this._previousOriginX&&this._previousOriginY&&(e.restoreOriginXY(this._previousOriginX,this._previousOriginY),this._previousOriginX=null,this._previousOriginY=null),t.actionPerformed&&(this.page.fire("object:modified",{target:e}),e.fire("modified"))},__performTransformAction:function(t,e){var i=e.x,n=e.y,o=t.target,s=t.action,r=!1;"rotate"===s?(r=this.__rotateObject(i,n))&&this.fire("object:rotating",{target:o}):"scale"===s?(r=this.__onScale(t,i,n))&&this.fire("object:scaling",{target:o}):"scaleX"===s?(r=this.__scaleObject(i,n,"x"))&&this.fire("object:scaling",{target:o}):"scaleY"===s?(r=this.__scaleObject(i,n,"y"))&&this.fire("object:scaling",{target:o}):"drag"===s&&(r=this.__translateObject(i,n))&&(this.page.renderAll(),this.page.fire("object:moving",{target:o}),this.page.setCursor(o.moveCursor||this.moveCursor)),t.actionPerformed=r},__rotateObject:function(t,e){var i=this._currentTransform;if(i.target.get("lockRotation"))return!1;var n=Math.atan2(i.ey-i.top,i.ex-i.left),o=Math.atan2(e-i.top,t-i.left),s=iws.util.radiansToDegrees(o-n+i.theta);return s<0&&(s=360+s),i.target.angle=s%360,!0},__translateObject:function(t,e){var i=this._currentTransform;return i.target.translateOffset(t,e,i.offsetX,i.offsetY,i.lastPointer)},__onScale:function(t,e,i){return"scale"===t.currentAction&&this._resetCurrentTransform(),t.currentAction="scaleEqually",this.__scaleObject(e,i,"equally")},__scaleObject:function(t,e,i){var n=this._currentTransform,o=n.target,s=o.get("lockScalingX"),r=o.get("lockScalingY"),a=o.get("lockScalingFlip");if(s&&r)return!1;var l=o.translateToOriginPoint(o.getCenterPoint(),n.originX,n.originY),h=o.toLocalPoint(new iws.Point(t,e),n.originX,n.originY),c=o._getTransformedDimensions(),u=!1;iws.util.object.__setLocalMouse(h,n);var p=o.getCenterPoint();if(o instanceof iws.objectText){if("x"==i||"equally"==i){var d=o.width*(h.x/o.scaleX/(o.width+o.strokeWidth));d>=o.getMinWidth()&&(o.set("width",d),u=!0)}if("y"==i||"equally"==i){var f=o.height*(h.y/o.scaleY/(o.height+o.strokeWidth));f>=o._getTextHeight()&&(o.set("height",f),u=!0)}}else o instanceof iws.objectLine||o instanceof iws.objectArrowLine?(o._cornerMove(t,e),u=!0):u=this.__setObjectScale(h,n,s,r,i,a,c);return o.setPositionByOrigin(l,n.originX,n.originY,p),u},__setObjectScale:function(t,e,i,n,o,s,r){var a,l,h,c,u=e.target,p=!1,d=!1,f=!1;return h=t.x*u.scaleX/r.x,c=t.y*u.scaleY/r.y,a=u.scaleX!==h,l=u.scaleY!==c,s&&h<=0&&h<u.scaleX&&(p=!0),s&&c<=0&&c<u.scaleY&&(d=!0),"equally"!==o||i||n?o?"x"!==o||u.get("lockUniScaling")?"y"!==o||u.get("lockUniScaling")||d||n||u.set("scaleY",c)&&(f=f||l):p||i||u.set("scaleX",h)&&(f=f||a):(p||i||u.set("scaleX",h)&&(f=f||a),d||n||u.set("scaleY",c)&&(f=f||l)):p||d||(f=this.__scaleObjectEqually(t,u,e,r)),e.newScaleX=h,e.newScaleY=c,p||d||this.__flipObject(e,o),f},__scaleObjectEqually:function(t,e,i,n){var o,s=t.y+t.x,r=n.y*i.original.scaleY/e.scaleY+n.x*i.original.scaleX/e.scaleX;return i.newScaleX=i.original.scaleX*s/r,i.newScaleY=i.original.scaleY*s/r,o=i.newScaleX!==e.scaleX||i.newScaleY!==e.scaleY,e.set("scaleX",i.newScaleX),e.set("scaleY",i.newScaleY),o},__flipObject:function(t,e){t.newScaleX<0&&"y"!==e&&("left"===t.originX?t.originX="right":"right"===t.originX&&(t.originX="left")),t.newScaleY<0&&"x"!==e&&("top"===t.originY?t.originY="bottom":"bottom"===t.originY&&(t.originY="top"))},_setupCurrentTransform:function(t,e){var i=e._findTargetCorner(t),n=iws.util.object._getActionFromCorner(e,i),o=iws.util.object._getOriginFromCorner(e,i);this._currentTransform={target:e,action:n,corner:i,scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,offsetX:t.x-e.left,offsetY:t.y-e.top,originX:o.x,originY:o.y,ex:t.x,ey:t.y,lastX:t.x,lastY:t.y,left:e.left,top:e.top,theta:iws.util.degreesToRadians(e.angle),width:e.width*e.scaleX,mouseXSign:1,mouseYSign:1,lastPointer:{x:t.x,y:t.y}},this._currentTransform.original={left:e.left,top:e.top,scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,originX:o.x,originY:o.y},this._resetCurrentTransform()},_resetCurrentTransform:function(){var t=this._currentTransform;this._shouldCenterTransform(t.target)?"rotate"===t.action?this._setOriginToCenter(t.target):("center"!==t.originX&&("right"===t.originX?t.mouseXSign=-1:t.mouseXSign=1),"center"!==t.originY&&("bottom"===t.originY?t.mouseYSign=-1:t.mouseYSign=1),t.originX="center",t.originY="center"):(t.originX=t.original.originX,t.originY=t.original.originY)},_setOriginToCenter:function(t){this._previousOriginX=this._currentTransform.target.originX,this._previousOriginY=this._currentTransform.target.originY;var e=t.getCenterPoint();t.originX="center",t.originY="center",t.left=e.x,t.top=e.y,this._currentTransform.left=t.left,this._currentTransform.top=t.top},_shouldCenterTransform:function(t){var e,i=this._currentTransform;return"scale"===i.action||"scaleX"===i.action||"scaleY"===i.action?e=this.centeredScaling||t.centeredScaling:"rotate"===i.action&&(e=this.centeredRotation||t.centeredRotation),e?!i.altKey:i.altKey}})}(),function(){var t=function(){this.initialize.apply(this,arguments)};t.prototype={maskingMap:["maskingSelect","maskingBlack","maskingRed"],_maskings:null,_copyMaskings:[],initialize:function(){this.page=arguments[0];var t=this;this._maskings=function(){var e=[];function i(){e.push.apply(e,arguments)}function n(){var t=!1;if(0===arguments.length&&e.length>0)return e.splice(0,e.length),void(t=!0);for(var i=0,n=arguments.length;i<n;i++){var o=e.indexOf(arguments[i]);-1!==o&&(t=!0,e.splice(o,1))}return t}return{add:function(){i.apply(this,arguments),t.page.fire("masking:added")},_add:function(){i.apply(this,arguments)},remove:function(){var e=n.apply(this,arguments);return e&&t.page.fire("masking:removed"),e},_remove:function(){return n.apply(this,arguments)},getData:function(){return e}}}(),this.createObject=null,this._initialize_event()},destroy:function(){},isSelectMode:function(){return this.page.getTrackMode()===this.maskingMap[0]},setSelectMode:function(){this.page.setTrackMode(this.maskingMap[0])},isMaskingMode:function(){if(this.page.authority&&"editable"!==this.page.authority.masking)return!1;var t=this.page.getTrackMode();return this.maskingMap.indexOf(t)>=0},_initialize_event:function(){this.page.observe("MouseDown_afterCallSuper",function(t){this.isMaskingMode()&&this.__onMouseDown(t)}.bind(this)),this.page.observe("MouseMove_afterCallSuper",function(t){this.isMaskingMode()&&this.__onMouseMove(t)}.bind(this)),this.page.observe("MouseUp_beforeCallSuper",function(t){this.isMaskingMode()&&this.__onMouseUp(t)}.bind(this)),this.page.observe("render:Tracking",function(t){if(this.isSelectMode()){var e=this.page;e.trackMouse.leftMouseButtonDown&&!this._currentTransform&&e.trackMouse.drawSelect(e.lowerCanvasEl,e.trackMouse.getRect(),"black","black")}}.bind(this)),$(this.page.lowerCanvasEl).keydown(function(t){if(this.isSelectMode())if(46===t.which){var e=this._selectedObjects();e.length>0&&this._maskings.remove.apply(this._maskings,e),this.page.renderAll()}else if(65===t.which&&t.shiftKey)this._maskings.getData().forEach(function(t){t.set("active",!0)}),this.page.renderAll();else if(65===t.which&&t.ctrlKey)t.preventDefault(),this._maskings.getData().forEach(function(t){t.set("active",!0)}),this.page.renderAll();else if(67===t.which&&t.ctrlKey){t.preventDefault(),console.log("copy"),this._copyMaskings.splice(0,this._copyMaskings.length),(i=this._selectedObjects()).forEach(function(t){var e=t.clone();this._copyMaskings.push(e)}.bind(this))}else if(88===t.which&&t.ctrlKey){var i;t.preventDefault(),console.log("cut"),this._copyMaskings.splice(0,this._copyMaskings.length),(i=this._selectedObjects()).forEach(function(t){var e=t.clone();this._copyMaskings.push(e)}.bind(this)),i.length>0&&this._maskings.remove.apply(this._maskings,i),this.page.renderAll()}else if(86===t.which&&t.ctrlKey){if(t.preventDefault(),console.log("paste"),0==this._copyMaskings.length)return;this.deActiveAll();var n=this._copyMaskings[0],o=0;this._maskings.getData().filter(function(t){if(Math.round(n.left)==Math.round(t.left)&&Math.round(n.top)==Math.round(t.top)&&Math.round(n.width)==Math.round(t.width)&&Math.round(n.height)==Math.round(t.height))return t}).length>0&&(o=10),this._copyMaskings.forEach(function(t){t._moveOffset({x:o,y:o});var e=t.clone();e.set("active",!0),this._maskings.add(e)}.bind(this)),this.page.fire("masking:modified",{target:this._copyMaskings}),this.page.renderAll()}}.bind(this))},deActiveAll:function(){this._maskings.getData().forEach(function(t){t.set("active",!1)})},_setupCurrentTransform:function(t,e){var i=e._findTargetCorner(t),n=iws.util.object._getActionFromCorner(e,i),o=iws.util.object._getOriginFromCorner(e,i);this._currentTransform={target:e,action:n,corner:i,scaleX:e.scaleX,scaleY:e.scaleY,offsetX:t.x-e.left,offsetY:t.y-e.top,originX:o.x,originY:o.y,ex:t.x,ey:t.y,lastX:t.x,lastY:t.y,left:e.left,top:e.top,theta:iws.util.degreesToRadians(e.angle),width:e.width*e.scaleX,mouseXSign:1,mouseYSign:1,lastPointer:{x:t.x,y:t.y}},this._currentTransform.original={left:e.left,top:e.top,scaleX:e.scaleX,scaleY:e.scaleY,originX:o.x,originY:o.y}},_finalizeCurrentTransform:function(){var t=this._currentTransform;t.target._scaling&&(t.target._scaling=!1),t.target.setCoords(),t.actionPerformed&&this.page.fire("masking:modified",{target:t.target})},_add:function(t){function e(t){this.createObject=new iws.objectRect({backgroundColor:t}),this.createObject.setControlsVisibility({mtr:!1,mrdel:!1}),this.createObject._set("canvas",this.page),this._maskings.add(this.createObject)}switch(t){case"maskingBlack":e.call(this,"black");break;case"maskingRed":e.call(this,"red")}},__onMouseDown:function(t){if(t.preventDefault(),this.page.lowerCanvasEl.focus(),this.isSelectMode()){var e=this.page.getPointer(t,!0),i=iws.util.object._findTarget(e,this._maskings.getData());switch(i.find){case"contain":t.ctrlKey?i.target.set("active",!i.active):!1===i.active&&(this.deActiveAll(),i.target.set("active",!0));case"corner":break;case"nothing":this.deActiveAll()}i.target&&(this._setupCurrentTransform(e,i.target),i.target.fire("mouseDown",t))}else this.deActiveAll(),this._add(this.page.getTrackMode()),this.createObject&&this.createObject._onCreateMouseDown(t);this.page.renderAll()},__onMouseMove:function(t){if(this.isSelectMode()){var e=this.page.getPointer(t,!0);if(this._currentTransform){var i=this._selectedObjects();i.length>1?(i.forEach(function(e){e._moveOffset(this.page.trackMouse.mousePrevMoveOffset),this.page.fire("masking:moving",{target:e}),e.fire("mouseMove",t)}.bind(this)),this._currentTransform.actionPerformed=!0,this.page.renderAll()):(this.__performTransformAction(this._currentTransform,e),this._currentTransform.actionPerformed&&this.page.renderAll(),this._currentTransform.target.fire("mouseMove",t)),this._currentTransform.lastPointer=e}else{var n=iws.util.object._findTarget(e,this._maskings.getData());iws.util.object.setCursorFromEvent(e,n.target,function(t){this.page.setCursor(t)}.bind(this))}}else this.page.setCursor(this.page.defaultCursor),this.createObject&&this.createObject._onCreateMouseMove(t),this.page.renderAll()},__onMouseUp:function(t){this.isSelectMode()?this._currentTransform?(this._finalizeCurrentTransform(),this._currentTransform.target.fire("mouseUp",t),this._currentTransform=null,this.page.renderAll()):this._collectObjects():this.createObject&&(this.page.keydownControl||this.setSelectMode(),this.createObject.set("active",!0),this.createObject._onCreateMouseUp(t),this.page.fire("masking:modified",{target:this.createObject}),this.createObject=null)},_selectedObjects:function(){for(var t=[],e=0;e<this._maskings.getData().length;e++)this._maskings.getData()[e].get("active")&&t.push(this._maskings.getData()[e]);return t},_collectObjects:function(){for(var t,e=[],i=this.page.trackMouse.getLT(),n=this.page.trackMouse.getRB(),o=new iws.Point(i.x,i.y),s=new iws.Point(n.x,n.y),r=i.x===n.x&&i.y===n.y,a=this._maskings.getData().length;a--&&!((t=this._maskings.getData()[a])&&t.selectable&&t.visible&&t.isContainedWithinRect(o,s)&&(e.push(t),r)););e.forEach(function(t){t.set("active",!0)})},__performTransformAction:function(t,e){var i=e.x,n=e.y,o=t.target,s=t.action,r=!1;"scale"===s?(r=this.__onScale(t,i,n))&&this.page.fire("masking:scaling",{target:o}):"scaleX"===s?(r=this.__scaleObject(t,i,n,"x"))&&this.page.fire("masking:scaling",{target:o}):"scaleY"===s?(r=this.__scaleObject(t,i,n,"y"))&&this.page.fire("masking:scaling",{target:o}):"drag"===s&&(r=o.translateOffset(i,n,t.offsetX,t.offsetY,t.lastPointer))&&this.page.fire("masking:moving",{target:o}),t.actionPerformed=r},__onScale:function(t,e,i){return t.target.get("lockUniScaling")?("scale"===t.currentAction&&this._resetCurrentTransform(),t.currentAction="scaleEqually",this.__scaleObject(t,e,i,"equally")):(t.currentAction="scale",this.__scaleObject(t,e,i))},__scaleObject:function(t,e,i,n){var o,s=t.target,r=s.translateToOriginPoint(s.getCenterPoint(),t.originX,t.originY),a=s.toLocalPoint(new iws.Point(e,i),t.originX,t.originY),l=s._getTransformedDimensions();iws.util.object.__setLocalMouse(a,t);var h=s.getCenterPoint();return o=this.__setObjectScale(a,t,n,l),s.setPositionByOrigin(r,t.originX,t.originY,h),o},__setObjectScale:function(t,e,i,n){var o,s,r,a,l=e.target,h=!1;return r=t.x*l.scaleX/n.x,a=t.y*l.scaleY/n.y,o=l.scaleX!==r,s=l.scaleY!==a,"equally"===i?h=this.__scaleObjectEqually(t,l,e,n):i?"x"!==i||l.get("lockUniScaling")?"y"!==i||l.get("lockUniScaling")||l.set("scaleY",a)&&(h=h||s):l.set("scaleX",r)&&(h=h||o):(l.set("scaleX",r)&&(h=h||o),l.set("scaleY",a)&&(h=h||s)),e.newScaleX=r,e.newScaleY=a,this.__flipObject(e,i),h},__scaleObjectEqually:function(t,e,i,n){var o,s=t.y+t.x,r=n.y*i.original.scaleY/e.scaleY+n.x*i.original.scaleX/e.scaleX;return i.newScaleX=i.original.scaleX*s/r,i.newScaleY=i.original.scaleY*s/r,o=i.newScaleX!==e.scaleX||i.newScaleY!==e.scaleY,e.set("scaleX",i.newScaleX),e.set("scaleY",i.newScaleY),o},__flipObject:function(t,e){t.newScaleX<0&&"y"!==e&&("left"===t.originX?t.originX="right":"right"===t.originX&&(t.originX="left")),t.newScaleY<0&&"x"!==e&&("top"===t.originY?t.originY="bottom":"bottom"===t.originY&&(t.originY="top"))}},iws.util.extend(t.prototype,iws.Observable),iws.PageAnnotation.masking=t}(),function(){var t,e,i,n,o,s;iws.util.object={setCursorFromEvent:(t="default",e="move",i="crosshair",n={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},o=["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],s=function(t,e){var i=Math.round(e.get("angle")%360/45);return i<0&&(i+=8),i+=n[t],o[i%=8]},function(o,r,a){if(!r)return a&&a(t),!1;var l=r.hoverCursor||e;if(r.selectable){var h=r._findTargetCorner&&r._findTargetCorner(o);h?function(e,o,r){if(e in n)r&&r(s(e,o));else{if("mtr"!==e||!o.hasRotatingPoint)return r&&r(t),!1;r&&r(i)}}(h,r,a):a&&a(l)}else a&&a(l);return!0}),_findTarget:function(t,e){for(var i={find:"nothing",active:!1,target:null},n=e.length-1;n>=0;n--){var o=e[n];if(!0===o.get("active")?i.active=!0:i.active=!1,o._findTargetCorner(t))return i.find="corner",i.target=o,i;if(o.containsPoint(t))return i.find="contain",i.target=o,i}return i},_getActionFromCorner:function(t,e){if(!e)return"drag";switch(e){case"mrdel":return"delete";case"mtr":return"rotate";case"ml":case"mr":return"scaleX";case"mt":case"mb":return"scaleY";default:return"scale"}},_getOriginFromCorner:function(t,e){var i={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?i.x="right":"mr"!==e&&"tr"!==e&&"br"!==e||(i.x="left"),"tl"===e||"mt"===e||"tr"===e?i.y="bottom":"bl"!==e&&"mb"!==e&&"br"!==e||(i.y="top"),i},__setLocalMouse:function(t,e){var i=e.target;"right"===e.originX?t.x*=-1:"center"===e.originX&&(t.x*=2*e.mouseXSign,t.x<0&&(e.mouseXSign=-e.mouseXSign)),"bottom"===e.originY?t.y*=-1:"center"===e.originY&&(t.y*=2*e.mouseYSign,t.y<0&&(e.mouseYSign=-e.mouseYSign)),Math.abs(t.x)>i.padding?t.x<0?t.x+=i.padding:t.x-=i.padding:t.x=0,Math.abs(t.y)>i.padding?t.y<0?t.y+=i.padding:t.y-=i.padding:t.y=0}}}(),function(){iws.Object=iws.util.createInheritClass(function(){this.initialize.apply(this,arguments)},iws.Observable,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,delIconSize:20,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",borderDashArray:null,cornerColor:"rgba(102,153,255,0.5)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,deletePointOffset:20,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor skewX skewY".split(" "),imgDelete:null,initialize:function(t){t&&this.setOptions(t)},_initGradient:function(t){!t.fill||!t.fill.colorStops||t.fill instanceof iws.Gradient||this.set("fill",new iws.Gradient(t.fill)),!t.stroke||!t.stroke.colorStops||t.stroke instanceof iws.Gradient||this.set("stroke",new iws.Gradient(t.stroke))},_initPattern:function(t){!t.fill||!t.fill.source||t.fill instanceof iws.Pattern||this.set("fill",new iws.Pattern(t.fill)),!t.stroke||!t.stroke.source||t.stroke instanceof iws.Pattern||this.set("stroke",new iws.Pattern(t.stroke))},_initClipping:function(t){if(t.clipTo&&"string"==typeof t.clipTo){var e=iws.util.getFunctionBody(t.clipTo);void 0!==e&&(this.clipTo=new Function("ctx",e))}},setOptions:function(t){for(var e in t)this.set(e,t[e]);this._initGradient(t),this._initPattern(t),this._initClipping(t)},toObject:function(t){var e={type:this.type,left:parseFloat(Number(this.left).toFixed(2)),top:parseFloat(Number(this.top).toFixed(2)),width:parseFloat(Number(this.width).toFixed(2)),height:parseFloat(Number(this.height).toFixed(2)),stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:parseFloat(Number(this.strokeWidth).toFixed(2)),scaleX:parseFloat(Number(this.scaleX).toFixed(2)),scaleY:parseFloat(Number(this.scaleY).toFixed(2)),angle:parseFloat(Number(this.angle).toFixed(2)),opacity:parseFloat(Number(this.opacity).toFixed(2)),visible:this.visible};return iws.util.populateWithProperties(this,e,t),e},toDatalessObject:function(t){return this.toObject(t)},toString:function(){return"#<iws."+iws.util.string.capitalize(this.type)+">"},get:function(t){return this[t]},getObjectScaling:function(){var t=this.scaleX,e=this.scaleY;if(this.group){var i=this.group.getObjectScaling();t*=i.scaleX,e*=i.scaleY}return{scaleX:t,scaleY:e}},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"==typeof t?this._setObject(t):"function"==typeof e&&"clipTo"!==t?this._set(t,e(this.get(t))):this._set(t,e),this},_set:function(t,e){return("scaleX"===t||"scaleY"===t)&&(e=this._constrainScale(e)),"scaleX"===t&&e<0?(this.flipX=!this.flipX,e*=-1):"scaleY"===t&&e<0&&(this.flipY=!this.flipY,e*=-1),this[t]=e,"width"!==t&&"height"!==t||(this.minScaleLimit=Math.min(.1,1/Math.max(this.width,this.height))),this},translateOffset:function(t,e,i,n){var o=t-i,s=e-n,r=!this.get("lockMovementX")&&this.left!==o,a=!this.get("lockMovementY")&&this.top!==s;return r&&this.set("left",o),a&&this.set("top",s),r||a},setOnGroup:function(){},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},setSourcePath:function(t){return this.sourcePath=t,this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},transform:function(t,e){var i=e?this._getLeftTopCoords():this.getCenterPoint();if(iws.debug){t.save(),t.textBaseline="alphabetic",t.font="14px sans-serif";var n="scale="+(this.scaleX*(this.flipX?-1:1)).toFixed(2)+", "+(this.scaleY*(this.flipY?-1:1)).toFixed(2),o=t.measureText(" ").width;t.fillText(n,this.left+this.width,this.top+this.height+o),t.restore()}t.translate(i.x,i.y),t.rotate(iws.util.degreesToRadians(this.angle));var s=this.scaleX*(this.flipX?-1:1),r=this.scaleY*(this.flipY?-1:1);t.scale(s,r);var a=Math.tan(iws.util.degreesToRadians(this.skewX)),l=Math.tan(iws.util.degreesToRadians(this.skewY));t.transform(1,0,a,1,0,0),t.transform(1,l,0,1,0,0)},render:function(t,e,i){if(this.visible&&(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),e||this.transform(t),this._setOpacity(t),this._setShadow(t),this._setStrokeStyles(t,i),this._setFillStyles(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this._render(t,e,i),t.restore(),t.save(),this.drawDelete(t),t.restore(),iws.debug)){t.save(),t.textBaseline="alphabetic",t.font="14px sans-serif";var n="("+this.left.toFixed(2)+", "+this.top.toFixed(2)+", "+this.width.toFixed(2)+", "+this.height.toFixed(2)+")";t.fillText(n,this.left,this.top);var o="c="+this.getCenterPoint().x.toFixed(2)+", "+this.getCenterPoint().y.toFixed(2);t.fillText(o,this.getCenterPoint().x,this.getCenterPoint().y),t.restore()}},_renderBackground:function(t){this.backgroundColor&&(t.fillStyle=this.backgroundColor,t.fillRect(-this.width/2,-this.height/2,this.width,this.height),this._removeShadow(t))},_setOpacity:function(t){this.group&&this.group._setOpacity(t),t.globalAlpha*=this.opacity},_setStrokeStyles:function(t,e){if(this.stroke){var i=1;iws.config&&iws.config.annotation&&"scale"==iws.config.annotation.line&&!isNaN(e)&&(i=e),t.lineWidth=this.strokeWidth*i,t.lineCap=this.strokeLineCap,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,t.strokeStyle=this.stroke.toLive?this.stroke.toLive(t,this):this.stroke}},_setFillStyles:function(t){this.fill&&(t.fillStyle=this.fill.toLive?this.fill.toLive(t,this):this.fill)},_setLineDash:function(t,e,i){e&&(1&e.length&&e.push.apply(e,e),supportsLineDash?t.setLineDash(e):i&&i(t))},_renderControls:function(t,e){if(!(!this.active||e||this.group&&this.group!==this.canvas.getActiveGroup())){var i,n=this.getViewportTransform(),o=this.calcTransformMatrix();o=iws.util.multiplyTransformMatrices(n,o),i=iws.util.qrDecompose(o),t.save(),t.translate(i.translateX,i.translateY),t.lineWidth=1*this.borderScaleFactor,t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,t.rotate(iws.util.degreesToRadians(this.angle)),this.drawBorders(t),this.drawControls(t),t.restore()}},_setShadow:function(t){if(this.shadow){var e=this.canvas&&this.canvas.viewportTransform[0]||1,i=this.canvas&&this.canvas.viewportTransform[3]||1,n=this.getObjectScaling();t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur*(e+i)*(n.scaleX+n.scaleY)/4,t.shadowOffsetX=this.shadow.offsetX*e*n.scaleX,t.shadowOffsetY=this.shadow.offsetY*i*n.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_renderFill:function(t){if(this.fill){if(t.save(),this.fill.gradientTransform){var e=this.fill.gradientTransform;t.transform.apply(t,e)}this.fill.toLive&&t.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore()}},_renderStroke:function(t){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.stroke.gradientTransform){var e=this.stroke.gradientTransform;t.transform.apply(t,e)}this.stroke.toLive&&t.translate(-this.width/2+this.stroke.offsetX||0,-this.height/2+this.stroke.offsetY||0),t.stroke(),t.restore()}},clone:function(t,e){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(e),t):new iws.Object(this.toObject(e))},isType:function(t){return this.type===t},toJSON:function(t){return this.toObject(t)},setColor:function(t){return this.set("fill",t),this},setAngle:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},remove:function(){return this.canvas&&this.canvas.remove(this),this},getLocalPointer:function(t,e){e=e||this.canvas.getPointer(t);var i=new iws.Point(e.x,e.y),n=this._getLeftTopCoords();return this.angle&&(i=iws.util.rotatePoint(i,n,iws.util.degreesToRadians(-this.angle))),{x:i.x-n.x,y:i.y-n.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}})}(),function(){var t=iws.util.degreesToRadians,e={left:-.5,center:0,right:.5},i={top:-.5,center:0,bottom:.5};iws.util.extend(iws.Object.prototype,{translateToGivenOrigin:function(t,n,o,s,r){var a,l,h,c=t.x,u=t.y;return"string"==typeof n?n=e[n]:n-=.5,"string"==typeof s?s=e[s]:s-=.5,a=s-n,"string"==typeof o?o=i[o]:o-=.5,"string"==typeof r?r=i[r]:r-=.5,l=r-o,(a||l)&&(h=this._getTransformedDimensions(),c=t.x+a*h.x,u=t.y+l*h.y),new iws.Point(c,u)},translateToCenterPoint:function(e,i,n){var o=this.translateToGivenOrigin(e,i,n,"center","center");return this.angle?iws.util.rotatePoint(o,e,t(this.angle)):o},translateToOriginPoint:function(e,i,n){var o=this.translateToGivenOrigin(e,"center","center",i,n);return this.angle?iws.util.rotatePoint(o,e,t(this.angle)):o},getCenterPoint:function(){var t=new iws.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var i=this.getCenterPoint();return this.translateToOriginPoint(i,t,e)},toLocalPoint:function(e,i,n){var o,s,r=this.getCenterPoint();return o=void 0!==i&&void 0!==n?this.translateToGivenOrigin(r,"center","center",i,n):new iws.Point(this.left,this.top),s=new iws.Point(e.x,e.y),this.angle&&(s=iws.util.rotatePoint(s,r,-t(this.angle))),s.subtractEquals(o)},setPositionByOrigin:function(t,e,i){var n=this.translateToCenterPoint(t,e,i),o=this.translateToOriginPoint(n,this.originX,this.originY);this.set("left",o.x),this.set("top",o.y)},adjustPosition:function(i){var n,o,s=t(this.angle),r=this.getWidth(),a=Math.cos(s)*r,l=Math.sin(s)*r;n="string"==typeof this.originX?e[this.originX]:this.originX-.5,o="string"==typeof i?e[i]:i-.5,this.left+=a*(o-n),this.top+=l*(o-n),this.setCoords(),this.originX=i},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function t(t){return[new iws.Point(t.tl.x,t.tl.y),new iws.Point(t.tr.x,t.tr.y),new iws.Point(t.br.x,t.br.y),new iws.Point(t.bl.x,t.bl.y)]}var e=iws.util.degreesToRadians,i=iws.util.multiplyTransformMatrices;iws.util.extend(iws.Object.prototype,{oCoords:null,intersectsWithRect:function(e,i){var n=t(this.oCoords);return"Intersection"===iws.Intersection.intersectPolygonRectangle(n,e,i).status},intersectsWithObject:function(e){return"Intersection"===iws.Intersection.intersectPolygonPolygon(t(this.oCoords),t(e.oCoords)).status||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)},isContainedWithinObject:function(e){for(var i=t(this.oCoords),n=0;n<4;n++)if(!e.containsPoint(i[n]))return!1;return!0},isContainedWithinRect:function(t,e){var i=this.getBoundingRect();return i.left>=t.x&&i.left+i.width<=e.x&&i.top>=t.y&&i.top+i.height<=e.y},containsPoint:function(t){this.oCoords||this.setCoords();var e=iws.util.find.getContainFromCoords(this.oCoords,t);return e&&(e=e),e},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){return this.oCoords||this.setCoords(),iws.util.makeBoundingBoxFromPoints([this.oCoords.tl,this.oCoords.tr,this.oCoords.br,this.oCoords.bl])},getWidth:function(){return this._getTransformedDimensions().x},getHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:t},scale:function(t){return(t=this._constrainScale(t))<0&&(this.flipX=!this.flipX,this.flipY=!this.flipY,t*=-1),this.scaleX=t,this.scaleY=t,this.setCoords(),this},scaleToWidth:function(t){var e=this.getBoundingRect().width/this.getWidth();return this.scale(t/this.width/e)},scaleToHeight:function(t){var e=this.getBoundingRect().height/this.getHeight();return this.scale(t/this.height/e)},setCoords:function(){var t=e(this.angle),i=this.getViewportTransform(),n=this._calculateCurrentDimensions(),o=n.x,s=n.y;o<0&&(o=Math.abs(o));var r=Math.sin(t),a=Math.cos(t),l=o>0?Math.atan(s/o):0,h=o/Math.cos(l)/2,c=Math.cos(l+t)*h,u=Math.sin(l+t)*h,p=iws.util.transformPoint(this.getCenterPoint(),i),d=new iws.Point(p.x-c,p.y-u),f=new iws.Point(d.x+o*a,d.y+o*r),g=new iws.Point(d.x-s*r,d.y+s*a),m=new iws.Point(p.x+c,p.y+u),v=new iws.Point((d.x+g.x)/2,(d.y+g.y)/2),b=new iws.Point((f.x+d.x)/2,(f.y+d.y)/2),w=new iws.Point((m.x+f.x)/2,(m.y+f.y)/2),y=new iws.Point((m.x+g.x)/2,(m.y+g.y)/2),x=new iws.Point(b.x+r*this.rotatingPointOffset,b.y-a*this.rotatingPointOffset),k=new iws.Point(w.x+this.deletePointOffset*a,w.y+this.deletePointOffset*r);return this.oCoords={tl:d,tr:f,br:m,bl:g,ml:v,mt:b,mr:w,mb:y,mtr:x,mrdel:k},this._setCornerCoords&&this._setCornerCoords(this.oCoords),this._setCornerCoords_del(this.oCoords),this},_calcRotateMatrix:function(){if(this.angle){var t=e(this.angle),i=Math.cos(t),n=Math.sin(t);return[i,n,-n,i,0,0]}return[1,0,0,1,0,0]},calcTransformMatrix:function(){var t=this.getCenterPoint(),e=[1,0,0,1,t.x,t.y],n=this._calcRotateMatrix(),o=this._calcDimensionsTransformMatrix(this.skewX,this.skewY,!0),s=this.group?this.group.calcTransformMatrix():[1,0,0,1,0,0];return s=i(s,e),s=i(s,n),s=i(s,o)},_calcDimensionsTransformMatrix:function(t,n,o){var s=[1,0,Math.tan(e(t)),1],r=[1,Math.tan(e(n)),0,1],a=this.scaleX*(o&&this.flipX?-1:1),l=this.scaleY*(o&&this.flipY?-1:1),h=i([a,0,0,l],s,!0);return i(h,r,!0)}})}(),function(){var t=iws.util.degreesToRadians;iws.util.extend(iws.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(t){if(!this.hasControls||!this.active)return!1;var e=t.x,i=t.y;this.__corner=0;for(var n in this.oCoords){if(this.isControlVisible(n))if("mtr"!==n||this.hasRotatingPoint)if(!this.get("lockUniScaling")||"mt"!==n&&"mr"!==n&&"mb"!==n&&"ml"!==n)if(iws.util.find.getContainFromCoords(this.oCoords[n].corner,{x:e,y:i}))return this.__corner=n,n}return!1},findDeleteButton:function(t){},_setCornerCoords:function(e){Math.sqrt(2*Math.pow(this.delIconSize,2));var i,n,o=t(45-this.angle),s=.707106*this.cornerSize,r=s*Math.cos(o),a=s*Math.sin(o);for(var l in e)i=e[l].x,n=e[l].y,e[l].corner={tl:{x:i-a,y:n-r},tr:{x:i+r,y:n-a},bl:{x:i-r,y:n+a},br:{x:i+a,y:n+r}}},_setCornerCoords_del:function(e){var i,n,o=t(45-this.angle),s=Math.sqrt(2)/2,r=this.delIconSize*s,a=r*Math.cos(o),l=r*Math.sin(o);i=e.mrdel.x,n=e.mrdel.y,e.mrdel.corner={tl:{x:i-l,y:n-a},tr:{x:i+a,y:n-l},bl:{x:i-a,y:n+l},br:{x:i+l,y:n+a}}},_getNonTransformedDimensions:function(){var t=this.strokeWidth,e=this.width,i=this.height,n=!0,o=!0;return"line"===this.type&&"butt"===this.strokeLineCap&&(o=e,n=i),o&&(i+=i<0?-t:t),n&&(e+=e<0?-t:t),{x:e,y:i}},_getTransformedDimensions:function(t,e){void 0===t&&(t=this.skewX),void 0===e&&(e=this.skewY);var i,n,o=this._getNonTransformedDimensions(),s=o.x/2,r=o.y/2,a=[{x:-s,y:-r},{x:s,y:-r},{x:-s,y:r},{x:s,y:r}],l=this._calcDimensionsTransformMatrix(t,e,!1);for(i=0;i<a.length;i++)a[i]=iws.util.transformPoint(a[i],l);return{x:(n=iws.util.makeBoundingBoxFromPoints(a)).width,y:n.height}},_calculateCurrentDimensions:function(){var t=this.getViewportTransform(),e=this._getTransformedDimensions(),i=e.x,n=e.y;return iws.util.transformPoint(new iws.Point(i,n),t,!0).scalarAdd(2*this.padding)},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.group||!this.active)return this;e.save();var i=this.getCenterPoint(),n=this._calculateCurrentDimensions(),o=this.canvas.viewportTransform;return e.translate(i.x,i.y),e.scale(1/o[0],1/o[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore(),this},drawDelete:function(t){var e,i=this.getViewportTransform(),n=this.calcTransformMatrix();n=iws.util.multiplyTransformMatrices(i,n),e=iws.util.qrDecompose(n),t.save(),t.translate(e.translateX,e.translateY),t.rotate(iws.util.degreesToRadians(this.angle));var o=this._calculateCurrentDimensions(),s=1/this.borderScaleFactor;o.x,o.y;t.restore()},drawBorders:function(t){if(!this.hasBorders)return this;var e=this._calculateCurrentDimensions(),i=1/this.borderScaleFactor,n=e.x+i,o=e.y+i;if(t.save(),t.strokeStyle=this.borderColor,t.strokeRect(-n/2,-o/2,n,o),this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls){var s=-o/2;t.beginPath(),t.moveTo(0,s),t.lineTo(0,s-this.rotatingPointOffset),t.closePath(),t.stroke()}return t.restore(),this},drawControls:function(t){if(!this.hasControls)return this;var e=this._calculateCurrentDimensions(),i=e.x,n=e.y,o=this.cornerSize,s=-(i+o)/2,r=-(n+o)/2,a=this.transparentCorners?"stroke":"fill";return t.save(),t.strokeStyle=t.fillStyle=this.cornerColor,this.transparentCorners||(t.strokeStyle=this.cornerStrokeColor),this._setLineDash(t,this.cornerDashArray,null),this._drawControl("tl",t,a,s,r),this._drawControl("tr",t,a,s+i,r),this._drawControl("bl",t,a,s,r+n),this._drawControl("br",t,a,s+i,r+n),this.get("lockUniScaling")||(this._drawControl("mt",t,a,s+i/2,r),this._drawControl("mb",t,a,s+i/2,r+n),this._drawControl("mr",t,a,s+i,r+n/2),this._drawControl("ml",t,a,s,r+n/2)),this.hasRotatingPoint&&this._drawControl("mtr",t,a,s+i/2,r-this.rotatingPointOffset),t.restore(),this},_drawControl:function(t,e,i,n,o){if(this.isControlVisible(t)){var s=this.cornerSize,r=!this.transparentCorners&&this.cornerStrokeColor;switch(this.cornerStyle){case"circle":e.beginPath(),e.arc(n+s/2,o+s/2,s/2,0,2*Math.PI,!1),e[i](),r&&e.stroke();break;default:"undefined"!=typeof G_vmlCanvasManager||this.transparentCorners||e.clearRect(n,o,s,s),e[i+"Rect"](n,o,s,s),r&&e.strokeRect(n,o,s,s)}}},isControlVisible:function(t){return this._getControlsVisibility()[t]},setControlVisible:function(t,e){return this._getControlsVisibility()[t]=e,this},setControlsVisibility:function(t){t||(t={});for(var e in t)this.setControlVisible(e,t[e]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0,mrdel:!0}),this._controlsVisibility}})}(),iws.util.extend(iws.Object.prototype,{_onCreateMouseDown:function(t){},_onCreateMouseMove:function(t){var e=this.canvas.trackMouse.getRect();this.set({left:e.left}).set({top:e.top}),this.set("width",Math.abs(e.right-e.left)).set("height",Math.abs(e.bottom-e.top))},_onCreateMouseUp:function(t){this.setCoords()},restoreOriginXY:function(t,e){var i=this.translateToOriginPoint(this.getCenterPoint(),t,e);this.originX=t,this.originY=e,this.left=i.x,this.top=i.y},_rotate:function(t,e){var i=iws.util.Rotate(t).point(e.x,e.y,this.left,this.top);this.set({angle:(this.angle+t+360)%360,left:i.x,top:i.y}),this.setCoords()},_moveOffset:function(t){var e=this.left,i=this.top;this.set({left:e+t.x,top:i+t.y}),this.setCoords()},_objectSizeChangeScale:function(t,e,i){var n,o,s,r,a,l,h={x:this.get("left")+this.get("width")/2,y:this.get("top")+this.get("height")/2},c={x:i.x-e.x,y:i.y-e.y},u=(s=i,r=t,a=(o=c).x-(n=h).x,l=o.y-n.y,{x:s.x-a*r,y:s.y-l*r});this.set({left:u.x-t*(this.width/2),top:u.y-t*(this.height/2),width:t*this.get("width"),height:t*this.get("height")}),this.setCoords()}}),function(t){"use strict";var e=t.iws||(t.iws={}),i=e.util.extend;e.objectArrowLine?e.warn("iws.ArrowLine is already defined"):(e.objectArrowLine=e.util.createInheritClass(function(){this.initialize.apply(this,arguments)},e.Object,{type:"arrowLine",x1:0,y1:0,x2:0,y2:0,lineHeight:14,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.setControlsVisibility({tl:!1,tr:!1,br:!1,bl:!1,ml:!0,mt:!1,mr:!0,mb:!1,mtr:!0}),this._initValue(t),this.setCoords(),this.originX="left",this.originY="center",e.debug=!1},_initValue:function(t){t||(t={}),this.width=this.width||e.util.find.distanceOfTwoPoints({x:this.x1,y:this.y1},{x:this.x2,y:this.y2}),this.height=this.height||this.lineHeight,this.angle=this.angle||e.util.find.getAngleFromPointToPoint(this.x1,this.y1,this.x2,this.y2).angle,this.left=this.left||this.x1,this.top=this.top||this.y1-this.lineHeight/2},_changeWidthHeight:function(){console.log("x1:"+this.x1+", y1:"+this.y1+" - x2:"+this.x2+", y2:"+this.y2),this.width=e.util.find.distanceOfTwoPoints({x:this.x1,y:this.y1},{x:this.x2,y:this.y2}),this.height=this.lineHeight,this.angle=e.util.find.getAngleFromPointToPoint(this.x1,this.y1,this.x2,this.y2).angle,this.left=this.x1,this.top=this.y1-this.lineHeight/2},_cornerMove:function(t,i){"mr"===this.__corner?(this.set("x2",t).set("y2",i),this.width=e.util.find.distanceOfTwoPoints({x:this.x1,y:this.y1},{x:this.x2,y:this.y2}),this.angle=e.util.find.getAngleFromPointToPoint(this.x1,this.y1,this.x2,this.y2).angle):"ml"===this.__corner&&(this.set("x1",t).set("y1",i),this.width=e.util.find.distanceOfTwoPoints({x:this.x1,y:this.y1},{x:this.x2,y:this.y2}),this.angle=e.util.find.getAngleFromPointToPoint(this.x1,this.y1,this.x2,this.y2).angle,this.left=this.x1,this.top=this.y1-this.lineHeight/2)},_set:function(t,e){return this.callSuper("_set",t,e),this},translateOffset:function(t,e,i,n){var o=t-i,s=e-n,r=!this.get("lockMovementX")&&this.left!==o,a=!this.get("lockMovementY")&&this.top!==s,l=this.x2-this.x1;this.x1=o,this.x2=l+this.x1;var h=this.y2-this.y1;return this.y1=s+this.lineHeight/2,this.y2=h+this.y1,this.left=this.x1,this.top=s,r||a},_render:function(t,i,n){t.beginPath(),t.moveTo(-this.width/2,0),t.lineTo(this.width/2,0),t.closePath();var o=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=o;var s=1;e.config&&e.config.annotation&&"scale"==e.config.annotation.line&&!isNaN(n)&&(s=n);var r={h:(5+this.strokeWidth)*s,w:(12+this.strokeWidth)*s};this._drawArrow(t,r,{x:this.width/2,y:0},{x:-this.width/2,y:0})},__getAngleBetweenPoints:function(t,e){var i={x:e.x-t.x,y:e.y-t.y};return 180*Math.atan2(i.y,i.x)/Math.PI},_drawArrow:function(t,e,i,n){var o=this.__getAngleBetweenPoints(i,n);t.save(),t.translate(n.x,n.y),t.rotate(o*Math.PI/180),t.beginPath(),t.moveTo(0,0),t.lineTo(-e.w,-e.h),t.lineTo(-e.w,+e.h),t.closePath(),t.fillStyle=t.strokeStyle,t.stroke(),t.fill(),t.restore()},toObject:function(t){return i(this.callSuper("toObject",t),{x1:parseFloat(Number(this.x1).toFixed(2)),y1:parseFloat(Number(this.y1).toFixed(2)),x2:parseFloat(Number(this.x2).toFixed(2)),y2:parseFloat(Number(this.y2).toFixed(2))})},setCoords:function(){return this.callSuper("setCoords"),this.x1=this.oCoords.ml.x,this.y1=this.oCoords.ml.y,this.x2=this.oCoords.mr.x,this.y2=this.oCoords.mr.y,this}}),e.objectArrowLine.fromObject=function(t,i){var n=new e.objectArrowLine(t);return i&&i(n),n})}("undefined"!=typeof exports?exports:this),iws.util.extend(iws.objectArrowLine.prototype,{_onCreateMouseDown:function(t){var e=this.canvas.getPointer(t);this.set({left:e.x,top:e.y,x1:e.x,y1:e.y+this.lineHeight/2,x2:e.x,y2:e.y+this.lineHeight/2})},_onCreateMouseMove:function(t){var e=this.canvas.getPointer(t);this.set({x1:e.x}).set({y1:e.y+this.lineHeight/2}),this._changeWidthHeight()},_onCreateMouseUp:function(t){this.callSuper("_onCreateMouseUp",t)},_objectSizeChangeScale:function(t,e,i){var n=function(t,e,i,n){var o=e.x-t.x,s=e.y-t.y;return{x:i.x-o*n,y:i.y-s*n}},o={x:this.get("left")+this.get("width")/2,y:this.get("top")+this.get("height")/2},s={x:i.x-e.x,y:i.y-e.y},r=n(o,s,i,t),a=n({x:this.x1,y:this.y1},s,i,t),l=n({x:this.x2,y:this.y2},s,i,t);this.set({left:r.x-t*(this.width/2),top:r.y-t*(this.height/2),x1:a.x,y1:a.y,x2:l.x,y2:l.y,width:t*this.get("width"),height:t*this.get("height")}),this.setCoords()},_moveOffset:function(t){var e=this.left,i=this.top;this.set({left:e+t.x,top:i+t.y});var n=this.x1,o=this.y1,s=this.x2,r=this.y2;this.set({x1:n+t.x,y1:o+t.y}),this.set({x2:s+t.x,y2:r+t.y}),this.setCoords()}}),iws.util.extend(iws.objectArrowLine.prototype,{}),function(t){"use strict";iws.objectEllipse=iws.util.createInheritClass(function(){this.initialize.apply(this,arguments)},iws.Object,{type:"ellipse",initialize:function(t){t=t||{},this.callSuper("initialize",t)},_render:function(t,e){if(1!==this.width||1!==this.height){t.beginPath();var i=.5*this.width,n=.5*this.height;t.transform(1,0,0,n/i,0,0),t.arc(0,0,i,0,2*Math.PI,!1),t.closePath(),this._renderBackground(t),this._renderStroke(t)}else t.fillRect(-.5,-.5,1,1)},_renderBackground:function(t){this.backgroundColor&&(t.save(),t.fillStyle=this.backgroundColor,t.fill(),t.restore())},toObject:function(t){return iws.util.extend(this.callSuper("toObject",t),{backgroundColor:this.backgroundColor})}}),iws.objectEllipse.fromObject=function(t,e){var i=new iws.objectEllipse(t);return e&&e(i),i}}("undefined"!=typeof exports&&exports),iws.util.extend(iws.objectEllipse.prototype,{_onCreateMouseDown:function(t){var e=this.canvas.getPointer(t);this.set({left:e.x,top:e.y,originX:"left",originY:"top",width:10,height:10})},_onCreateMouseMove:function(t){this.callSuper("_onCreateMouseMove",t)},_onCreateMouseUp:function(t){this.callSuper("_onCreateMouseUp",t)}}),function(t){"use strict";iws.util.extend;t.iws.objectImage?iws.warn("iws.objectImage is already defined."):(iws.objectImage=iws.util.createInheritClass(function(){this.initialize.apply(this,arguments)},iws.Object,{type:"image",initialize:function(t){t||(t={}),this.callSuper("initialize",t),this._initElement(null,t)},_initElement:function(t,e){var i;t&&this.setElement("string"==typeof(i=t)?document.getElementById(i):i,e)},setElement:function(t,e){return this._element=t,this._setWidthHeight(e),this},_setWidthHeight:function(t){this.width="width"in t?t.width:this.getElement()&&this.getElement().width||0,this.height="height"in t?t.height:this.getElement()&&this.getElement().height||0},getElement:function(){return this._element},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,-i),t.lineTo(e,-i),t.lineTo(e,i),t.lineTo(-e,i),t.lineTo(-e,-i),t.closePath()}},_render:function(t,e){var i=e?this.left:-this.width/2,n=e?this.top:-this.height/2;t.globalAlpha=.9,this._element?t.drawImage(this._element,i,n,this.width,this.height):(t.fillStyle="red",t.fillRect(i,n,this.width,this.height)),this._stroke(t),this._renderStroke(t)},_resetWidthHeight:function(){var t=this.getElement();this.set("width",t.width),this.set("height",t.height)},toObject:function(t){return iws.util.extend(this.callSuper("toObject",t),{})}}),iws.objectImage.fromObject=function(t,e){var i=new iws.objectImage(t);return e&&e(i),i})}("undefined"!=typeof exports?exports:this),iws.util.extend(iws.objectImage.prototype,{_onCreateMouseDown:function(t){var e=this.canvas.getPointer(t);this.set({left:e.x,top:e.y,originX:"left",originY:"top",width:10,height:10})},_onCreateMouseMove:function(t){var e=this.canvas.trackMouse.getRect();this.set({left:e.left}).set({top:e.top});var i=Math.max(Math.abs(e.right-e.left),Math.abs(e.bottom-e.top));this.set("width",i).set("height",i)},_onCreateMouseUp:function(t){(this.width<=10||this.height<=10)&&this.getElement()&&(this.canvas.getPointer(t),this._resetWidthHeight(),this.set({left:this.left-this.width/2,top:this.top-this.height/2})),this.setCoords()}}),function(t){"use strict";t.iws.objectImageCheckV?iws.warn("iws.objectImageCheckV is already defined."):(iws.objectImageCheckV=iws.util.createInheritClass(function(){this.initialize.apply(this,arguments)},iws.Object,{type:"imageCheckV",initialize:function(t){t||(t={}),this.callSuper("initialize",t),this._initElement(iws.imgSrc.checkVElement,t)},_initElement:function(t,e){var i;t&&this.setElement("string"==typeof(i=t)?document.getElementById(i):i,e)},setElement:function(t,e){return this._element=t,this._setWidthHeight(e),this},_setWidthHeight:function(t){this.width="width"in t?t.width:this.getElement()&&this.getElement().width||0,this.height="height"in t?t.height:this.getElement()&&this.getElement().height||0},getElement:function(){return this._element},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,-i),t.lineTo(e,-i),t.lineTo(e,i),t.lineTo(-e,i),t.lineTo(-e,-i),t.closePath()}},_render:function(t,e){var i=e?this.left:-this.width/2,n=e?this.top:-this.height/2;t.globalAlpha=.9,this._element?t.drawImage(this._element,i,n,this.width,this.height):(t.fillStyle="red",t.fillRect(i,n,this.width,this.height)),this._stroke(t),this._renderStroke(t)},_resetWidthHeight:function(){var t=this.getElement();this.set("width",t.width),this.set("height",t.height)},toObject:function(t){return iws.util.extend(this.callSuper("toObject",t),{})}}),iws.objectImageCheckV.fromObject=function(t,e){var i=new iws.objectImageCheckV(t);return e&&e(i),i})}("undefined"!=typeof exports?exports:this),iws.util.extend(iws.objectImageCheckV.prototype,{_onCreateMouseDown:function(t){var e=this.canvas.getPointer(t);this.set({left:e.x,top:e.y,originX:"left",originY:"top",width:10,height:10})},_onCreateMouseMove:function(t){var e=this.canvas.trackMouse.getRect();this.set({left:e.left}).set({top:e.top});var i=Math.max(Math.abs(e.right-e.left),Math.abs(e.bottom-e.top));this.set("width",i).set("height",i)},_onCreateMouseUp:function(t){(this.width<=10||this.height<=10)&&this.getElement()&&(this.canvas.getPointer(t),this._resetWidthHeight(),this.set({left:this.left-this.width/2,top:this.top-this.height/2})),this.setCoords()}}),function(t){"use strict";t.iws.objectImageCheckX?iws.warn("iws.objectImageCheckX is already defined."):(iws.objectImageCheckX=iws.util.createInheritClass(function(){this.initialize.apply(this,arguments)},iws.Object,{type:"imageCheckX",initialize:function(t){t||(t={}),this.callSuper("initialize",t),this._initElement(iws.imgSrc.checkXElement,t)},_initElement:function(t,e){var i;t&&this.setElement("string"==typeof(i=t)?document.getElementById(i):i,e)},setElement:function(t,e){return this._element=t,this._setWidthHeight(e),this},_setWidthHeight:function(t){this.width="width"in t?t.width:this.getElement()&&this.getElement().width||0,this.height="height"in t?t.height:this.getElement()&&this.getElement().height||0},getElement:function(){return this._element},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,-i),t.lineTo(e,-i),t.lineTo(e,i),t.lineTo(-e,i),t.lineTo(-e,-i),t.closePath()}},_render:function(t,e){var i=e?this.left:-this.width/2,n=e?this.top:-this.height/2;t.globalAlpha=.9,this._element?t.drawImage(this._element,i,n,this.width,this.height):(t.fillStyle="red",t.fillRect(i,n,this.width,this.height)),this._stroke(t),this._renderStroke(t)},_resetWidthHeight:function(){var t=this.getElement();this.set("width",t.width),this.set("height",t.height)},toObject:function(t){return iws.util.extend(this.callSuper("toObject",t),{})}}),iws.objectImageCheckX.fromObject=function(t,e){var i=new iws.objectImageCheckX(t);return e&&e(i),i})}("undefined"!=typeof exports?exports:this),iws.util.extend(iws.objectImageCheckX.prototype,{_onCreateMouseDown:function(t){var e=this.canvas.getPointer(t);this.set({left:e.x,top:e.y,originX:"left",originY:"top",width:10,height:10})},_onCreateMouseMove:function(t){var e=this.canvas.trackMouse.getRect();this.set({left:e.left}).set({top:e.top});var i=Math.max(Math.abs(e.right-e.left),Math.abs(e.bottom-e.top));this.set("width",i).set("height",i)},_onCreateMouseUp:function(t){(this.width<=10||this.height<=10)&&this.getElement()&&(this.canvas.getPointer(t),this._resetWidthHeight(),this.set({left:this.left-this.width/2,top:this.top-this.height/2})),this.setCoords()}}),function(t){"use strict";var e=t.iws||(t.iws={}),i=e.util.extend;e.objectLine?e.warn("iws.Line is already defined"):(e.objectLine=e.util.createInheritClass(function(){this.initialize.apply(this,arguments)},e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,lineHeight:14,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.setControlsVisibility({tl:!1,tr:!1,br:!1,bl:!1,ml:!0,mt:!1,mr:!0,mb:!1,mtr:!0}),this._initValue(t),this.setCoords(),this.originX="left",this.originY="center"},_initValue:function(t){t||(t={}),this.width=this.width||e.util.find.distanceOfTwoPoints({x:this.x1,y:this.y1},{x:this.x2,y:this.y2}),this.height=this.height||this.lineHeight,this.angle=this.angle||e.util.find.getAngleFromPointToPoint(this.x1,this.y1,this.x2,this.y2).angle,this.left=this.left||this.x1,this.top=this.top||this.y1-this.lineHeight/2},_changeWidthHeight:function(){this.width=e.util.find.distanceOfTwoPoints({x:this.x1,y:this.y1},{x:this.x2,y:this.y2}),this.height=this.lineHeight,this.angle=e.util.find.getAngleFromPointToPoint(this.x1,this.y1,this.x2,this.y2).angle,this.left=this.x1,this.top=this.y1-this.lineHeight/2},_cornerMove:function(t,i){"mr"===this.__corner?(this.set("x2",t).set("y2",i),this.width=e.util.find.distanceOfTwoPoints({x:this.x1,y:this.y1},{x:this.x2,y:this.y2}),this.angle=e.util.find.getAngleFromPointToPoint(this.x1,this.y1,this.x2,this.y2).angle):"ml"===this.__corner&&(this.set("x1",t).set("y1",i),this.width=e.util.find.distanceOfTwoPoints({x:this.x1,y:this.y1},{x:this.x2,y:this.y2}),this.angle=e.util.find.getAngleFromPointToPoint(this.x1,this.y1,this.x2,this.y2).angle,this.left=this.x1,this.top=this.y1-this.lineHeight/2)},_set:function(t,e){return this.callSuper("_set",t,e),this},translateOffset:function(t,e,i,n){var o=t-i,s=e-n,r=!this.get("lockMovementX")&&this.left!==o,a=!this.get("lockMovementY")&&this.top!==s,l=this.x2-this.x1;this.x1=o,this.x2=l+this.x1;var h=this.y2-this.y1;return this.y1=s+this.lineHeight/2,this.y2=h+this.y1,this.left=this.x1,this.top=s,r||a},_render:function(t,e){t.beginPath(),t.moveTo(-this.width/2,0),t.lineTo(this.width/2,0);var i=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=i},toObject:function(t){return i(this.callSuper("toObject",t),{x1:parseFloat(Number(this.x1).toFixed(2)),y1:parseFloat(Number(this.y1).toFixed(2)),x2:parseFloat(Number(this.x2).toFixed(2)),y2:parseFloat(Number(this.y2).toFixed(2))})},complexity:function(){return 1},setCoords:function(){return this.callSuper("setCoords"),this.x1=this.oCoords.ml.x,this.y1=this.oCoords.ml.y,this.x2=this.oCoords.mr.x,this.y2=this.oCoords.mr.y,this}}),e.objectLine.fromObject=function(t,i){var n=new e.objectLine(t);return i&&i(n),n})}("undefined"!=typeof exports?exports:this),iws.util.extend(iws.objectLine.prototype,{_onCreateMouseDown:function(t){var e=this.canvas.getPointer(t);this.set({left:e.x,top:e.y,x1:e.x,y1:e.y+this.lineHeight/2,x2:e.x,y2:e.y+this.lineHeight/2})},_onCreateMouseMove:function(t){var e=this.canvas.getPointer(t);this.set({x1:e.x}).set({y1:e.y+this.lineHeight/2}),this._changeWidthHeight()},_onCreateMouseUp:function(t){this.callSuper("_onCreateMouseUp",t)},_objectSizeChangeScale:function(t,e,i){var n=function(t,e,i,n){var o=e.x-t.x,s=e.y-t.y;return{x:i.x-o*n,y:i.y-s*n}},o={x:this.get("left")+this.get("width")/2,y:this.get("top")+this.get("height")/2},s={x:i.x-e.x,y:i.y-e.y},r=n(o,s,i,t),a=n({x:this.x1,y:this.y1},s,i,t),l=n({x:this.x2,y:this.y2},s,i,t);this.set({left:r.x-t*(this.width/2),top:r.y-t*(this.height/2),x1:a.x,y1:a.y,x2:l.x,y2:l.y,width:t*this.get("width"),height:t*this.get("height")}),this.setCoords()},_moveOffset:function(t){var e=this.left,i=this.top;this.set({left:e+t.x,top:i+t.y});var n=this.x1,o=this.y1,s=this.x2,r=this.y2;this.set({x1:n+t.x,y1:o+t.y}),this.set({x2:s+t.x,y2:r+t.y}),this.setCoords()}}),iws.util.extend(iws.objectLine.prototype,{}),function(t){"use strict";var e;e={destX:0,destY:0,sourceX:0,sourceY:0,width:"auto",height:"auto"},iws.blendOnto=function(t,i,n,o){var s={};for(var r in e)e.hasOwnProperty(r)&&(s[r]=o&&o[r]||e[r]);"auto"==s.width&&(s.width=t.canvas.width),"auto"==s.height&&(s.height=t.canvas.height),s.width=Math.min(s.width,t.canvas.width-s.sourceX,i.canvas.width-s.destX),s.height=Math.min(s.height,t.canvas.height-s.sourceY,i.canvas.height-s.destY);var a,l,h,c,u,p,d,f,g,m,v,b,w,y,x,k,_=t.getImageData(s.sourceX,s.sourceY,s.width,s.height),C=i.getImageData(s.destX,s.destY,s.width,s.height),S=_.data,A=C.data,T=A.length;function M(t,e){var i=e<<1;return e<128?t*(i+(t*(255-i)>>8))>>8:t*(511-i)+Math.sqrt(t<<8)*(i-255)>>8}function E(t,e){return t<128?t*e>>7:255-((255-e)*(255-t)>>7)}function O(t,e){return 255==e&&0==t?255:Math.min(255,(t<<8)/(255-e))}function P(t,e){return 255==e&&0==t?0:255-Math.min(255,(255-t<<8)/e)}function j(t,e,i){return{r:.299*t+.587*e+.114*i,g:-.1687*t-.3313*e+.5*i,b:.5*t-.4187*e-.0813*i}}function I(t,e,i){return{r:t+1.402*i,g:t-.3441*e-.7141*i,b:t+1.772*e}}function D(t,e,i){var n=j(t,e,i),o=Math.sqrt(n.g*n.g+n.b*n.b);return{h:Math.atan2(n.g,n.b),s:o,v:n.r}}function F(t,e,i){return I(i,e*Math.sin(t),e*Math.cos(t))}for(var R=0;R<T;R+=4){g=(a=S[R+3]/255)+(l=A[R+3]/255)-a*l,A[R+3]=255*g,m=A[R],v=A[R+1],b=A[R+2],h=(w=S[R])/255*a,p=m/255*l,c=(y=S[R+1])/255*a,d=v/255*l,u=(x=S[R+2])/255*a,f=b/255*l,k=255/g;var B=l*a,L=l-B,z=a-B;switch(n){case"normal":case"src-over":A[R]=(h+p-p*a)*k,A[R+1]=(c+d-d*a)*k,A[R+2]=(u+f-f*a)*k;break;case"screen":A[R]=(h+p-h*p)*k,A[R+1]=(c+d-c*d)*k,A[R+2]=(u+f-u*f)*k;break;case"multiply":A[R]=(h*p+h*(1-l)+p*(1-a))*k,A[R+1]=(c*d+c*(1-l)+d*(1-a))*k,A[R+2]=(u*f+u*(1-l)+f*(1-a))*k;break;case"difference":A[R]=(h+p-2*Math.min(h*l,p*a))*k,A[R+1]=(c+d-2*Math.min(c*l,d*a))*k,A[R+2]=(u+f-2*Math.min(u*l,f*a))*k;break;case"src-in":k=255/(g=a*l),A[R]=h*l*k,A[R+1]=c*l*k,A[R+2]=u*l*k,A[R+3]=255*g;break;case"plus":case"add":A[R]=Math.min(h+p,1)*k,A[R+1]=Math.min(c+d,1)*k,A[R+2]=Math.min(u+f,1)*k;break;case"overlay":A[R]=B*E(m,w)+L*m+z*w,A[R+1]=B*E(v,y)+L*v+z*y,A[R+2]=B*E(b,x)+L*b+z*x;break;case"hardlight":A[R]=B*E(w,m)+L*m+z*w,A[R+1]=B*E(y,v)+L*v+z*y,A[R+2]=B*E(x,b)+L*b+z*x;break;case"colordodge":case"dodge":A[R]=B*O(m,w)+L*m+z*w,A[R+1]=B*O(v,y)+L*v+z*y,A[R+2]=B*O(b,x)+L*b+z*x;break;case"colorburn":case"burn":A[R]=B*P(m,w)+L*m+z*w,A[R+1]=B*P(v,y)+L*v+z*y,A[R+2]=B*P(b,x)+L*b+z*x;break;case"darken":case"darker":A[R]=B*(m<w?m:w)+L*m+z*w,A[R+1]=B*(v<y?v:y)+L*v+z*y,A[R+2]=B*(b<x?b:x)+L*b+z*x;break;case"lighten":case"lighter":A[R]=(h<p?p:h)*k,A[R+1]=(c<d?d:c)*k,A[R+2]=(u<f?f:u)*k;break;case"exclusion":A[R]=(p+h-2*p*h)*k,A[R+1]=(d+c-2*d*c)*k,A[R+2]=(f+u-2*f*u)*k;break;case"softlight":A[R]=B*M(m,w)+L*m+z*w,A[R+1]=B*M(v,y)+L*v+z*y,A[R+2]=B*M(b,x)+L*b+z*x;break;case"luminosity":var Y=j(m,v,b),W=I((q=j(w,y,x)).r,Y.g,Y.b);A[R]=B*W.r+L*m+z*w,A[R+1]=B*W.g+L*v+z*y,A[R+2]=B*W.b+L*b+z*x;break;case"color":Y=j(m,v,b);var q=j(w,y,x);W=I(Y.r,q.g,q.b),A[R]=B*W.r+L*m+z*w,A[R+1]=B*W.g+L*v+z*y,A[R+2]=B*W.b+L*b+z*x;break;case"hue":Y=D(m,v,b),W=F((q=D(w,y,x)).h,Y.s,Y.v),A[R]=B*W.r+L*m+z*w,A[R+1]=B*W.g+L*v+z*y,A[R+2]=B*W.b+L*b+z*x;break;case"saturation":Y=D(m,v,b),q=D(w,y,x),W=F(Y.h,q.s,Y.v),A[R]=B*W.r+L*m+z*w,A[R+1]=B*W.g+L*v+z*y,A[R+2]=B*W.b+L*b+z*x;break;case"lightercolor":W=2.623*(m-w)+5.15*(v-y)+b-x>0?{r:m,g:v,b:b}:{r:w,g:y,b:x},A[R]=B*W.r+L*m+z*w,A[R+1]=B*W.g+L*v+z*y,A[R+2]=B*W.b+L*b+z*x;break;case"darkercolor":W=2.623*(m-w)+5.15*(v-y)+b-x<0?{r:m,g:v,b:b}:{r:w,g:y,b:x},A[R]=B*W.r+L*m+z*w,A[R+1]=B*W.g+L*v+z*y,A[R+2]=B*W.b+L*b+z*x;break;default:var X=R/4%t.canvas.width,H=Math.floor(R/4/t.canvas.width),U=X%8<4&&H%8<4||X%8>3&&H%8>3;A[R]=A[R+3]=255,A[R+1]=U?255:0,A[R+2]=U?0:255}}i.putImageData(C,s.destX,s.destY)};var i=iws.Object.prototype.stateProperties.concat();i.push("rx","ry","x","y"),iws.objectMarker=iws.util.createInheritClass(function(){this.initialize.apply(this,arguments)},iws.Object,{globalCompositeOperation:"darken",stateProperties:i,type:"marker",rx:0,ry:0,initialize:function(t){t=t||{},this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t,e){if(1!==this.width||1!==this.height){var i=this.rx?Math.min(this.rx,this.width/2):0,n=this.ry?Math.min(this.ry,this.height/2):0,o=this.width,s=this.height,r=e?this.left:-this.width/2,a=e?this.top:-this.height/2,l=0!==i||0!==n,h=.4477152502;t.beginPath(),t.moveTo(r+i,a),t.lineTo(r+o-i,a),l&&t.bezierCurveTo(r+o-h*i,a,r+o,a+h*n,r+o,a+n),t.lineTo(r+o,a+s-n),l&&t.bezierCurveTo(r+o,a+s-h*n,r+o-h*i,a+s,r+o-i,a+s),t.lineTo(r+i,a+s),l&&t.bezierCurveTo(r+h*i,a+s,r,a+s-h*n,r,a+s-n),t.lineTo(r,a+n),l&&t.bezierCurveTo(r,a+h*n,r+h*i,a,r+i,a),t.closePath(),this._renderBackground(t),this._renderStroke(t)}else t.fillRect(-.5,-.5,1,1)},_renderBackground:function(t){this.backgroundColor&&(t.fillStyle=this.backgroundColor,t.fillRect(-this.width/2,-this.height/2,this.width,this.height),this._removeShadow(t))},toObject:function(t){return iws.util.extend(this.callSuper("toObject",t),{backgroundColor:this.backgroundColor})}}),iws.objectMarker.fromObject=function(t,e){var i=new iws.objectMarker(t);return e&&e(i),i}}("undefined"!=typeof exports&&exports),iws.util.extend(iws.objectMarker.prototype,{_onCreateMouseDown:function(t){var e=this.canvas.getPointer(t);this.set({left:e.x,top:e.y,originX:"left",originY:"top",width:10,height:10})},_onCreateMouseMove:function(t){this.callSuper("_onCreateMouseMove",t)},_onCreateMouseUp:function(t){this.callSuper("_onCreateMouseUp",t)}}),function(t){"use strict";var e=t.iws||(t.iws={}),i=e.util.array.min,n=e.util.array.max,o=e.util.extend;e.util.drawArc;e.objectPath?e.warn("iws.Path is already defined"):(e.objectPath=e.util.createInheritClass(function(){this.initialize.apply(this,arguments)},e.Object,{type:"path",path:null,minX:0,minY:0,initialize:function(t){t=t||{},this.path=[],this.callSuper("initialize",t),this._setPositionDimensions(t)},_setPositionDimensions:function(t){var e=this._parseDimensions();this.minX=e.left,this.minY=e.top,this.width=e.width,this.height=e.height,void 0===t.left&&(this.left=e.left+("center"===this.originX?this.width/2:"right"===this.originX?this.width:0)),void 0===t.top&&(this.top=e.top+("center"===this.originY?this.height/2:"bottom"===this.originY?this.height:0))},_renderPathCommands:function(t){var i=this.getCenterPoint();t.beginPath();for(var n=0,o=this.path.length;n<o;++n){var s=this.path[n];switch(s[0]){case"L":var r=s[1],a=s[2];if(t.lineTo(r-i.x,a-i.y),e.debug&&n%17==0){t.save(),t.textBaseline="alphabetic",t.font="14px sans-serif";var l="L="+r.toFixed(2)+", "+a.toFixed(2);t.fillText(l,r,a),t.restore()}break;case"M":r=s[1],a=s[2];if(t.moveTo(r-i.x,a-i.y),e.debug){t.save(),t.textBaseline="alphabetic",t.font="14px sans-serif";var h="M="+r.toFixed(2)+", "+a.toFixed(2);t.fillText(h,r,a),t.restore()}}}},_render:function(t){this._renderPathCommands(t),this._renderFill(t),this._renderStroke(t)},toObject:function(t){return o(this.callSuper("toObject",t),{path:this.path.map(function(t){return t.slice().map(function(t){return"number"!=typeof t||isNaN(t)||(t=parseFloat(Number(t).toFixed(2))),t})})})},_parseDimensions:function(){for(var t,e=[],o=[],s=0,r=0,a=0,l=this.path.length;a<l;++a){switch((t=this.path[a])[0]){case"L":case"M":s=t[1],r=t[2]}t,e.push(s),o.push(r)}var h=i(e)||0,c=i(o)||0;return{left:h,top:c,width:(n(e)||0)-h,height:(n(o)||0)-c}}}),e.objectPath.fromObject=function(t,i){var n=new e.objectPath(t);return i&&i(n),n},e.objectPath.async=!0)}("undefined"!=typeof exports?exports:this),iws.util.extend(iws.objectPath.prototype,{_onCreateMouseDown:function(t){var e=this.canvas.getPointer(t);this._addPoint(["M",e.x,e.y])},_onCreateMouseMove:function(t){var e=this.canvas.getPointer(t);this._addPoint(["L",e.x,e.y]),this.canvas.renderAll()},_onCreateMouseUp:function(t){this.callSuper("_onCreateMouseUp",t)},_addPoint:function(t){this.path.push(t),this._setPositionDimensions({})},_objectSizeChangeScale:function(t,e,i){for(var n=function(t,e,i,n){var o=e.x-t.x,s=e.y-t.y;return{x:i.x-o*n,y:i.y-s*n}},o={x:this.get("left")+this.get("width")/2,y:this.get("top")+this.get("height")/2},s={x:i.x-e.x,y:i.y-e.y},r=n(o,s,i,t),a=0;a<this.path.length;a++){var l=this.path[a];if(l.length>=3){var h=n({x:l[1],y:l[2]},s,i,t);l[1]=h.x,l[2]=h.y}}this.set({left:r.x-t*(this.get("width")/2),top:r.y-t*(this.get("height")/2),width:t*this.get("width"),height:t*this.get("height")}),this.setCoords()},_moveOffset:function(t){var e=this.left,i=this.top;this.set({left:e+t.x,top:i+t.y});for(var n=0;n<this.path.length;n++){var o=this.path[n];o.length>=3&&(o[1]+=t.x,o[2]+=t.y)}this.setCoords()},_rotate:function(t,e){var i=iws.util.Rotate(t).point(e.x,e.y,this.left,this.top);this.set({angle:(this.angle+t)%360,left:i.x,top:i.y});for(var n=this.getCenterPoint(),o=0;o<this.path.length;o++){var s=this.path[o];if(s.length>=3){var r=iws.util.Rotate(t).point(e.x,e.y,s[1],s[2]),a=iws.util.Rotate(-t).point(n.x,n.y,r.x,r.y);s[1]=a.x,s[2]=a.y}}this.setCoords()},translateOffset:function(t,e,i,n,o){console.log("x="+t+", y="+e+", offsetX="+i+"offsetY="+n);var s=t-i,r=e-n,a=!this.get("lockMovementX")&&this.left!==s,l=!this.get("lockMovementY")&&this.top!==r,h={x:t-o.x,y:e-o.y};return a||(h.x=0),l||(h.y=0),this._moveOffset(h),a||l},setPositionByOrigin:function(t,e,i,n){var o=this.translateToCenterPoint(t,e,i),s=this.translateToOriginPoint(o,this.originX,this.originY);this.set("left",s.x),this.set("top",s.y);for(var r=o.x-n.x,a=o.y-n.y,l=0;l<this.path.length;l++){var h=this.path[l];h.length>=3&&(h[1]+=r,h[2]+=a)}}}),function(t){"use strict";var e=iws.Object.prototype.stateProperties.concat();e.push("rx","ry","x","y"),iws.objectRect=iws.util.createInheritClass(function(){this.initialize.apply(this,arguments)},iws.Object,{stateProperties:e,type:"rect",rx:0,ry:0,initialize:function(t){t=t||{},this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t,e){if(1!==this.width||1!==this.height){var i=this.rx?Math.min(this.rx,this.width/2):0,n=this.ry?Math.min(this.ry,this.height/2):0,o=this.width,s=this.height,r=e?this.left:-this.width/2,a=e?this.top:-this.height/2,l=0!==i||0!==n,h=.4477152502;t.beginPath(),t.moveTo(r+i,a),t.lineTo(r+o-i,a),l&&t.bezierCurveTo(r+o-h*i,a,r+o,a+h*n,r+o,a+n),t.lineTo(r+o,a+s-n),l&&t.bezierCurveTo(r+o,a+s-h*n,r+o-h*i,a+s,r+o-i,a+s),t.lineTo(r+i,a+s),l&&t.bezierCurveTo(r+h*i,a+s,r,a+s-h*n,r,a+s-n),t.lineTo(r,a+n),l&&t.bezierCurveTo(r,a+h*n,r+h*i,a,r+i,a),t.closePath(),this._renderBackground(t),this._renderStroke(t)}else t.fillRect(-.5,-.5,1,1)},toObject:function(t){return iws.util.extend(this.callSuper("toObject",t),{backgroundColor:this.backgroundColor})}}),iws.objectRect.fromObject=function(t,e){var i=new iws.objectRect(t);return e&&e(i),i}}("undefined"!=typeof exports&&exports),iws.util.extend(iws.objectRect.prototype,{_onCreateMouseDown:function(t){var e=this.canvas.getPointer(t);this.set({left:e.x,top:e.y,originX:"left",originY:"top",width:10,height:10})},_onCreateMouseMove:function(t){this.callSuper("_onCreateMouseMove",t)},_onCreateMouseUp:function(t){this.callSuper("_onCreateMouseUp",t)}}),function(t){"use strict";t.iws.objectStamp?iws.warn("iws.objectStamp is already defined."):(iws.objectStamp=iws.util.createInheritClass(function(){this.initialize.apply(this,arguments)},iws.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,fontStyle:!0,text:!0},type:"stamp",margin:.2,stroke:"red",strokeWidth:4,fontColor:"red",fontSize:40,fontWeight:"800",fontFamily:'"Jeju Gothic","Malgun Gothic","맑은 고딕",dotum,"돋움",sans-serif',text:"APPROVE",initialize:function(t){t||(t={}),t.stampColor&&(t.stroke=t.stampColor,t.fontColor=t.stampColor),this.callSuper("initialize",t)},_set:function(t,e){this.callSuper("_set",t,e),t in this._dimensionAffectingProps&&this.setCoords()},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,-i),t.lineTo(e,-i),t.lineTo(e,i),t.lineTo(-e,i),t.lineTo(-e,-i),t.closePath()}},_render:function(t,e,i){var n=e?this.left:-this.width/2,o=e?this.top:-this.height/2;t.globalAlpha=.9;var s=this.strokeWidth*this.baseScale*this.fontSize/40;t.lineWidth=s,t.strokeStyle=this.stroke,t.strokeRect(n,o,this.width,this.height),t.fillStyle=this.fontColor;var r=this.fontSize*this.baseScale*this.margin;t.fillText(this.text,n+r,o+this.height-2*r),this._stroke(t),this._renderStroke(t)},render:function(t,e,i){if(this.visible){t.save(),this.baseScale=i,t.textBaseline="alphabetic",t.font=[this.fontStyle,this.fontWeight,this.fontSize*this.baseScale+"px",this.fontFamily].join(" ");var n=this.fontSize*this.baseScale*this.margin;this.height=this.fontSize*this.baseScale+2*n,this.width=t.measureText(this.text).width+2*n,this.setCoords(),this.mouseDownPos&&(this.set({left:this.mouseDownPos.x-this.width/2}).set({top:this.mouseDownPos.y-this.height/2}),this.mouseDownPos=void 0),e||this.transform(t),this._render(t),t.restore()}},toObject:function(t){return iws.util.extend(this.callSuper("toObject",t),{text:this.text,fontColor:this.fontColor,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle})}}),iws.objectStamp.fromObject=function(t,e){var i=new iws.objectStamp(t);return e&&e(i),i})}("undefined"!=typeof exports?exports:this),iws.util.extend(iws.objectStamp.prototype,{_onCreateMouseDown:function(t){var e=this.canvas.getPointer(t);this.mouseDownPos=e},_onCreateMouseMove:function(t){var e=this.canvas.getPointer(t);this.set({left:e.x-this.width/2}).set({top:e.y-this.height/2})},_onCreateMouseUp:function(t){this.setCoords()}}),function(t){"use strict";var e=t.iws||(t.iws={}),i=e.util.extend;e.util.clone,e.util.toFixed,e.Object.NUM_FRACTION_DIGITS;if(e.objectText)e.warn("iws.Text is already defined");else{var n=e.Object.prototype.stateProperties.concat();n.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight"),e.objectText=e.util.createInheritClass(function(){this.initialize.apply(this,arguments)},e.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,fontStyle:!0,lineHeight:!0,text:!0,charSpacing:!0,textAlign:!0,strokeWidth:!0,width:!0,height:!0},_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]+/g,type:"text",fontColor:"rgb(0,0,0)",fontSize:40,fontWeight:"normal",fontFamily:'"Jeju Gothic","Malgun Gothic","맑은 고딕",dotum,"돋움",sans-serif',textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.2,stateProperties:n,stroke:null,shadow:null,charSpacing:0,minWidth:40,dynamicMinWidth:40,__cachedLines:null,baseScale:1,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.ctx=document.createElement("canvas").getContext("2d"),this.initBehavior(),this.setControlsVisibility({tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0})},_render:function(t){this._setOpacity(t),this._setShadow(t),this._setupCompositeOperation(t),this._renderBackground(t),this._setStrokeStyles(t),this._renderText(t),this._renderTextDecoration(t)},_renderText:function(t){this._renderTextFill(t),this._renderTextStroke(t)},_setTextStyles:function(t){t.textBaseline="alphabetic",t.font=[this.fontStyle,this.fontWeight,this.fontSize*this.baseScale+"px",this.fontFamily].join(" ")},_getTextHeight:function(){for(var t=0,e=0,i=this._textLines.length;e<i;e++)t+=this._getHeightOfLine();return t},_getTextWidth:function(t){for(var e=this._getLineWidth(t,0),i=1,n=this._textLines.length;i<n;i++){var o=this._getLineWidth(t,i);o>e&&(e=o)}return e},_getNonTransformedDimensions:function(){return{x:this.width,y:this.height}},_renderChars:function(t,e,i,n,o){var s,r,a=t.slice(0,-4);if(this[a].toLive){var l=-this.width/2+this[a].offsetX||0,h=-this.height/2+this[a].offsetY||0;e.save(),e.translate(l,h),n-=l,o-=h}if(e.beginPath(),e.rect(-this.width/2,-this.height/2,this.width,this.height),e.clip(),0!==this.charSpacing)for(var c=this._getWidthOfCharSpacing(),u=0,p=(i=i.split("")).length;u<p;u++)s=i[u],r=e.measureText(s).width+c,e[t](s,n,o),n+=r>0?r:0;else e[t](i,n,o);this[a].toLive&&e.restore()},_renderTextLine:function(t,e,i,n,o,s){var r=this._getLineWidth(e,s);if("justify"!==this.textAlign||this.width<r)this._renderChars(t,e,i,n,o,s);else for(var a,l=i.split(/\s+/),h=0,c=this._getWidthOfWords(e,l.join(""),s,0),u=this.width-c,p=l.length-1,d=p>0?u/p:0,f=0,g=0,m=l.length;g<m;g++){for(;" "===i[h]&&h<i.length;)h++;a=l[g],this._renderChars(t,e,a,n+f,o,s,h),f+=this._getWidthOfWords(e,a,s,h)+d,h+=a.length}},_getWidthOfWords:function(t,e){var i=t.measureText(e).width;return 0!==this.charSpacing&&(i+=e.split("").length*this._getWidthOfCharSpacing()),i>0?i:0},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},isEmptyStyles:function(){return!0},_renderTextCommon:function(t,e){for(var i=0,n=this._getLeftOffset(),o=this._getTopOffset(),s=0,r=this._textLines.length;s<r;s++){var a=this._getHeightOfLine(t,s),l=a/this.lineHeight,h=this._getLineWidth(t,s),c=this._getLineLeftOffset(h);this._renderTextLine(e,t,this._textLines[s],n+c,o+i+l,s),i+=a}},_renderTextFill:function(t){t.fillStyle=this.fontColor,this._renderTextCommon(t,"fillText")},_renderTextStroke:function(t){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())},_getHeightOfLine:function(){return this.fontSize*this.baseScale*this.lineHeight},_getLineLeftOffset:function(t){return"center"===this.textAlign?(this.width-t)/2:"right"===this.textAlign?this.width-t:0},_clearCache:function(){this.__lineWidths=[]},_getLineWidth:function(t,e){if(this.__lineWidths[e])return-1===this.__lineWidths[e]?this.width:this.__lineWidths[e];var i,n=this._textLines[e];return i=""===n?0:this._measureLine(t,e),this.__lineWidths[e]=i,i&&"justify"===this.textAlign&&n.split(/\s+/).length>1&&(this.__lineWidths[e]=-1),i},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.baseScale*this.charSpacing/1e3:0},_measureLine:function(t,e){var i,n=this._textLines[e],o=t.measureText(n).width,s=0;return 0!==this.charSpacing&&(s=(n.split("").length-1)*this._getWidthOfCharSpacing()),(i=o+s)>0?i:0},_renderTextDecoration:function(t){if(this.textDecoration){var e=this.height/2,i=this,n=[];this.textDecoration.indexOf("underline")>-1&&n.push(.85),this.textDecoration.indexOf("line-through")>-1&&n.push(.43),this.textDecoration.indexOf("overline")>-1&&n.push(-.12),n.length>0&&function(n){var o,s,r,a,l,h,c,u=0,p=i.fontSize*this.baseScale;for(o=0,s=i._textLines.length;o<s;o++){for(l=i._getLineWidth(t,o),h=i._getLineLeftOffset(l),c=i._getHeightOfLine(t,o),r=0,a=n.length;r<a;r++)t.fillRect(i._getLeftOffset()+h,u+n[r]*p-e,l,p/15);u+=c}}(n)}},render:function(t,e,i){if(this.visible){t.save(),this.baseScale=i,this._setTextStyles(t),this._textLines=this._splitTextIntoLines(),this._clearCache(),this.width<this.getMinWidth()&&(this.width=this.getMinWidth());var n=this._getTextHeight();this.height<n&&(this.height=n),this.setCoords(),this.drawSelectionBackground(t),e||this.transform(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this._render(t),t.restore(),this.drawDelete(t)}},_getWidthOfSpace:function(t,e){if(this.__widthOfSpace[e])return this.__widthOfSpace[e];var i=this._textLines[e],n=this._getWidthOfWords(t,i,e,0),o=this.width-n,s=i.length-i.replace(this._reSpacesAndTabs,"").length,r=Math.max(o/s,t.measureText(" ").width);return this.__widthOfSpace[e]=r,r},_wrapText:function(t,e){var i,n=e.split(this._reNewline),o=[];for(i=0;i<n.length;i++)o=o.concat(this._wrapLine(t,n[i],i));return o},_getWidthOfChar:function(t,e,i,n){if(!this._isMeasuring&&"justify"===this.textAlign&&this._reSpacesAndTabs.test(e))return this._getWidthOfSpace(t,i);t.save();var o=this._applyCharStylesGetWidth(t,e,i,n);return 0!==this.charSpacing&&(o+=this._getWidthOfCharSpacing()),t.restore(),o>0?o:0},_measureText:function(t,e,i,n){var o=0;n=n||0;for(var s=0,r=e.length;s<r;s++)o+=this._getWidthOfChar(t,e[s],i,s+n);return o},_wrapLine:function(t,e,i){var n=0,o=[],s="",r=e.split(" "),a="",l=0,h=0,c=!0,u=this._getWidthOfCharSpacing();function p(t,e,i){var n=[],o="",s="";if(i.measureText(t).width>e){for(var r=0;r<t.length;r++)o+=t[r],i.measureText(o).width>e&&(n.push(s),o=t[r]),s=o;n.push(s)}else n.push(t);return n}for(var d=[],f=0;f<r.length;f++){p(r[f],this.width,t).forEach(function(t){d.push(t)})}r=d;for(f=0;f<r.length;f++)a=r[f],l=t.measureText(a).width,a.length,(n+=h+l-u)>=this.width&&!c?(o.push(s),s="",n=l,c=!0):n+=u,c||(s+=" "),s+=a,h=t.measureText(" ").width,0,c=!1;return f&&o.push(s),o},_wrapLine_backup:function(t,e,i){for(var n=0,o=[],s="",r=e.split(" "),a="",l=0,h=0,c=0,u=!0,p=this._getWidthOfCharSpacing(),d=0;d<r.length;d++)a=r[d],l=t.measureText(a).width,a.length,(n+=h+l-p)>=this.width&&!u?(o.push(s),s="",n=l,u=!0):n+=p,u||(s+=" "),s+=a,h=t.measureText(" ").width,0,u=!1,l>c&&(c=l);function f(t,e,i){var n=[],o="",s="";if(i.measureText(t).width>e){for(var r=0;r<t.length;r++)o+=t[r],i.measureText(o).width>e&&(n.push(s),o=t[r]),s=o;n.push(s)}else n.push(t);return n}d&&o.push(s);var g=[];for(d=0;d<o.length;d++){f(s=o[d],this.width,t).forEach(function(t){g.push(t)})}return g},_splitTextIntoLines:function(){var t=this.textAlign;this.ctx.save(),this._setTextStyles(this.ctx),this.textAlign="left";var e=this._wrapText(this.ctx,this.text);return this.textAlign=t,this.ctx.restore(),this._textLines=e,this._styleMap=this._generateStyleMap(),e},_generateStyleMap:function(){for(var t=0,e=0,i=0,n={},o=0;o<this._textLines.length;o++)"\n"===this.text[i]&&o>0?(e=0,i++,t++):" "===this.text[i]&&o>0&&(e++,i++),n[o]={line:t,offset:e},i+=this._textLines[o].length,e+=this._textLines[o].length;return n},toObject:function(t){return i(this.callSuper("toObject",t),{text:this.text,fontColor:this.fontColor,backgroundColor:this.backgroundColor,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle})},_set:function(t,e){this.callSuper("_set",t,e),t in this._dimensionAffectingProps&&this.setCoords()},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)}}),e.objectText.fromObject=function(t,i){var n=new e.objectText(t);return i&&i(n),n}}}("undefined"!=typeof exports?exports:this),iws.util.extend(iws.objectText.prototype,{initBehavior:function(){this.initSelect(),this.initDeselect(),this.initMousedownHandler(),this.initMouseupHandler(),this.initDoubleClickSimulation(),this.initTextClickHandler()},initSelect:function(){this.observe("selected",function(t){setTimeout(function(){this.selected=!0}.bind(this),100)})},initDeselect:function(){this.observe("deselected",function(t){this.selected=!1})},initMousedownHandler:function(){this.observe("mouseDown",function(t){var e=this.canvas.getPointer(t);this.__mousedownX=e.x,this.__mousedownY=e.y,this.__isMousedown=!0,this.__lastSelected=this.selected})},_isObjectMoved:function(t){var e=this.canvas.getPointer(t);return this.__mousedownX!==e.x||this.__mousedownY!==e.y},initMouseupHandler:function(){this.observe("mouseUp",function(t){this.__isMousedown=!1,this._isObjectMoved(t)||(this.__lastSelected&&!this.__corner&&this.fire("textClick",t),this.selected=!0)})},initTextClickHandler:function(){this.observe("textClick",function(){this.visible=!1,this.active=!1,this.canvas.renderAll();var t=this.fontSize*this.baseScale,e=this.text,i=$('<textarea class="annotText" wrap="hard"></textarea>');i.val(this.text),i.css({left:this.left,top:this.top,width:this.width,height:this.height+2,"font-family":this.fontFamily,"font-size":t+"px",color:this.fontColor,background:this.backgroundColor,position:"absolute","line-height":1.2,border:"0 none white",padding:0,outline:"none","IME-MODE":"active"}).appendTo($(this.canvas.pageContainer));var n=this;i.on("focusout blur",function(t){var o=$(this).val();""!=o&&(n.set("text",$(this).val()),n.set("width",i.width()),n.set("height",i.height())),n.visible=!0,n.active=!0,n.canvas.renderAll(),e!==o&&n.canvas.fire("object:modified",{target:n}),console.log("focusout exit"),$(this).remove()}),setTimeout(function(){i.focus()},1)})},initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.observe("mouseDown",this.onMouseDown.bind(this))},onMouseDown:function(t){this.__newClickTime=+new Date;var e=this.canvas.getPointer(t);this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e},isDoubleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()}}),iws.toolbar.annotation=function(t){this.page=t,this.initialize()},iws.toolbar.annotation.prototype={mappingParam:{fillColor:"backgroundColor",strokeColor:"stroke",fontColor:"fontColor",stampText:"text",stampText2:"text",stampText3:"text",stampText4:"text",stampColor2:"stampColor",stampColor3:"stampColor",stampColor4:"stampColor",stampFontSize:"fontSize",stampFontSize2:"fontSize",stampFontSize3:"fontSize",stampFontSize4:"fontSize",fillColor_marker:"backgroundColor",strokeColor_line:"stroke",strokeWidth_line:"strokeWidth",strokeColor_arrow:"stroke",strokeWidth_arrow:"strokeWidth",strokeColor_ellipse:"stroke",strokeWidth_ellipse:"strokeWidth",fillColor_ellipse:"backgroundColor",strokeColor_rect:"stroke",strokeWidth_rect:"strokeWidth"},mappingObject:{path:"annotDrawFree",line:"annotDrawLine",rect:"annotDrawRect",text:"annotDrawText",ellipse:"annotDrawEllipse",arrowLine:"annotDrawArrowLine",imageCheckV:"annotDrawCheckV",imageCheckX:"annotDrawCheckX",stamp:"annotDrawStamp",marker:"annotDrawMarker"},configProperty:{strokeWidth:{value:".js-selected-properties-stroke-width-value",parent:".js-selected-properties-stroke-width"},strokeColor:{value:".js-selected-properties-stroke-color-value",parent:".js-selected-properties-stroke-color"},fillColor:{value:".js-selected-properties-fill-color-value",parent:".js-selected-properties-fill-color"},backgroundColor:{value:".js-selected-properties-background-color-value",parent:".js-selected-properties-background-color"},fontFamily:{value:".js-selected-properties-font-family-value",parent:".js-selected-properties-font-family"},fontColor:{value:".js-selected-properties-font-color-value",parent:".js-selected-properties-font-color"},fontSize:{value:".js-selected-properties-font-size-value",parent:".js-selected-properties-font-size"},fontStyle:{value:".js-selected-properties-font-style-value",parent:".js-selected-properties-font-style"},fontWeight:{value:".js-selected-properties-font-weight-value",parent:".js-selected-properties-font-weight"},stampText:{value:".js-selected-properties-stamp-text-value",parent:".js-selected-properties-stamp-text"},stampColor:{value:".js-selected-properties-stamp-color-value",parent:".js-selected-properties-stamp-color"},stampText2:{value:".js-selected-properties-stamp-text-value2",parent:".js-selected-properties-stamp-text2"},stampColor2:{value:".js-selected-properties-stamp-color-value2",parent:".js-selected-properties-stamp-color2"},stampText3:{value:".js-selected-properties-stamp-text-value3",parent:".js-selected-properties-stamp-text3"},stampColor3:{value:".js-selected-properties-stamp-color-value3",parent:".js-selected-properties-stamp-color3"},stampText4:{value:".js-selected-properties-stamp-text-value4",parent:".js-selected-properties-stamp-text4"},stampColor4:{value:".js-selected-properties-stamp-color-value4",parent:".js-selected-properties-stamp-color4"},stampFontSize:{value:".js-selected-properties-stamp-font-size-value",parent:".js-selected-properties-stamp-font-size"},stampFontSize2:{value:".js-selected-properties-stamp-font-size-value2",parent:".js-selected-properties-stamp-font-size2"},stampFontSize3:{value:".js-selected-properties-stamp-font-size-value3",parent:".js-selected-properties-stamp-font-size3"},stampFontSize4:{value:".js-selected-properties-stamp-font-size-value4",parent:".js-selected-properties-stamp-font-size4"},fillColor_marker:{value:".js-selected-properties-fill-color_marker-value",parent:".js-selected-properties-fill-color_marker"},strokeWidth_line:{value:".js-selected-properties-stroke-width_line-value",parent:".js-selected-properties-stroke-width_line"},strokeColor_line:{value:".js-selected-properties-stroke-color_line-value",parent:".js-selected-properties-stroke-color_line"},strokeWidth_arrow:{value:".js-selected-properties-stroke-width_arrow-value",parent:".js-selected-properties-stroke-width_arrow"},strokeColor_arrow:{value:".js-selected-properties-stroke-color_arrow-value",parent:".js-selected-properties-stroke-color_arrow"},strokeWidth_ellipse:{value:".js-selected-properties-stroke-width_ellipse-value",parent:".js-selected-properties-stroke-width_ellipse"},strokeColor_ellipse:{value:".js-selected-properties-stroke-color_ellipse-value",parent:".js-selected-properties-stroke-color_ellipse"},fillColor_ellipse:{value:".js-selected-properties-fill-color_ellipse-value",parent:".js-selected-properties-fill-color_ellipse"},strokeWidth_rect:{value:".js-selected-properties-stroke-width_rect-value",parent:".js-selected-properties-stroke-width_rect"},strokeColor_rect:{value:".js-selected-properties-stroke-color_rect-value",parent:".js-selected-properties-stroke-color_rect"}},initialize:function(){this._makeProperties(),this._makeToolbar(),this._setCustomBackground(),this._eventListen(),this._eachPropertyConfig(function(t,e){var i,n=$(e.value),o=this.properties[t].getValue();n.change((i=t,function(t){var e=this._getDomElementValue($(t.target)),n=this.properties[i].getValue(e);this.properties[i].setValue(n);var o=this.page.annotation&&this.page.annotation._selectedObjects();if(o&&1==o.length){var s=o[0];s&&(s.set(this.mappingParam[i]||i,n),this.page.fire("object:modified",{target:s}),this.page.renderAll())}}).bind(this)),this._setDomElementValue(n,o)}.bind(this)),this._updateProperty("",[])},getInitParam:function(t){var e={};return this._toolProperties(t).forEach(function(t){var i=this.mappingParam[t]||t,n=this.properties[t].getValue();e[i]=n}.bind(this)),e},_makeProperties:function(){var t,e,i,n,o,s=function(t){this.parser=t.parser||function(t){return t},this.initial=t.initial,this.save=t.save||function(){}},r={},a="iws.viewer.annotation.fillColor",l="iws.viewer.annotation.strokeColor",h="iws.viewer.annotation.strokeWidth",c="iws.viewer.annotation.fontFamily",u="iws.viewer.annotation.fontSize",p="iws.viewer.annotation.fontStyle",d="iws.viewer.annotation.fontWeight",f="iws.viewer.annotation.fontColor",g="iws.viewer.annotation.backgroundColor",m="iws.viewer.annotation.stamp.text",v="iws.viewer.annotation.stamp.color",b="iws.viewer.annotation.stamp.fontSize",w="iws.viewer.annotation.stamp.text2",y="iws.viewer.annotation.stamp.color2",x="iws.viewer.annotation.stamp.fontSize2",k="iws.viewer.annotation.stamp.text3",_="iws.viewer.annotation.stamp.color3",C="iws.viewer.annotation.stamp.fontSize3",S="iws.viewer.annotation.stamp.text4",A="iws.viewer.annotation.stamp.color4",T="iws.viewer.annotation.stamp.fontSize4",M="iws.viewer.annotation.fillColor_marker",E="iws.viewer.annotation.strokeColor_line",O="iws.viewer.annotation.strokeWidth_line",P="iws.viewer.annotation.strokeColor_arrow",j="iws.viewer.annotation.strokeWidth_arrow",I="iws.viewer.annotation.strokeColor_ellipse",D="iws.viewer.annotation.strokeWidth_ellipse",F="iws.viewer.annotation.fillColor_ellipse",R="iws.viewer.annotation.strokeColor_rect",B="iws.viewer.annotation.strokeWidth_rect",L={fillColor:new s({initial:localStorage.getItem(a)||"rgba(0, 0, 200, 0.2)",save:function(t){localStorage.setItem(a,t)}}),strokeColor:new s({initial:localStorage.getItem(l)||"red",save:function(t){localStorage.setItem(l,t)}}),strokeWidth:new s({initial:(o=localStorage.getItem(h),o&&isNaN(o)?1:o||2),parser:function(t){return parseInt(t,10)},save:function(t){localStorage.setItem(h,t)}}),fontFamily:new s({initial:localStorage.getItem(c)||'"Jeju Gothic","Malgun Gothic","맑은 고딕",dotum,"돋움",sans-serif',save:function(t){localStorage.setItem(c,t)}}),fontSize:new s({initial:localStorage.getItem(u)||16,parser:function(t){return parseInt(t,10)},save:function(t){localStorage.setItem(u,t)}}),fontStyle:new s({initial:localStorage.getItem(p)||"normal",save:function(t){localStorage.setItem(p,t)}}),fontWeight:new s({initial:localStorage.getItem(d)||"normal",save:function(t){localStorage.setItem(d,t)}}),fontColor:new s({initial:localStorage.getItem(f)||"black",save:function(t){localStorage.setItem(f,t)}}),backgroundColor:new s({initial:localStorage.getItem(g)||"rgba(240, 240, 240, 0.9)",save:function(t){localStorage.setItem(g,t)}}),stampText:new s({initial:localStorage.getItem(m)||"APPROVE",save:function(t){localStorage.setItem(m,t)}}),stampColor:new s({initial:localStorage.getItem(v)||"red",save:function(t){localStorage.setItem(v,t)}}),stampFontSize:new s({initial:localStorage.getItem(b)||40,parser:function(t){return parseInt(t,10)},save:function(t){localStorage.setItem(b,t)}}),stampText2:new s({initial:localStorage.getItem(w)||"CANCEL",save:function(t){localStorage.setItem(w,t)}}),stampColor2:new s({initial:localStorage.getItem(y)||"red",save:function(t){localStorage.setItem(y,t)}}),stampFontSize2:new s({initial:localStorage.getItem(x)||40,parser:function(t){return parseInt(t,10)},save:function(t){localStorage.setItem(x,t)}}),stampText3:new s({initial:localStorage.getItem(k)||"APPROVE",save:function(t){localStorage.setItem(k,t)}}),stampColor3:new s({initial:localStorage.getItem(_)||"red",save:function(t){localStorage.setItem(_,t)}}),stampFontSize3:new s({initial:localStorage.getItem(C)||40,parser:function(t){return parseInt(t,10)},save:function(t){localStorage.setItem(C,t)}}),stampText4:new s({initial:localStorage.getItem(S)||"APPROVE",save:function(t){localStorage.setItem(S,t)}}),stampColor4:new s({initial:localStorage.getItem(A)||"red",save:function(t){localStorage.setItem(A,t)}}),stampFontSize4:new s({initial:localStorage.getItem(T)||40,parser:function(t){return parseInt(t,10)},save:function(t){localStorage.setItem(T,t)}}),fillColor_marker:new s({initial:localStorage.getItem(M)||"rgba(255, 255, 0, 0.3)",save:function(t){localStorage.setItem(M,t)}}),strokeColor_line:new s({initial:localStorage.getItem(E)||"red",save:function(t){localStorage.setItem(E,t)}}),strokeWidth_line:new s({initial:(n=localStorage.getItem(O),n&&isNaN(n)?1:n||2),parser:function(t){return parseInt(t,10)},save:function(t){localStorage.setItem(O,t)}}),strokeColor_arrow:new s({initial:localStorage.getItem(P)||"red",save:function(t){localStorage.setItem(P,t)}}),strokeWidth_arrow:new s({initial:(i=localStorage.getItem(j),i&&isNaN(i)?1:i||2),parser:function(t){return parseInt(t,10)},save:function(t){localStorage.setItem(j,t)}}),strokeColor_ellipse:new s({initial:localStorage.getItem(I)||"red",save:function(t){localStorage.setItem(I,t)}}),strokeWidth_ellipse:new s({initial:(e=localStorage.getItem(D),e&&isNaN(e)?1:e||2),parser:function(t){return parseInt(t,10)},save:function(t){localStorage.setItem(D,t)}}),fillColor_ellipse:new s({initial:localStorage.getItem(F)||"rgba(255, 255, 0, 0.2)",save:function(t){localStorage.setItem(F,t)}}),strokeColor_rect:new s({initial:localStorage.getItem(R)||"red",save:function(t){localStorage.setItem(R,t)}}),strokeWidth_rect:new s({initial:(t=localStorage.getItem(B),t&&isNaN(t)?1:t||2),parser:function(t){return parseInt(t,10)},save:function(t){localStorage.setItem(B,t)}})};for(var z in L)if(L.hasOwnProperty(z)){var Y=L[z],W=this;r[z]=function(t,e){var i=e.initial;return{getValue:function(n){return void 0!==n&&(i=e.parser(n),W.fire("property:change",t)),i},setValue:function(t){e.save(t)}}}(z,Y)}this.properties=r},_setDomElementValue:function(t,e){if(null!==e&&"none"!=e){if(t.is('[type="checkbox"]'))t.prop("checked",e==t.val());else{if(t.attr("class"),t.hasClass("js-selected-properties-font-size-value")){var i=[];if(t.children("option").each(function(){i.push($(this).val())}),!$.isNumeric(e))return;var n=Math.round(e).toString();if(-1===i.indexOf(n)){var o=$('<option value="'+n+'">'+n+"</option>");t.append(o)}}t.val((e||"").toString())}t.trigger("change")}},_getDomElementValue:function(t){return t.is('[type="checkbox"]')?t.prop("checked")?t.val():"normal":t.val()},_toolProperties:function(t){switch(t){case"annotDrawFree":return["strokeColor","strokeWidth"];case"annotDrawArrowLine":return["strokeColor_arrow","strokeWidth_arrow"];case"annotDrawLine":return["strokeColor_line","strokeWidth_line"];case"annotDrawEllipse":return["fillColor_ellipse","strokeColor_ellipse","strokeWidth_ellipse"];case"annotDrawRect":return["fillColor","strokeColor_rect","strokeWidth_rect"];case"annotDrawText":return["fontColor","backgroundColor","fontFamily","fontStyle","fontSize","fontWeight"];case"annotDrawStamp":return["stampText","stampColor","stampFontSize"];case"annotDrawStamp2":return["stampText2","stampColor2","stampFontSize2"];case"annotDrawStamp3":return["stampText3","stampColor3","stampFontSize3"];case"annotDrawStamp4":return["stampText4","stampColor4","stampFontSize4"];case"annotDrawMarker":return["fillColor_marker"];default:return[]}},_eachPropertyConfig:function(t){for(var e in this.configProperty)this.configProperty.hasOwnProperty(e)&&t(e,this.configProperty[e])},_updateDOM:function(t){var e=t.target&&this.mappingObject[t.target.type]||"",i={};this._toolProperties(e).forEach(function(e){var n=this.mappingParam[e]||e;i[e]=t.target.get(n)}.bind(this)),this._updateProperty(e,i)},_updateProperty:function(t,e){var i=this._toolProperties(t);this._eachPropertyConfig(function(n,o){if(i.indexOf(n)>=0){if(void 0!==e&&-1!==t.indexOf("annotDrawStamp"))return void this.property.querySelectorAll(o.parent).forEach(function(t){t.style.display="none"});this.property.querySelectorAll(o.parent).forEach(function(t){t.style.display=""}),void 0!==e&&this._setDomElementValue($(o.value),e[n])}else this.property.querySelectorAll(o.parent).forEach(function(t){t.style.display="none"})}.bind(this))},_makeToolbar:function(){this.annotToolbarEl=iws.util.makeElement("div",{class:"pop-annotation"}),this.page.pageContainer.appendChild(this.annotToolbarEl),this.__makeDomTool(),this.__makeDomProperty();var t=this;$(this.annotToolbarEl).append('<a class="handle ui-slideouttab-handle-rounded">Tool</a>'),this.tabSlide=$(this.annotToolbarEl).tabSlideOut({clickScreenToClose:!1,offset:10,tabLocation:"right",offsetReverse:!1,handleOffsetReverse:!1,onOpenStart:function(){t.fire("annotation_tab","openStart")},onOpen:function(){t.page.setTrackMode("annotSelect"),t.fire("annotation_tab","open")},onClose:function(){t.page.annotation&&t.page.annotation.deActiveAll(),t.fire("annotation_tab","close"),t.page.setTrackMode("move")}}),$(this.annotToolbarEl).filter(".ui-slideouttab-panel").css("background-color","transparent")},_setCustomBackground:function(){if(iws&&"TheK"==iws.manufacturer){var t=iws.util.string.combinePath(this.page.path,"/img/custom/iws.viewer.annotation_thek.png");$('<style>.pop-annotation .popbtn { background: #ffffff; padding: 1px;}.pop-annotation .popbtn_blank { background: #ffffff; padding: 1px; background-position: -234px 0px;}.pop-annotation .popbtn:hover { border: 1px solid rgb(58,122,220); border-radius: 4px;}.pop-annotation .popbtn.toggled { /*background: #000000;*/ /*border: 1px solid rgb(58,122,220);*/}.pop-annotation .popbtn>i{ width: 26px; height: 26px;}.pop-annotation [class^="vIcon-"] {background: url('+t+') no-repeat top left;}.pop-annotation [class^="vIcon-Blank"]{ width: 26px; height: 26px; background-position: -234px 0px;}.pop-annotation .popbtn#annotSelect>i {background-position: 0px 0px;}.pop-annotation .popbtn#annotDelete>i {background-position: -26px 0px;}.pop-annotation .popbtn#annotDrawFree>i {background-position: -52px 0px;}.pop-annotation .popbtn#annotDrawLine>i {background-position: -78px 0px;}.pop-annotation .popbtn#annotDrawArrowLine>i {background-position: -104px 0px;}.pop-annotation .popbtn#annotDrawEllipse>i {background-position: -130px 0px;}.pop-annotation .popbtn#annotDrawMarker>i {background-position: -156px 0px;}.pop-annotation .popbtn#annotDrawRect>i {background-position: -182px 0px;}.pop-annotation .popbtn#annotDrawText>i {background-position: -208px 0px;}.pop-annotation .popbtn#annotDrawCheckV>i {background-position: -260px 0px;}.pop-annotation .popbtn#annotDrawCheckX>i {background-position: -286px 0px;}.pop-annotation .popbtn#annotDrawStamp>i {background-position: -312px 0px;}.pop-annotation .popbtn#annotDrawStamp2>i {background-position: -338px 0px;}.pop-annotation .popbtn#annotDrawStamp3>i {background-position: -364px 0px;}.pop-annotation .popbtn#annotDrawStamp4>i {background-position: -390px 0px;}.pop-annotation .popbtn.toggled#annotSelect>i {background-position: 0px -26px;}.pop-annotation .popbtn.toggled#annotDelete>i {background-position: -26px -26px;}.pop-annotation .popbtn.toggled#annotDrawFree>i {background-position: -52px -26px;}.pop-annotation .popbtn.toggled#annotDrawLine>i {background-position: -78px -26px;}.pop-annotation .popbtn.toggled#annotDrawArrowLine>i {background-position: -104px -26px;}.pop-annotation .popbtn.toggled#annotDrawEllipse>i {background-position: -130px -26px;}.pop-annotation .popbtn.toggled#annotDrawMarker>i {background-position: -156px -26px;}.pop-annotation .popbtn.toggled#annotDrawRect>i {background-position: -182px -26px;}.pop-annotation .popbtn.toggled#annotDrawText>i {background-position: -208px -26px;}.pop-annotation .popbtn.toggled#annotDrawCheckV>i {background-position: -260px -26px;}.pop-annotation .popbtn.toggled#annotDrawCheckX>i {background-position: -286px -26px;}.pop-annotation .popbtn.toggled#annotDrawStamp>i {background-position: -312px -26px;}.pop-annotation .popbtn.toggled#annotDrawStamp2>i {background-position: -338px -26px;}.pop-annotation .popbtn.toggled#annotDrawStamp3>i {background-position: -364px -26px;}.pop-annotation .popbtn.toggled#annotDrawStamp4>i {background-position: -390px -26px;}</style>').appendTo(this.annotToolbarEl)}},__makeDomTool:function(){this.poptool=iws.util.makeElement("div",{class:"pop-tool",id:"pop-tool",draggable:"false"}),this.annotToolbarEl.appendChild(this.poptool);var t='<div class="popbtn-group-v"><button class="popbtn" id="annotSelect" title="선택"><i class="vIcon-Select"></i></button><button class="popbtn" id="annotDelete" title="삭제"><i class="vIcon-Delete"></i></button><button class="popbtn" id="annotDrawFree" title="자유선"><i class="vIcon-DrawFree"></i></button><button class="popbtn" id="annotDrawLine" title="라인"><i class="vIcon-DrawLine"></i></button><button class="popbtn" id="annotDrawArrowLine" title="화살표"><i class="vIcon-DrawArrowLine"></i></button><button class="popbtn" id="annotDrawEllipse" title="원"><i class="vIcon-DrawEllipse"></i></button><button class="popbtn" id="annotDrawMarker" title="형광펜"><i class="vIcon-DrawMarker"></i></button><button class="popbtn" id="annotDrawRect" title="사각"><i class="vIcon-DrawRect"></i></button><button class="popbtn" id="annotDrawText" title="메모"><i class="vIcon-DrawText"></i></button><button class="popbtn_blank" id="space" style="disabled:disabled;/*visibility:hidden*/"><i class="vIcon-Blank"></i></button><button class="popbtn" id="annotDrawCheckV" title="V 체크"><i class="vIcon-DrawCheckV"></i></button><button class="popbtn" id="annotDrawCheckX" title="X 체크"><i class="vIcon-DrawCheckX"></i></button><button class="popbtn" id="annotDrawStamp" title="스템프"><i class="vIcon-DrawStamp1"></i></button><button class="popbtn" id="annotDrawStamp2" title="스템프"><i class="vIcon-DrawStamp2"></i></button>';iws&&"TheK"==iws.manufacturer&&(t+='<button class="popbtn" id="annotDrawStamp3" title="스템프"><i class="vIcon-DrawStamp3"></i></button><button class="popbtn" id="annotDrawStamp4" title="스템프"><i class="vIcon-DrawStamp4"></i></button>'),t+="</div>",this.poptool.innerHTML=t},__makeDomProperty:function(){this.property=iws.util.makeElement("div",{class:"pop-property"}),this.annotToolbarEl.appendChild(this.property),this.property.innerHTML='<div class="property-group-v"><dl><dt class="js-selected-properties-stroke-width">선 두께</dt><dd class="js-selected-properties-stroke-width"><select class="js-selected-properties-stroke-width-value property-span"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></dd><dt class="js-selected-properties-stroke-color">선 색상</dt><dd class="js-selected-properties-stroke-color"><input type="text" class="js-selected-properties-stroke-color-value property-span js-color"/></dd><dt class="js-selected-properties-font-color">글자색상</dt><dd class="js-selected-properties-font-color"><input type="text" class="js-selected-properties-font-color-value property-span js-color"/></dd><dt class="js-selected-properties-background-color">배경색상</dt><dd class="js-selected-properties-background-color"><input type="text" class="js-selected-properties-background-color-value property-span js-color"/></dd><dt class="js-selected-properties-font-size">글자크기</dt><dd class="js-selected-properties-font-size"><select type="text" class="js-selected-properties-font-size-value property-span"><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="14">14</option><option value="16">16</option><option value="20">20</option><option value="24">24</option><option value="36">36</option><option value="48">48</option><option value="64">64</option><option value="72">72</option></select></dd><dt class="js-selected-properties-font-style">이텔릭체</dt><dd class="js-selected-properties-font-style"><input class="popbtn js-selected-properties-font-style-value" type="checkbox" value="italic"/><i class="icon-italic"></i></dd><dt class="js-selected-properties-font-weight">두껍게</dt><dd class="js-selected-properties-font-weight"><input class="popbtn js-selected-properties-font-weight-value" type="checkbox" value="bold"/><i class="icon-bold"></i></dd><dt class="js-selected-properties-stamp-text">스템프글자</dt><dd class="js-selected-properties-stamp-text"><input class="poptext js-selected-properties-stamp-text-value" type="text"/></dd><dt class="js-selected-properties-stamp-color">스템프색상</dt><dd class="js-selected-properties-stamp-color"><input type="text" class="js-selected-properties-stamp-color-value property-span js-color"/></dd><dt class="js-selected-properties-stamp-font-size">글자크기</dt><dd class="js-selected-properties-stamp-font-size"><select type="text" class="js-selected-properties-stamp-font-size-value property-span"><option value="10">10</option><option value="20">20</option><option value="30">30</option><option value="40">40</option><option value="60">60</option><option value="80">80</option></select></dd><dt class="js-selected-properties-stamp-text2">스템프글자</dt><dd class="js-selected-properties-stamp-text2"><input class="poptext js-selected-properties-stamp-text-value2" type="text"/></dd><dt class="js-selected-properties-stamp-color2">스템프색상</dt><dd class="js-selected-properties-stamp-color2"><input type="text" class="js-selected-properties-stamp-color-value2 property-span js-color"/></dd><dt class="js-selected-properties-stamp-font-size2">글자크기</dt><dd class="js-selected-properties-stamp-font-size2"><select type="text" class="js-selected-properties-stamp-font-size-value2 property-span"><option value="10">10</option><option value="20">20</option><option value="30">30</option><option value="40">40</option><option value="60">60</option><option value="80">80</option></select></dd><dt class="js-selected-properties-stamp-text3">스템프글자</dt><dd class="js-selected-properties-stamp-text3"><input class="poptext js-selected-properties-stamp-text-value3" type="text"/></dd><dt class="js-selected-properties-stamp-color3">스템프색상</dt><dd class="js-selected-properties-stamp-color3"><input type="text" class="js-selected-properties-stamp-color-value3 property-span js-color"/></dd><dt class="js-selected-properties-stamp-font-size3">글자크기</dt><dd class="js-selected-properties-stamp-font-size3"><select type="text" class="js-selected-properties-stamp-font-size-value3 property-span"><option value="10">10</option><option value="20">20</option><option value="30">30</option><option value="40">40</option><option value="60">60</option><option value="80">80</option></select></dd><dt class="js-selected-properties-stamp-text4">스템프글자</dt><dd class="js-selected-properties-stamp-text4"><input class="poptext js-selected-properties-stamp-text-value4" type="text"/></dd><dt class="js-selected-properties-stamp-color4">스템프색상</dt><dd class="js-selected-properties-stamp-color4"><input type="text" class="js-selected-properties-stamp-color-value4 property-span js-color"/></dd><dt class="js-selected-properties-stamp-font-size4">글자크기</dt><dd class="js-selected-properties-stamp-font-size4"><select type="text" class="js-selected-properties-stamp-font-size-value4 property-span"><option value="10">10</option><option value="20">20</option><option value="30">30</option><option value="40">40</option><option value="60">60</option><option value="80">80</option></select></dd><dt class="js-selected-properties-fill-color_marker">채우기색상</dt><dd class="js-selected-properties-fill-color_marker"><input type="text" class="js-selected-properties-fill-color_marker-value property-span js-color"/></dd><dt class="js-selected-properties-stroke-width_line">선 두께</dt><dd class="js-selected-properties-stroke-width_line"><select class="js-selected-properties-stroke-width_line-value property-span"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></dd><dt class="js-selected-properties-stroke-color_line">선 색상</dt><dd class="js-selected-properties-stroke-color_line"><input type="text" class="js-selected-properties-stroke-color_line-value property-span js-color"/></dd></dl><dt class="js-selected-properties-stroke-width_arrow">선 두께</dt><dd class="js-selected-properties-stroke-width_arrow"><select class="js-selected-properties-stroke-width_arrow-value property-span"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></dd><dt class="js-selected-properties-stroke-color_arrow">선 색상</dt><dd class="js-selected-properties-stroke-color_arrow"><input type="text" class="js-selected-properties-stroke-color_arrow-value property-span js-color"/></dd></dl><dt class="js-selected-properties-stroke-width_ellipse">선 두께</dt><dd class="js-selected-properties-stroke-width_ellipse"><select class="js-selected-properties-stroke-width_ellipse-value property-span"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></dd><dt class="js-selected-properties-stroke-color_ellipse">선 색상</dt><dd class="js-selected-properties-stroke-color_ellipse"><input type="text" class="js-selected-properties-stroke-color_ellipse-value property-span js-color"/></dd></dl><dt class="js-selected-properties-fill-color_ellipse">채우기색상</dt><dd class="js-selected-properties-fill-color_ellipse"><input type="text" class="js-selected-properties-fill-color_ellipse-value property-span js-color"/></dd><dt class="js-selected-properties-stroke-width_rect">선 두께</dt><dd class="js-selected-properties-stroke-width_rect"><select class="js-selected-properties-stroke-width_rect-value property-span"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></dd><dt class="js-selected-properties-stroke-color_rect">선 색상</dt><dd class="js-selected-properties-stroke-color_rect"><input type="text" class="js-selected-properties-stroke-color_rect-value property-span js-color"/></dd></dl><dt class="js-selected-properties-fill-color">채우기색상</dt><dd class="js-selected-properties-fill-color"><input type="text" class="js-selected-properties-fill-color-value property-span js-color"/></dd></div>',$(this.property).find(".js-selected-properties-stamp-text-value").on("keydown",function(t){t.stopPropagation()}),$(this.property).find(".js-selected-properties-stamp-text-value").on("keyup",function(t){$(this).trigger("change")}),$(this.property).find(".js-color").each(function(t,e){var i=$(e);"function"==typeof i.spectrum&&i.spectrum({showPalette:!0,palette:[["white","black"],["blue","CornflowerBlue"],["red","Coral"],["yellow","Chartreuse"],["Grey","Green"],["Peru","Pink"],["rgb(255, 128, 0)","hsv 100 70 50"]],showAlpha:!0,preferredFormat:"rgb"}),i.change(function(){var t=i.val();"function"==typeof i.spectrum&&i.spectrum("get")!=t&&i.spectrum("set",t)})})},_eventListen:function(){var t=this;this.poptool.querySelectorAll(".popbtn").forEach(function(e){e.addEventListener("click",function(){if("annotDelete"==e.id){var i=t.page.annotation,n=i&&i._selectedObjects();n&&n.length>0&&(i._annotations.remove.apply(i._annotations,n),t.page.renderAll(),i&&i.setSelectMode())}else t.page.setTrackMode(e.id,!0)})}),this.page.observe("after:render",function(){this.page.imageCtrl.isValid()?(this.poptool.querySelectorAll("*").forEach(function(t){t.removeAttribute("disabled")}),this.property.querySelectorAll("*").forEach(function(t){t.removeAttribute("disabled")})):(this.poptool.querySelectorAll("*").forEach(function(t){t.setAttribute("disabled",!0)}),this.property.querySelectorAll("*").forEach(function(t){t.setAttribute("disabled",!0)}))}.bind(this)),this.page.observe("annotation:visible",function(t){"show"===t&&(this.annotToolbarEl.style.display="block"),"hide"===t&&(this.annotToolbarEl.style.display="none")}.bind(this)),this.page.observe("mouseTrackChange",function(t){this.poptool.querySelectorAll(".popbtn").forEach(function(t){t.removeClass("toggled")});var e=this.poptool.querySelector("#"+t);e&&e.addClass("toggled"),this.fire("tool:change",t)}.bind(this)),this.observe("tool:change",function(t){"annotSelect"!==t&&(this.page.annotation&&this.page.annotation.deActiveAll(),this.page.renderAll()),this._updateProperty(t)}),this.page.observe("object:selected",function(t){1===t.selecteds.length?this._updateDOM(t):this._updateProperty("")}.bind(this)),this.page.observe("selection:cleared",function(t){this._updateProperty("")}.bind(this)),this.page.observe("object:removed",function(t){this._updateProperty("")}.bind(this)),this.page.observe("page:setRawData",function(t){}.bind(this))},destroy:function(){$(this.property).find(".js-color").each(function(t,e){var i=$(e);"function"==typeof i.spectrum&&i.spectrum("destroy")})}},iws.util.extend(iws.toolbar.annotation.prototype,iws.Observable),iws.toolbar.masking=function(t){this.page=t,this.initialize()},iws.toolbar.masking.prototype={initialize:function(){this._makeToolbar(),this._setCustomBackground(),this._eventListen()},_makeToolbar:function(){this.maskingToolbarEl=iws.util.makeElement("div",{class:"pop-masking"}),this.page.pageContainer.appendChild(this.maskingToolbarEl),this.__makeDomTool();var t=this;$(this.maskingToolbarEl).append('<a class="handle ui-slideouttab-handle-rounded">Masking</a>'),this.tabSlide=$(this.maskingToolbarEl).tabSlideOut({clickScreenToClose:!1,offset:54,tabLocation:"right",offsetReverse:!1,handleOffsetReverse:!1,onOpen:function(){t.page.masking.setSelectMode()},onClose:function(){t.page.masking&&t.page.masking.deActiveAll(),t.page.setTrackMode("move")}}),$(this.maskingToolbarEl).filter(".ui-slideouttab-panel").css("background-color","transparent")},__makeDomTool:function(){this.poptool=iws.util.makeElement("div",{class:"pop-tool",id:"pop-tool",draggable:"false"}),this.maskingToolbarEl.appendChild(this.poptool),this.poptool.innerHTML='<div id="pop-command"><div class="popbtn-group-v"><button class="popbtn" id="maskingSelect" title="Select masking"><i class="vIcon-maskingSelect"></i></button><button class="popbtn" id="maskingDelete" title="Select masking"><i class="vIcon-maskingDelete"></i></button><button class="popbtn" id="maskingBlack" title="black mask"><i class="vIcon-maskingBlack"></i></button><button class="popbtn" id="maskingRed" title="red mask"><i class="vIcon-maskingRed"></i></button></div></div>'},_setCustomBackground:function(){if(iws&&"TheK"==iws.manufacturer){var t=iws.util.string.combinePath(this.page.path,"/img/custom/iws.viewer.annotation_thek.png");$('<style>.pop-masking .popbtn { background: #ffffff; padding: 1px;}.pop-masking .popbtn:hover { border: 1px solid rgb(58,122,220); }.pop-masking .popbtn.toggled { /*background: #000000;*/ /*border: 1px solid rgb(58,122,220);*/}.pop-masking .popbtn>i{ width: 26px; height: 26px;}.pop-masking [class^="vIcon-"] {background: url('+t+") no-repeat top left;}.pop-masking .popbtn#maskingSelect>i {background-position: 0px -52px;}.pop-masking .popbtn#maskingDelete>i {background-position: -26px -52px;}.pop-masking .popbtn#maskingBlack>i {background-position: -52px -52px;}.pop-masking .popbtn#maskingRed>i {background-position: -78px -52px;}.pop-masking .popbtn.toggled#maskingSelect>i {background-position: 0px -78px;}.pop-masking .popbtn.toggled#maskingDelete>i {background-position: -26px -78px;}.pop-masking .popbtn.toggled#maskingBlack>i {background-position: -52px -78px;}.pop-masking .popbtn.toggled#maskingRed>i {background-position: -78px -78px;}</style>").appendTo(this.maskingToolbarEl)}},_eventListen:function(){var t=this;this.poptool.querySelectorAll(".popbtn").forEach(function(e){e.addEventListener("click",function(){if("maskingDelete"==e.id){var i=t.page.masking,n=i&&i._selectedObjects();n&&n.length>0&&(i._maskings.remove.apply(i._maskings,n),t.page.renderAll(),i&&i.setSelectMode())}else t.page.setTrackMode(e.id,!0)})}),this.page.observe("after:render",function(){this.page.imageCtrl.isValid()?this.poptool.querySelectorAll("*").forEach(function(t){t.removeAttribute("disabled")}):this.poptool.querySelectorAll("*").forEach(function(t){t.setAttribute("disabled",!0)})}.bind(this)),this.page.observe("masking:visible",function(t){"show"===t&&(this.maskingToolbarEl.style.display="block"),"hide"===t&&(this.maskingToolbarEl.style.display="none")}.bind(this)),this.page.observe("mouseTrackChange",function(t){this.poptool.querySelectorAll(".popbtn").forEach(function(t){t.removeClass("toggled")});var e=this.poptool.querySelector("#"+t);e&&e.addClass("toggled"),this.fire("tool:change",t)}.bind(this)),this.page.annotToolbar&&this.page.annotToolbar.observe("annotation_tab",function(e){if(this.page.useMasking)switch(e){case"openStart":$(t.maskingToolbarEl).tabSlideOut("isOpen")&&$(t.maskingToolbarEl).tabSlideOut("close"),t.maskingToolbarEl.style.display="none";break;case"close":t.maskingToolbarEl.style.display="block"}}),this.observe("tool:change",function(t){})},destroy:function(){}},iws.util.extend(iws.toolbar.masking.prototype,iws.Observable),iws.toolbar.page=function(t){this.page=t,this.initialize()},iws.toolbar.page.prototype={toolbarMargin:8,trackModeMap:["move","range","glass","annotSelect","annotPath","annotLine","annotRect","annotText"],trackModeMapping:{move:"trackMove",range:"trackRange",glass:"trackGlass"},initialize:function(){this._makeToolbar(),this.page.observe("toolbar:visible",function(t){this.toolbarContainerEl.style.display=t?"block":"none"}.bind(this))},isVisible:function(){return"none"!==this.toolbarContainerEl.style.display},height:function(){return this.toolbarContainerEl.clientHeight},_makeToolbar:function(){this.toolbarContainerEl=iws.util.makeElement("div",{class:"pageToolbar_Container"}),this.page.pageContainer.parentElement.insertBefore(this.toolbarContainerEl,this.page.pageContainer),this.toolbarFrameEl=iws.util.makeElement("div",{class:"pageToolbar_Frame"}),this.toolbarContainerEl.appendChild(this.toolbarFrameEl),this.__makeToolbarLeft(),this.__makeToolbarZoom(),this.__makeToolbarRight()},__makeToolbarLeft:function(){this.toolbarLeft=iws.util.makeElement("div",{class:"pageToolbar"}),this.toolbarFrameEl.appendChild(this.toolbarLeft),this.toolbarLeft.innerHTML='<button id="scalePlus" type="button" class="pageToolbarButton" title="ZoomIn"><i class="pageToolbarButton_scalePlus"></i></button><button id="scaleMinus" type="button" class="pageToolbarButton" title="ZoomOut"><i class="pageToolbarButton_scaleMinus"></i></button><div class="pageToolbarButtonSeparator"></div><button id="fitWidth" type="button" class="pageToolbarButton" title="Fix Width"><i class="pageToolbarButton_fitWidth"></i></button><button id="fitHeight" type="button" class="pageToolbarButton" title="Fix Height"><i class="pageToolbarButton_fitHeight"></i></button><button id="fitAuto" type="button" class="pageToolbarButton" title="Fix Auto"><i class="pageToolbarButton_fitAuto"></i></button><div class="pageToolbarButtonSeparator"></div><button id="rotate270" type="button" class="pageToolbarButton" title="Rotate 270"><i class="pageToolbarButton_rotate270"></i></button><button id="rotate90" type="button" class="pageToolbarButton" title="Rotate 90"><i class="pageToolbarButton_rotate90"></i></button><button id="rotate180" type="button" class="pageToolbarButton" title="Rotate 180"><i class="pageToolbarButton_rotate180"></i></button><div class="pageToolbarButtonSeparator"></div><div class="trackModeGroup" style="display:inline-block;"> <button id="trackMove" type="button" class="pageToolbarButton" title="Move Image" value="move"><i class="pageToolbarButton_trackMove"></i> </button><button id="trackRange" type="button" class="pageToolbarButton" title="Select area" value="range"><i class="pageToolbarButton_trackRange"></i> </button><button id="trackGlass" type="button" class="pageToolbarButton" title="Magnifying Glass" value="glass"><i class="pageToolbarButton_trackGlass"></i> </button></div>',this.toolbarLeft.querySelector("#scalePlus").addEventListener("click",function(){this.page.zoomIn()}.bind(this),!1),this.toolbarLeft.querySelector("#scaleMinus").addEventListener("click",function(){this.page.zoomOut()}.bind(this),!1),this.toolbarLeft.querySelector("#fitWidth").addEventListener("click",function(){this.page.setFitMode({name:"width"})}.bind(this),!1),this.toolbarLeft.querySelector("#fitHeight").addEventListener("click",function(){this.page.setFitMode({name:"height"})}.bind(this),!1),this.toolbarLeft.querySelector("#fitAuto").addEventListener("click",function(){this.page.setFitMode({name:"auto"})}.bind(this),!1),this.toolbarLeft.querySelector("#rotate270").addEventListener("click",function(){this.page.setRotate(270)}.bind(this),!1),this.toolbarLeft.querySelector("#rotate90").addEventListener("click",function(){this.page.setRotate(90)}.bind(this),!1),this.toolbarLeft.querySelector("#rotate180").addEventListener("click",function(){this.page.setRotate(180)}.bind(this),!1),this.toolbarLeft.querySelector("#trackMove").addEventListener("click",function(){this.page.setTrackMode("move")}.bind(this),!1),this.toolbarLeft.querySelector("#trackRange").addEventListener("click",function(){this.page.setTrackMode("range")}.bind(this),!1),this.toolbarLeft.querySelector("#trackGlass").addEventListener("click",function(){this.page.setTrackMode("glass")}.bind(this),!1),this.buttonTrackModeGroup=this.toolbarLeft.querySelector(".trackModeGroup"),this.page.observe("mouseTrackChange",function(t){if(this.trackModeMap.indexOf(t)>=0){this.buttonTrackModeGroup.querySelectorAll(".pageToolbarButton").forEach(function(t){t.removeClass("toggled")});var e=this.buttonTrackModeGroup.querySelector("#"+this.trackModeMapping[t]);e&&e.addClass("toggled")}}.bind(this))},__makeToolbarZoom:function(){this.toolbarZoom=iws.util.makeElement("div",{class:"pageToolbar"}),this.toolbarFrameEl.appendChild(this.toolbarZoom),this.toolbarZoom.innerHTML='<span id="scaleSelectContainer" class="iws-dropdownToolbarButton"><select id="scaleSelect" title="Zoom" tabindex="23" data-l10n-id="zoom"><option id="pageAutoOption"    title="" value="auto" >Fit auto</option><option id="pageFitWidthOption" title="" value="width" >Fit Width</option><option id="pageFitHeightOption" title="" value="height" >Fit Height</option><option id="customScaleOption" title="" value="custom">0%</option><option title="" value="0.25"  >25%</option><option title="" value="0.5"   >50%</option><option title="" value="0.75"  >75%</option><option title="" value="1"     >100%</option><option title="" value="1.25"  >125%</option><option title="" value="1.5"   >150%</option><option title="" value="2"     >200%</option><option title="" value="3"     >300%</option><option title="" value="4"     >400%</option></select></span>';var t=this;function e(){this.toolbarZoom.querySelector("#scaleSelect");var t=this.page.getFitMode(),e="";switch(t.name){case"width":case"height":case"auto":e=t.name;break;case"scale":e=t.scale}if(!function(t){for(var e=this.toolbarZoom.querySelector("#scaleSelect").options,i=!1,n=0,o=e.length;n<o;n++){var s=e[n];s.value===t?(s.selected=!0,i=!0):s.selected=!1}return i}.call(this,e)){var i=this.toolbarZoom.querySelector("#customScaleOption");i.textContent="scale",i.selected=!0}}this.toolbarZoom.querySelector("#scaleSelect").addEventListener("change",function(e){switch(this.value){case"auto":case"width":case"height":t.page.setFitMode({name:this.value});break;default:t.page._zoom({name:"custom",scale:this.value})}},!1),this.page.observe("page:zoom",e.bind(this)),this.page.observe("page:fitMode",e.bind(this))},__makeToolbarRight:function(){this.toolbarRight=iws.util.makeElement("div",{class:"pageToolbar size"}),this.toolbarFrameEl.appendChild(this.toolbarRight),this.toolbarRight.innerHTML='<button id="fullDisplay" type="button" class="pageToolbarButton" title="Full screen"><i class="pageToolbarButton_FullScreen"></i></button>',this.toolbarRight.querySelector("#fullDisplay").addEventListener("click",function(){iws.util.fullscreen.toggleFullScreen(this.page.fullScreenEl)}.bind(this),!1),iws.util.fullscreen.onFullScreenChange(function(t){t?($(this.toolbarRight).children("button#fullDisplay").children("i").removeClass("pageToolbarButton_FullScreen"),$(this.toolbarRight).children("button#fullDisplay").children("i").addClass("pageToolbarButton_OriginalScreen")):($(this.toolbarRight).children("button#fullDisplay").children("i").removeClass("pageToolbarButton_OriginalScreen"),$(this.toolbarRight).children("button#fullDisplay").children("i").addClass("pageToolbarButton_FullScreen"))}.bind(this))}},function(){"use strict";iws.multiPage=iws.util.createInheritClass(function(){iws.config=iws.config||{},iws.config.annotation=iws.config.annotation||{},iws.config.annotation.textarea_wrap="hard","TheK"==iws.manufacturer||(iws.config.annotation.line="scale"),console.log("iws.multiPage start."+(iws.manufacturer||"free")),this.status="created",this.initialize.apply(this,arguments)},iws.Observable,{thumb:null,page:null,media:null,thumbShow:!0,saveType:"annotation",useAnnotation:!1,useMasking:!1,useFilter:!1,selectAllVisible:!0,useSelectAll:!0,reSampleUse:!0,reSampleRate:.8,reSampleFilter:"convolveFloat32",printAutoFit:!1,printPageMargine:!1,authority:{annotation:"editable",masking:"editable"},readOnlyOne:!1,pageType:"image",thumbShowMinSize:420,customThumbIcon:{},annotationSaveMode:"useSaveButton",useBookMarkClick:!0,rangeType:"ZoomIn",initialize:function(t,e){e||(e={}),this._initOptions(e),this._initWrapperElement(t),iws.imgSrc={checkV:iws.util.string.combinePath(this.path,"/img/iws.annotation.check.V.png"),checkX:iws.util.string.combinePath(this.path,"/img/iws.annotation.check.X.png")},iws.util.loadImage(iws.imgSrc.checkV,function(t){t?iws.imgSrc.checkVElement=t:this._showError('Loading file error! check option "path".')}.bind(this)),iws.util.loadImage(iws.imgSrc.checkX,function(t){t?iws.imgSrc.checkXElement=t:this._showError('Loading file error! check option "path".')}.bind(this)),this._addThumb(),this._addPage(),this._addMedia(),this.mainToolbar=new iws.toolbar.multiPage(this),this.setTrackMode("move"),this.visible("annotation",this.useAnnotation?"show":"hide"),this.visible("masking",this.useMasking?"show":"hide"),this.visible("filter",this.useFilter?"show":"hide"),this._initEvent(),void 0!=this.selectVisible&&this.setSelectVisible(this.selectVisible),this.resizer=new iws.util.resize(this.fullScreenEl,this._reSize.bind(this)),this._reSize(),$(t).on("destroyed",function(){"created"===this.status&&(console.log("viewer destroyed"),this.destroy&&this.destroy())}.bind(this)),$.event.special.destroyed={remove:function(t){t.handler&&t.handler()}}},_initWrapperElement:function(t){this.wrapperEl=t,$(this.wrapperEl).on("contextmenu",function(t){return!1}),this.fullScreenEl=iws.util.makeElement("div",{class:"multiPage-fullScreen"}),this.wrapperEl.appendChild(this.fullScreenEl),this.pageContainerEl=iws.util.makeElement("div",{class:"multiPage-container"}),this.fullScreenEl.appendChild(this.pageContainerEl),this.loadProgressEl=iws.util.makeElement("div",{class:"multiPage-progress progress-position"}),this.loadProgressEl.innerHTML='<div class="w3-grey w3-round w3-tiny">    <div class="progressbar w3-container w3-blue w3-round" style="width:25%;box-sizing:border-box">25%</div>  </div>',this.fullScreenEl.appendChild(this.loadProgressEl),this.pageFrameEl=iws.util.makeElement("div",{class:"multiPage-frame"}),this.pageContainerEl.appendChild(this.pageFrameEl),this.thumbContainer=iws.util.makeElement("div",{class:"iws_thumbnailContainer iws_thumbnailContainer_show"}),this.thumbSelectAllEl=iws.util.makeElement("label",{class:"thumb_selectAll_hide"}),this.thumbSelectAllEl.innerHTML='<input type="checkbox" class="selectall"> 전체 선택',this.thumbContainer.appendChild(this.thumbSelectAllEl),this.thumbEl=iws.util.makeElement("div",{class:"iws-thumbnail iws-thumbnail_full"}),this.thumbContainer.appendChild(this.thumbEl),this.pageFrameEl.appendChild(this.thumbContainer),this.pageEl=iws.util.makeElement("div",{class:"iws-format-image iws-page iws-page_move"}),this.pageFrameEl.appendChild(this.pageEl),this.mediaEl=iws.util.makeElement("div",{class:"iws-format-media iws-page iws-page_move iws-page-hide"}),this.pageFrameEl.appendChild(this.mediaEl)},_initOptions:function(t){for(var e in t)this[e]=t[e]},_addThumb:function(){var t={debug:!1,direction:"V",path:this.path,beforehandLoad:!1,plugin:!1,printAutoFit:this.printAutoFit,printPageMargine:this.printPageMargine,printMark:this.printMark,useBookMark:this.useBookMark,useBookMarkClick:this.useBookMarkClick,useThumbNumber:this.useThumbNumber,readOnlyOne:this.readOnlyOne,useMulti:this.useMulti,customFormatIcon:this.customFormatIcon,annotationSaveMode:this.annotationSaveMode,authority:this.authority};this.thumb=iwsT.Thumbnail(this.thumbEl,t)},_addPage:function(){var t={autoResize:!1,fitMode:this.fitMode,path:this.path,visibleToolbar:!1,useAnnotation:this.useAnnotation,useMasking:this.useMasking,useFilter:this.useFilter,reSampleUse:this.reSampleUse,reSampleRate:this.reSampleRate,reSampleFilter:this.reSampleFilter,imgSrc:this.imgSrc,authority:this.authority,rangeType:this.rangeType};this.page=new iws.PageAnnotation(this.pageEl,t),this.page.pageKey="",this.page.observe("mouseTrackChange",function(t){this.fire("mouseTrackChange",t)}.bind(this)),this.page.observe("page:zoom",function(t){this.fire("page:zoom",t)}.bind(this)),this.page.observe("page:fitMode",function(t){this.fire("page:fitMode",t)}.bind(this)),this.page.observe("page:swipe_left",function(t){this.pageNext()}.bind(this)),this.page.observe("page:swipe_right",function(t){this.pagePrev()}.bind(this))},_addMedia:function(){this.media=new iws.media(this.mediaEl,{})},_getHandlingType:function(){return $(this.pageEl).hasClass("iws-page-hide")?"media":$(this.mediaEl).hasClass("iws-page-hide")?"image":void 0},_initEvent:function(){var t=this;this.thumbSelectAllEl.querySelectorAll(".selectall").forEach(function(e){e.addEventListener("click",function(){for(var i=t.thumb.pageCount(),n=0;n<i;n++)t.thumb.setSelect(n,e.checked)})});var e=this.thumb.getObserver(),i=this;function n(){var t=this.thumb.findIndex(this.page.pageKey);if(-1!==t){var e=this.thumb.getItem(t);"useSaveButton"==this.annotationSaveMode?e.annotation.setTemp(this.page.getAnnotation()):e.annotation.setData(this.page.getAnnotation()),e.annotModified=!0}}function o(){var t=this.thumb.findIndex(this.page.pageKey);if(-1!==t){var e=this.thumb.getItem(t);"useSaveButton"==this.annotationSaveMode?e.masking.setTemp(this.page.getMasking()):e.masking.setData(this.page.getMasking()),e.annotModified=!0}}e.observe("splited",function(t){this.fire("pageNumberChange",this.pageIndex)}.bind(this)),e.observe("append-start",function(){this.loadProgressEl.style.display="block",this.fire("append-start")}.bind(this)),e.observe("append-progress",function(t,e){var i=this.loadProgressEl.querySelector(".progressbar");i.style.width=(t+1)/e*100+"%",i.innerHTML=(t+1).toString()+" / "+e.toString(),this.fire("append-progress",t,e)}.bind(this)),e.observe("append-complete",function(){this.loadProgressEl.style.display="none",this.fire("append-complete")}.bind(this)),e.observe("thumbLoad",function(t,e,i){}.bind(this)),e.observe("pageLoad",function(t,e,i){-1!=this.thumb.findIndex(this.page.pageKey)&&t===i||("image"==this._getHandlingType()&&("useSaveButton"==this.annotationSaveMode?this._tempInit():this._backup()),this._setPage(t)),this.fire("thumbClick",t,e.clickType)}.bind(this)),e.observe("thumbMouseClick",function(t){this.fire("thumbMouseClick",t)}.bind(this)),e.observe("thumbMouseDblClick",function(t){this.fire("thumbMouseDblClick",t)}.bind(this)),e.observe("bookmarkMouseClick",function(t,e){this.fire("bookmarkMouseClick",t,e)}.bind(this)),e.observe("annotationLoaded",function(t){if(t==this.thumb.findIndex(this.page.pageKey)){var e=this.thumb.getItem(t);e&&(this.page.setAngle(e.angle),this.page.setAnnotation(e.annotation.getData()),this.page.setMasking(e.masking.getData()))}}.bind(this)),e.observe("error",function(t){i._showError(t)}),e.observe("loadpage_start",function(t){iws.util.run_waitMe($(i.pageEl),"roundBounce")}),e.observe("loadpage_end",function(t){iws.util.hide_waitMe($(i.pageEl))}),this.page.observe("mouse:drawRanged",function(t){this.fire("mouse:drawRanged",t)}.bind(this)),this.page.observe("object:removed",function(){n.apply(this)}.bind(this)),this.page.observe("object:modified",function(){n.apply(this)}.bind(this)),this.page.observe("masking:removed",function(){o.apply(this)}.bind(this)),this.page.observe("masking:modified",function(){o.apply(this)}.bind(this))},_setPage:function(t){if(t>=0){var e=this.thumb.getItem(t);if(this.pageType="video"==e.type||"audio"==e.type?"media":e.type,this.pageType!==this._getHandlingType()&&this.fire("changeType",this.pageType),"image"==e.type){$(this.pageEl).toggleClass("iws-page-hide",!1),$(this.mediaEl).toggleClass("iws-page-hide",!0),this.media.clear(),this.page.pageKey=e.uniqueId,this.page.setInfo(e.pageInfo);var i=(n=this.page,o=e,function(){n.setAnnotation(o.annotation.getData()),n.setMasking(o.masking.getData()),n.filter=o.filter||{},n.setFilter()});e.errorMsg.success?e.pageSrc&&""!=e.pageSrc?this.page.setSrc(e.pageSrc,e.pageInfo.width,e.pageInfo.height,e.angle,i):e.pagebuffer&&this.page.setRawData(e.pagebuffer,e.pageInfo.width,e.pageInfo.height,e.angle,i):this.page.setErrorMsg(e.errorMsg)}else"video"!=e.type&&"audio"!=e.type||($(this.mediaEl).toggleClass("iws-page-hide",!1),$(this.pageEl).toggleClass("iws-page-hide",!0),this.page.clear(),this.media.mediaKey=e.uniqueId,this.media.updateSource(e.mediaSource))}else this.media.clear(),this.page.clear();var n,o;this.fire("pageNumberChange",t)},_reSize:function(){var t=this.fullScreenEl.clientWidth,e=this.fullScreenEl.clientHeight,i=t,n=e;this.mainToolbar&&this.mainToolbar.isVisible()&&(n=e-this.mainToolbar.height()),this.pageContainerEl.style.width=i+"px",this.pageContainerEl.style.height=n+"px";var o=this.thumbShow;switch("show"==this.thumbShow&&t<this.thumbShowMinSize&&(o="hide"),o){case"show":this.thumbContainer.setAttribute("class","iws_thumbnailContainer iws_thumbnailContainer_show"),this.pageEl.removeClass("iws-page_full").removeClass("iws-page_hide").addClass("iws-page_move"),this.mediaEl.removeClass("iws-page_full").removeClass("iws-page_hide").addClass("iws-page_move");break;case"hide":this.thumbContainer.setAttribute("class","iws_thumbnailContainer iws_thumbnailContainer_hide"),this.pageEl.removeClass("iws-page_move").removeClass("iws-page_hide").addClass("iws-page_full"),this.mediaEl.removeClass("iws-page_move").removeClass("iws-page_hide").addClass("iws-page_full");break;case"max":this.thumbContainer.setAttribute("class","iws_thumbnailContainer iws_thumbnailContainer_max"),this.pageEl.removeClass("iws-page_full").removeClass("iws-page_move").addClass("iws-page_hide"),this.mediaEl.removeClass("iws-page_full").removeClass("iws-page_move").addClass("iws-page_hide")}this.page&&this.page._reSize(),this.media&&this.media.resize(),this.fire("resize",{width:t,height:e})},_showError:function(t){iws.util.showError(this.fullScreenEl,t)},clear:function(t){this.thumb.init(t),this.page.clear(),this.media&&this.media.clear(),this.fire("pageNumberChange",-1)},loadFile:function(t,e){this.clear(function(){this.appendFile(t,e)}.bind(this))},appendFile:function(t,e){var i=[];(t=Array.isArray(t)?t:[t]).forEach(function(t){i.push({type:"image",buffer:t})}),this.thumb.appendContents(i,e)},loadUrl:function(t,e){this.clear(function(){this.appendUrl(t,e)}.bind(this))},appendUrl:function(t,e){var i=[];(t=Array.isArray(t)?t:[t]).forEach(function(t){if("object"==typeof t){var e=$.extend({},{type:"image"},t);i.push(e)}else"string"==typeof t&&i.push({type:"image",url:t})}),this.thumb.appendContents(i,e)},appendBase64:function(t,e){var i=[];(t=Array.isArray(t)?t:[t]).forEach(function(t){i.push({type:"image",src:t})}),this.thumb.appendContents(i,e)},appendContents:function(t,e){this.thumb.appendContents(t,e)},print:function(){console.log("출력 시작"),"useSaveButton"==this.annotationSaveMode||this._backup();var t=!0;this.fire("beforePrint",function(e){void 0!==e&&(t=e,console.log("출력 진행여부 설정 : "+t))}),t?(console.log("출력 진행"),this.thumb.print()):console.log("출력 취소")},loadAnnotation:function(t,e){e=e||0,this.thumb.annotationLoad(t,e)},_tempInit:function(){var t=this.thumb.findIndex(this.page.pageKey);if(-1!==t){var e=this.thumb.getItem(t);e.annotation.setTemp(e.annotation.getData()),e.masking.setTemp(e.masking.getData()),e.annotModified=!1}},_backup:function(){var t=this.thumb.findIndex(this.page.pageKey);if(-1!==t){var e=this.thumb.getItem(t);e.annotation.setData(this.page.getAnnotation()),e.masking.setData(this.page.getMasking()),e.filter=this.page.filter,"useSaveButton"==this.annotationSaveMode&&(e.annotation.setTemp(this.page.getAnnotation()),e.masking.setTemp(this.page.getMasking()))}return t},__backup:function(t){t==this.thumb.findIndex(this.page.pageKey)&&"useSaveButton"!==this.annotationSaveMode&&this._backup()},saveAnnotation:function(){this._backup();this.thumb.annotationSave(function(t){var e=""!==t;if(this.fire("saveAnnotation",{success:e,annotation:t}),e)for(var i=0;i<this.thumb.pageCount();i++){this.thumb.getItem(i).annotModified=!1}}.bind(this))},saveImage:function(){this.thumb.pageSave(5,function(t,e){this.fire("saveImage",{success:t,byteArray:e})}.bind(this))},_zoom:function(t){this.page._zoom(t)},zoomIn:function(){this.page.zoomIn()},zoomOut:function(){this.page.zoomOut()},_changeKlass:function(t){return iws.util.getKlass(t.type,null,"object").fromObject(t)},_changeObject:function(t){return t.toObject()},rotate:function(t){var e=this;this.thumb.rotate(t,function(t,i){i.uniqueId===e.page.pageKey&&e.page.setRotate(t);var n=function(i,n){var o=e._changeKlass(n);if(90==t||270==t){var s=(r={x:i.pageInfo.width/2,y:i.pageInfo.height/2}).y-r.x;o._rotate(t,r),90==t?90==i.angle||270==i.angle?o._moveOffset({x:s,y:-s}):0!=i.angle&&180!=i.angle||o._moveOffset({x:-s,y:-s}):270==t&&(90==i.angle||270==i.angle?o._moveOffset({x:s,y:-s}):0!=i.angle&&180!=i.angle||o._moveOffset({x:s,y:s}))}else if(180==t)if(90==i.angle||270==i.angle){var r={y:i.pageInfo.width/2,x:i.pageInfo.height/2};o._rotate(t,r)}else if(0==i.angle||180==i.angle){r={x:i.pageInfo.width/2,y:i.pageInfo.height/2};o._rotate(t,r)}return e._changeObject(o)};i.annotation.getData().forEach(function(t,e){i.annotation.getData()[e]=n(i,t)}),i.masking.getData().forEach(function(t,e){i.masking.getData()[e]=n(i,t)})})},setAngle:function(t,e){var i=this.thumb.setAngle(t,e);return i&&this.thumb.getItem(t).uniqueId===this.page.pageKey&&this.page.setAngle(e),i},getAngle:function(t){return this.thumb.getAngle(t)},setFitMode:function(t){this.page.setFitMode(t)},getFitMode:function(){return this.page.getFitMode()},setTrackMode:function(t){this.page.setTrackMode(t)},pagePrev:function(){this.thumb.pageIndex=this.thumb.pageIndex-1},pageNext:function(){this.thumb.pageIndex=this.thumb.pageIndex+1},pageCount:function(){return this.thumb.pageCount()},showAnnotation:function(t){this.page.visible("annotation",t)},setSelectVisible:function(t){this.thumb.selectVisible=t},setSelectAllVisible:function(t){t?(this.thumbSelectAllEl.removeClass("thumb_selectAll_hide"),this.thumbSelectAllEl.addClass("thumb_selectAll"),this.thumbEl.removeClass("iws-thumbnail_full"),this.thumbEl.addClass("iws-thumbnail_move")):(this.thumbSelectAllEl.removeClass("thumb_selectAll"),this.thumbSelectAllEl.addClass("thumb_selectAll_hide"),this.thumbEl.removeClass("iws-thumbnail_move"),this.thumbEl.addClass("iws-thumbnail_full"))},showButton:function(t,e){this.fire("toolbar:buttonShow",t,e)},visible:function(t,e){if("toolbar"==t)$(this.wrapperEl).find(".multiPage-fullScreen").children(".pageToolbar_Container").css("display","hide"==e?"none":"block"),this.refresh();else if(-1!==t.indexOf("toolbar-")){var i=t.indexOf("toolbar-")+"toolbar-".length,n=t.substring(i,t.length);$(this.wrapperEl).find(".pageToolbar_Frame").children("."+n).css("display","hide"==e?"none":"")}else this.page.visible(t,e)},crop:function(t,e){this.page.crop(t,e)},destroy:function(){console.log("iws.multiPage destroy."),this.thumb.destroy(),this.page.destroy(),this.media.destroy(),$(this.fullScreenEl).remove(),this.status="destroyed"},refresh:function(){this._reSize()},addAnnotation:function(t){this.page.addAnnotation(t)},removeAnnotation:function(){this.page.removeAnnotation()},addMasking:function(t,e,i,n,o){this.page.addMasking(t,e,i,n,o)},removeMasking:function(){this.page.removeMasking()},setPrintAutoFit:function(t){this.printAutoFit=t,this.thumb.setOption({printAutoFit:t})},showFilter:function(t){return this.page.showFilter(t)},setSelect:function(t,e){this.thumb.setSelect(t,e)},getSelect:function(t){return this.thumb.getSelect(t)},setPrintString:function(t,e){this.thumb.setPrintString(t,e)},setPrintMark:function(t){this.thumb.setOption({printMark:t})},setBookmark:function(t,e){this.thumb.setBookmark(t,e)},getBookmark:function(t){return this.thumb.getBookmark(t)},setKey:function(t,e){this.thumb.setKey(t,e)},getKey:function(t){return this.thumb.getKey(t)},setCaption:function(t,e){this.thumb.setCaption(t,e)},getCaption:function(t){return this.thumb.getCaption(t)},setText:function(t,e){this.thumb.setText(t,e)},getText:function(t){return this.thumb.getText(t)},setAuthority:function(t,e){this.page.authority[t]=e,"editable"!==e?this.visible(t,"hide"):this.visible(t,this.useAnnotation?"show":"hide"),this.thumb.setOption({authority:this.page.authority}),this.page.renderAll(),this.thumb.each(function(t,e){this.thumb.drawAnnototation(e)}.bind(this))},getAuthority:function(){return this.page.authority},getAnnotationIs:function(t){this.__backup(t);var e=this.thumb.getItem(t);return!(!e||!(e.annotation.getData().length>0||e.masking.getData().length>0))},getAnnotationModified:function(t){this.__backup(t);var e=this.thumb.getItem(t);return!(!e||!e.annotModified)},getAnnotationData:function(t){return this.__backup(t),this.thumb.getAnnotationData(t)},setUseBookMark:function(t){this.thumb.setOption({useBookMark:t})},setFirstAutoClick:function(t){this.thumb.setOption({firstAutoClick:t})},getImageToBase64:function(t,e){this.__backup(t),this.thumb.getImageToBase64(t).then(function(t){e&&e({result:"success",src:t})},function(){e&&e({result:"false",src:""})})}});try{!Object.prototype.__defineGetter__&&Object.defineProperty({},"x",{get:function(){return!0}}).x&&(Object.defineProperty(Object.prototype,"__defineGetter__",{enumerable:!1,configurable:!0,value:function(t,e){Object.defineProperty(this,t,{get:e,enumerable:!0,configurable:!0})}}),Object.defineProperty(Object.prototype,"__defineSetter__",{enumerable:!1,configurable:!0,value:function(t,e){Object.defineProperty(this,t,{set:e,enumerable:!0,configurable:!0})}}))}catch(t){}iws.multiPage.prototype.__defineGetter__("pageIndex",function(){return this.thumb.pageIndex}),iws.multiPage.prototype.__defineSetter__("pageIndex",function(t){this.thumb.pageIndex=t})}(),iws.toolbar.multiPage=function(t){this.viewer=t,this.initialize()},iws.toolbar.multiPage.prototype={toolbarMargin:8,trackModeMap:["move","range","glass"],trackModeMapping:{move:"trackMove",range:"trackRange",glass:"trackGlass"},initialize:function(){this._makeToolbar()},isVisible:function(){return"none"!==this.toolbarContainerEl.style.display},height:function(){return this.toolbarContainerEl.clientHeight},_makeToolbar:function(){this.toolbarContainerEl=iws.util.makeElement("div",{class:"pageToolbar_Container"}),this.viewer.pageContainerEl.parentElement.insertBefore(this.toolbarContainerEl,this.viewer.pageContainerEl),this.toolbarFrameEl=iws.util.makeElement("div",{class:"pageToolbar_Frame"}),this.toolbarContainerEl.appendChild(this.toolbarFrameEl),this.__makeToolbarCommon(this.toolbarFrameEl),this.__makeToolbarPage(this.toolbarFrameEl),this.__makeToolbarMove(this.toolbarFrameEl),this.__makeToolbarZoom(this.toolbarFrameEl),this.__makeToolbarSize(this.toolbarFrameEl),this._setCustomBackground();var t=this;this.viewer.observe("resize",function(e){t.toolbarRight&&(e.width<800?t.toolbarRight.style.display="none":t.toolbarRight.style.display="inline-block"),e.width<560?t.toolbarCommon.style.display="none":t.toolbarCommon.style.display="inline-block",e.width<540?t.toolbarPage.style.display="none":t.toolbarPage.style.display="inline-block",t.toolbarPageCssOrigianl={toolbarPage:$(t.toolbarPage).css("display"),toolbarZoom:$(t.toolbarZoom).css("display")},t.viewer.fire("changeType",t.viewer.pageType)}),this.viewer.observe("toolbar:buttonShow",function(e,i){switch(console.log(e+" "+i),e){case"thumbnail":i?$(t.toolbarCommon).find("#thumbtoggle").css("display","inline-block"):$(t.toolbarCommon).find("#thumbtoggle").css("display","none"),i?$(t.toolbarCommon).find("#separator1").css("display","inline-block"):$(t.toolbarCommon).find("#separator1").css("display","none");break;case"openfile":i?$(t.toolbarCommon).find("#openfile").css("display","inline-block"):$(t.toolbarCommon).find("#openfile").css("display","none");break;case"print":i?$(t.toolbarCommon).find("#print").css("display","inline-block"):$(t.toolbarCommon).find("#print").css("display","none");break;case"save":i?$(t.toolbarCommon).find("#save").css("display","inline-block"):$(t.toolbarCommon).find("#save").css("display","none");break;case"select":i?$(t.toolbarCommon).find("#checkVisible").css("display","inline-block"):$(t.toolbarCommon).find("#checkVisible").css("display","none");break;case"delete":i?$(t.toolbarCommon).find("#delete").css("display","inline-block"):$(t.toolbarCommon).find("#delete").css("display","none");break;case"move":i?$(t.toolbarPage).find("#trackMove").css("display","inline-block"):$(t.toolbarPage).find("#trackMove").css("display","none");break;case"range":i?$(t.toolbarPage).find("#trackRange").css("display","inline-block"):$(t.toolbarPage).find("#trackRange").css("display","none");break;case"glass":i?$(t.toolbarPage).find("#trackGlass").css("display","inline-block"):$(t.toolbarPage).find("#trackGlass").css("display","none")}}),this.viewer.observe("changeType",function(e){"image"==e?($(t.toolbarPage).css("visibility","none"===t.toolbarPageCssOrigianl.toolbarPage?"hidden":"visible"),$(t.toolbarZoom).css("visibility","none"===t.toolbarPageCssOrigianl.toolbarZoom?"hidden":"visible")):"media"==e&&($(t.toolbarPage).css("visibility","hidden"),$(t.toolbarZoom).css("visibility","hidden"))})},_setCustomBackground:function(){var t=this.viewer.path;function e(e,i,n){var o=iws.util.string.combinePath(t,"/img/custom/iws.viewer.toolbar_thek.png");e.children("i").css("background",'url("'+o+'") no-repeat top left'),e.children("i").css("background-position",i),e.children("i").css("width","26px"),e.children("i").css("height","26px"),e.children("i").css("vertical-align","middle"),e.css("margin","0px 1.2px"),e.css("padding","0px"),e.hover(function(){$(this).children("i").css("background-position",n)},function(){$(this).children("i").css("background-position",i)})}iws&&"TheK"==iws.manufacturer&&($(this.toolbarFrameEl).find(".pageToolbarButtonSeparator").css("display","none"),$(this.toolbarCommon).css("margin-left","16px"),$(this.toolbarCommon).css("margin-right","0px"),$(this.toolbarPage).css("margin-left","0px"),e($(this.toolbarCommon).find("#print"),"0px 0px","0px -34px"),e($(this.toolbarCommon).find("#save"),"-28px 0px","-28px -34px"),e($(this.toolbarPage).find("#scalePlus"),"-56px 0px","-56px -34px"),e($(this.toolbarPage).find("#scaleMinus"),"-84px 0px","-84px -34px"),e($(this.toolbarPage).find("#fitWidth"),"-112px 0px","-112px -34px"),e($(this.toolbarPage).find("#fitHeight"),"-140px 0px","-140px -34px"),e($(this.toolbarPage).find("#fitAuto"),"-168px 0px","-168px -34px"),e($(this.toolbarPage).find("#rotate270"),"-196px 0px","-196px -34px"),e($(this.toolbarPage).find("#rotate90"),"-224px 0px","-224px -34px"),e($(this.toolbarPage).find("#rotate180"),"-252px 0px","-252px -34px"),e($(this.toolbarPage).find("#trackMove"),"-280px 0px","-280px -34px"),e($(this.toolbarPage).find("#trackRange"),"-308px 0px","-308px -34px"),e($(this.toolbarPage).find("#trackGlass"),"-336px 0px","-336px -34px"))},__makeToolbarCommon:function(t){this.toolbarCommon=iws.util.makeElement("div",{class:"pageToolbar common"}),t.appendChild(this.toolbarCommon),this.toolbarCommon.innerHTML='<button id="thumbtoggle" type="button" class="pageToolbarButton" title="Show thumbnail"><i class="pageToolbarButton_thumbtoggle"></i></button><div id="separator1" class="pageToolbarButtonSeparator"></div><button id="openfile" type="button" class="pageToolbarButton" title="Open file"><i class="pageToolbarButton_openfile"></i><input type="file" style="display:none;" id="openfile_input" name="files[]" multiple/></button><button id="print" type="button" class="pageToolbarButton" title="Print"><i class="pageToolbarButton_print"></i></button><button id="save" type="button" class="pageToolbarButton" title="Save"><i class="pageToolbarButton_save"></i></button><button id="checkVisible" type="button" class="pageToolbarButton" title="Show check"><i class="pageToolbarButton_checkVisible"></i></button><button id="delete" type="button" class="pageToolbarButton" title="Delete"><i class="pageToolbarButton_delete"></i></button>',this.toolbarCommon.querySelector("#thumbtoggle").addEventListener("click",function(){this.viewer.thumbShow="show"==this.viewer.thumbShow?"hide":"show",this.viewer._reSize()}.bind(this),!1),this.toolbarCommon.querySelector("#openfile").addEventListener("click",function(){this.toolbarCommon.querySelector("#openfile_input").value="",$(this.toolbarCommon.querySelector("#openfile_input")).click()}.bind(this),!1),this.toolbarCommon.querySelector("#openfile_input").addEventListener("click",function(){$(this.toolbarCommon.querySelector("#openfile_input")).click()}.bind(this),!1),this.toolbarCommon.querySelector("#openfile_input").addEventListener("change",function(t){var e=t.target.files,i=this.viewer,n=[],o=new iws.util.sync({callback:function(){console.log("File loaded."),i&&i.appendContents(n,function(){console.log("Load complete!")})}});Array.prototype.forEach.call(e,function(t){escape(t.name),t.type,(t.size/1024).toFixed(2).toString(),t.lastModifiedDate.toLocaleDateString();var e={file:t,callback:function(e){var i=new FileReader;i.onload=function(){var i={type:"image",buffer:this.result,caption:t.name+" ("+t.type+") - "+(t.size/1024).toFixed(2).toString()+" kb"};n.push(i),e&&e()},i.readAsArrayBuffer(this.file)}};o.addWork(e)})}.bind(this),!1),this.toolbarCommon.querySelector("#print").addEventListener("click",function(){console.log("툴바 출력 버튼 클릭"),this.viewer.print()}.bind(this),!1),this.toolbarCommon.querySelector("#save").addEventListener("click",function(){"image"===this.viewer.saveType?this.viewer.saveImage():"annotation"===this.viewer.saveType&&this.viewer.saveAnnotation()}.bind(this),!1),this.toolbarCommon.querySelector("#checkVisible").addEventListener("click",function(){this.viewer.setSelectVisible(!this.viewer.thumb.selectVisible),this.viewer.useSelectAll&&this.viewer.setSelectAllVisible(this.viewer.thumb.selectVisible)}.bind(this),!1),this.toolbarCommon.querySelector("#delete").addEventListener("click",function(){this.viewer.thumb.remove()}.bind(this),!1)},__makeToolbarPage:function(t){this.toolbarPage=iws.util.makeElement("div",{class:"pageToolbar page"}),t.appendChild(this.toolbarPage),this.toolbarPage.innerHTML='<button id="scalePlus" type="button" class="pageToolbarButton" title="ZoomIn"><i class="pageToolbarButton_scalePlus"></i></button><button id="scaleMinus" type="button" class="pageToolbarButton" title="ZoomOut"><i class="pageToolbarButton_scaleMinus"></i></button><div class="pageToolbarButtonSeparator"></div><button id="fitWidth" type="button" class="pageToolbarButton" title="Fix Width"><i class="pageToolbarButton_fitWidth"></i></button><button id="fitHeight" type="button" class="pageToolbarButton" title="Fix Height"><i class="pageToolbarButton_fitHeight"></i></button><button id="fitAuto" type="button" class="pageToolbarButton" title="Fix Auto"><i class="pageToolbarButton_fitAuto"></i></button><div class="pageToolbarButtonSeparator"></div><button id="rotate270" type="button" class="pageToolbarButton" title="Rotate 270"><i class="pageToolbarButton_rotate270"></i></button><button id="rotate90" type="button" class="pageToolbarButton" title="Rotate 90"><i class="pageToolbarButton_rotate90"></i></button><button id="rotate180" type="button" class="pageToolbarButton" title="Rotate 180"><i class="pageToolbarButton_rotate180"></i></button><div class="pageToolbarButtonSeparator"></div><div class="trackModeGroup" style="display:inline-block;"> <button id="trackMove" type="button" class="pageToolbarButton" title="Move Image" value="move"><i class="pageToolbarButton_trackMove"></i> </button><button id="trackRange" type="button" class="pageToolbarButton" title="Select area" value="range"><i class="pageToolbarButton_trackRange"></i> </button><button id="trackGlass" type="button" class="pageToolbarButton" title="Magnifying Glass" value="glass"><i class="pageToolbarButton_trackGlass"></i> </button></div>',this.toolbarPage.querySelector("#scalePlus").addEventListener("click",function(){this.viewer.zoomIn()}.bind(this),!1),this.toolbarPage.querySelector("#scaleMinus").addEventListener("click",function(){this.viewer.zoomOut()}.bind(this),!1),this.toolbarPage.querySelector("#fitWidth").addEventListener("click",function(){this.viewer.setFitMode({name:"width"})}.bind(this),!1),this.toolbarPage.querySelector("#fitHeight").addEventListener("click",function(){this.viewer.setFitMode({name:"height"})}.bind(this),!1),this.toolbarPage.querySelector("#fitAuto").addEventListener("click",function(){this.viewer.setFitMode({name:"auto"})}.bind(this),!1),this.toolbarPage.querySelector("#rotate270").addEventListener("click",function(){this.viewer.rotate(270)}.bind(this),!1),this.toolbarPage.querySelector("#rotate90").addEventListener("click",function(){this.viewer.rotate(90)}.bind(this),!1),this.toolbarPage.querySelector("#rotate180").addEventListener("click",function(){this.viewer.rotate(180)}.bind(this),!1),this.toolbarPage.querySelector("#trackMove").addEventListener("click",function(){this.viewer.setTrackMode("move")}.bind(this),!1),this.toolbarPage.querySelector("#trackRange").addEventListener("click",function(){this.viewer.setTrackMode("range")}.bind(this),!1),this.toolbarPage.querySelector("#trackGlass").addEventListener("click",function(){this.viewer.setTrackMode("glass")}.bind(this),!1),this.buttonTrackModeGroup=this.toolbarPage.querySelector(".trackModeGroup"),this.viewer.observe("mouseTrackChange",function(t){if(this.buttonTrackModeGroup.querySelectorAll(".pageToolbarButton").forEach(function(t){t.removeClass("toggled")}),this.trackModeMap.indexOf(t)>=0){var e=this.buttonTrackModeGroup.querySelector("#"+this.trackModeMapping[t]);e&&e.addClass("toggled")}}.bind(this))},__makeToolbarMove:function(t){this.toolbarMove=iws.util.makeElement("div",{class:"pageToolbar move"}),t.appendChild(this.toolbarMove),this.toolbarMove.innerHTML='<button id="prev" type="button" class="pageToolbarButton" title="Go to previous page"><i class="pageToolbarButton_prev"></i></button><input type="text" id="pageNumber" class="pageToolbarField pageNumber" value="" size="4" /><button id="next" type="button" class="pageToolbarButton" title="Go to next page"><i class="pageToolbarButton_next"></i></button>',this.toolbarMove.querySelector("button#prev").addEventListener("click",function(){this.viewer.pagePrev()}.bind(this),!1),this.toolbarMove.querySelector("button#next").addEventListener("click",function(){this.viewer.pageNext()}.bind(this),!1),this.viewer.observe("pageNumberChange",function(t){this.toolbarMove.querySelector("#pageNumber").value=t+1+"/"+this.viewer.pageCount()}.bind(this))},__makeToolbarSize:function(t){window.self===window.top?(this.toolbarRight=iws.util.makeElement("div",{class:"pageToolbar size"}),this.toolbarFrameEl.appendChild(this.toolbarRight),this.toolbarRight.innerHTML='<button id="fullDisplay" type="button" class="pageToolbarButton" title="Full screen"><i class="pageToolbarButton_FullScreen"></i></button>',this.toolbarRight.querySelector("#fullDisplay").addEventListener("click",function(){iws.util.fullscreen.toggleFullScreen(this.viewer.fullScreenEl)}.bind(this),!1),iws.util.fullscreen.onFullScreenChange(function(t){t?($(this.toolbarRight).children("button#fullDisplay").children("i").removeClass("pageToolbarButton_FullScreen"),$(this.toolbarRight).children("button#fullDisplay").children("i").addClass("pageToolbarButton_OriginalScreen")):($(this.toolbarRight).children("button#fullDisplay").children("i").removeClass("pageToolbarButton_OriginalScreen"),$(this.toolbarRight).children("button#fullDisplay").children("i").addClass("pageToolbarButton_FullScreen"))}.bind(this))):console.log("you are in an iframe!")},__makeToolbarZoom:function(t){this.toolbarZoom=iws.util.makeElement("div",{class:"pageToolbar zoom"}),t.appendChild(this.toolbarZoom),this.toolbarZoom.innerHTML='<span id="scaleSelectContainer" class="iws-dropdownToolbarButton"><select id="scaleSelect" title="Zoom" tabindex="23" data-l10n-id="zoom"><option id="pageAutoOption"    title="" value="auto" >화면 맞춤</option><option id="pageFitWidthOption" title="" value="width" >너비 맞춤</option><option id="pageFitHeightOption" title="" value="height" >높이 맞춤</option><option id="pageFitOriginalOption" title="" value="original" >원본 크기</option><option id="customScaleOption" title="" value="custom">비율</option><option title="" value="0.25"  >25%</option><option title="" value="0.5"   >50%</option><option title="" value="0.75"  >75%</option><option title="" value="1"     >100%</option><option title="" value="1.25"  >125%</option><option title="" value="1.5"   >150%</option><option title="" value="2"     >200%</option><option title="" value="3"     >300%</option><option title="" value="4"     >400%</option></select></span>';var e=this;function i(){this.toolbarZoom.querySelector("#scaleSelect");var t=this.viewer.getFitMode(),i="";switch(t.name){case"width":case"height":case"auto":case"original":i=t.name;break;case"scale":i=t.scale}if(!function(t){for(var e=this.toolbarZoom.querySelector("#scaleSelect").options,i=!1,n=0,o=e.length;n<o;n++){var s=e[n];s.value===t?(s.selected=!0,i=!0):s.selected=!1}return i}.call(this,i)){var n=e.toolbarZoom.querySelector("#customScaleOption");n&&(n.textContent="비율",n.selected=!0)}}this.toolbarZoom.querySelector("#scaleSelect").addEventListener("change",function(t){switch(this.value){case"auto":case"width":case"height":case"original":e.viewer.setFitMode({name:this.value});break;case"custom":break;default:if(isNaN(this.value))return;e.viewer._zoom({name:"custom",scale:this.value})}},!1),this.viewer.observe("page:zoom",i.bind(this)),this.viewer.observe("page:fitMode",i.bind(this))}};